/*! jQuery Typer Plugin v0.8.2 | https://github.com/misonou/jquery-typer | The MIT License (MIT) */

!function(a,b,c,d,e,f,g,h,i){"use strict";function j(a){B(a,j)&&Object.getOwnPropertyNames(a).filter(function(a){return!j.prototype.hasOwnProperty(a)}).forEach(function(b){this[b]=a[b]},this)}function k(a,b,c,d){this.typer=a,this.id=b,this.element=c||null,this.options=d||{}}function l(a,b,c){this.eventName=a,this.typer=b,this.widget=c||null}function m(a,b,c){this.childNodes=[],this.nodeType=a,this.element=b,this.widget=c}function n(a,b,c){this.whatToShow=b,this.filter=c||null,this.currentNode=a,this.root=a}function o(a,b,c){this.whatToShow=b,this.filter=c||null,this.typerNodeIterator=B(a,n)||new n(a,ua|wa|sa)}function p(a,b,c){clearTimeout(p[a.name]),p[a.name]=b&&setTimeout(b,c)}function q(b,c){a.each(c,function(a,c){Object.defineProperty(b,a,{enumerable:!0,configurable:!0,get:function(){return Object.defineProperty(this,a,{enumerable:!0,writable:!0,value:c.apply(this)}),this[a]}})})}function r(a,b,c){return i.slice.call(a||{},b||0,c)}function s(b,c){return a.isArray(b[c])?b[c]:r(b,c)}function t(b,c){var d,e=[0].concat(s(arguments,2));return a.each(b,function(a,b){return e[0]=b,d=c.apply(this,e)&&b,!d}),d}function u(a,b){var c=(b||a.currentNode).nodeType;return a.whatToShow&(B(a,n)?c:1<<c-1)?a.filter?(a.filter.acceptNode||a.filter).call(a.filter,b||a.currentNode):1:3}function v(a,b,c){a.currentNode=c||a.currentNode;var d=u(a);if(2!==d)for(1===d&&b&&b(a.currentNode);a.nextNode();b&&b(a.currentNode));}function w(b,c,d){var e=[];return v(b,i.push.bind(e),d),c?a.map(e,c):e}function x(a){return d(a||"").replace(/^[\s\u200b]+|[\s\u200b]+$/g,"")}function y(a){return a=d(a||""),a.charAt(0).toUpperCase()+a.slice(1)}function z(a){return a=d(a||""),a.charAt(0).toLowerCase()+a.slice(1)}function A(a){return a&&a.tagName&&a.tagName.toLowerCase()}function B(b,c){return c&&c.prototype?b instanceof c&&b:"*"===c?b:a(b).is(c)&&b}function C(a){return a.nodeType===ua||a.nodeType===wa}function D(b){var c={};return a.each(a.makeArray(b&&b.attributes),function(a,b){c[b.nodeName]=b.value}),c}function E(b,c){var d=D(b),e=D(c);return a.each(e,function(a,b){b===d[a]&&(delete d[a],delete e[a])}),!Object.keys(d)[0]&&!Object.keys(e)[0]}function F(a,b,c){if(a===b)return 0;var d=a&&b&&a.compareDocumentPosition(b);return 2&d?c&&8&d||1&d?NaN:1:4&d?c&&16&d||1&d?NaN:-1:NaN}function G(b,c){return b===c||a.contains(b,c)}function H(a,b){var c=a.length||a.childNodes.length;return b===c||0===b&&1/b===-(1/0)?c:(c+b)%c||0}function I(a,b,d,g){if(B(a,j)){var h=a;a=h.startTextNode||h.startElement,d=h.endTextNode||h.endElement,b=1===a.nodeType?!h.isCaret||h.caretPosition<=0:h.startOffset,g=1===d.nodeType?!!h.isCaret&&h.caretPosition<=0:h.endOffset}var i;return B(a,e)?(i=c.createRange(),d?(+b===b?i.setStart(a,H(a,b)):i[b?"setStartBefore":"setStartAfter"](a),B(d,e)&&(+g===g?i.setEnd(d,H(d,g)):i[g?"setEndBefore":"setEndAfter"](d))):(i[1&b?"selectNodeContents":"selectNode"](a),2&b&&i.collapse(!!(4&b)))):B(a,f)&&(i=a.cloneRange(),i.collapsed||("boolean"==typeof b?i.collapse(b):2&b&&i.collapse(!!(4&b)))),B(b,f)&&(i.collapsed&&b.collapsed?i.setEnd(b.endContainer,b.endOffset):(i.compareBoundaryPoints(0,b)<=0&&i.setStart(b.startContainer,b.startOffset),i.compareBoundaryPoints(2,b)>=0&&i.setEnd(b.endContainer,b.endOffset))),i}function J(a,b){return a=B(a,f)||I(a,!0),b=B(b,f)||I(b,!0),a&&b&&!(1&a.startContainer.compareDocumentPosition(b.startContainer))&&a.compareBoundaryPoints(3,b)<=0&&a.compareBoundaryPoints(1,b)>=0}function K(a,b){return a=B(a,f)||I(a,!0),b=B(b,f)||I(b,!0),a&&b&&!(1&a.startContainer.compareDocumentPosition(b.startContainer))&&a.compareBoundaryPoints(0,b)<=0&&a.compareBoundaryPoints(2,b)>=0}function L(a,b,c){a=B(a,f)||I(a,!0),b=B(b,f)||I(b,!0);var d=a&&b&&1&a.startContainer.compareDocumentPosition(b.startContainer)?NaN:a.compareBoundaryPoints(0,b)+a.compareBoundaryPoints(2,b);return c&&(0!==d&&J(a,b)||0===d&&(!K(a,b)||!K(b,a)))?NaN:d&&d/Math.abs(d)}function M(a){ga||setTimeout(function(){ga=!1}),ga=!0,a()}function N(a){if(c.caretRangeFromPoint)return c.caretRangeFromPoint(a.clientX,a.clientY);if(a.rangeParent)return I(a.rangeParent,a.rangeOffset,!0);if(c.body.createTextRange){var b=Ea.rangeCount&&Ea.getRangeAt(0),d=c.body.createTextRange();d.moveToPoint(a.clientX,a.clientY),d.select();var e=Ea.getRangeAt(0);return b&&(Ea.removeAllRanges(),Ea.addRange(b)),e}}function O(a){var b=a.startTextNode,c=a.endTextNode,d=b===c;c&&a.endOffset<c.length&&c.splitText(a.endOffset),b&&a.startOffset>0&&(a.startTextNode=b.splitText(a.startOffset),d&&(a.endTextNode=a.startTextNode,a.endOffset-=a.startOffset),a.startOffset=0)}function P(b){return B(b,g)||a(c.createDocumentFragment()).append(b)[0]}function Q(a){return c.createTextNode(x(a)||la)}function R(a,b){var d=c.createElement(a);return b&&(d.className=b),d}function S(b,c){return a.each(c,function(c,d){b=a(d.cloneNode(!1)).append(b)[0]}),B(b,e)||P(b)}function T(u){function H(){this.originalSelection=new j(Ia)}function U(a){switch(a){case ya:return Na.concat(Ia.widgets);case za:return Na;case Aa:return Ia.widgets.slice(0).reverse().concat(Na);case Ba:return Ia.widgets.slice(-1)}}function V(b,c){var d,e=[0].concat(s(arguments,2)),f=a.makeArray(B(b,k)||U(b));return a.each(f,function(a,f){var g=Oa[f.id];if(Da(g[c]))return e[0]=new l(c,La,f),d=!0,g[c].apply(g,e)!==!1||b!==Aa}),B(b,k)&&setTimeout(function(){V(za,"widget"+y(c),b)}),d}function W(){if(Ea.rangeCount){var a=Ea.getRangeAt(0);return G(Ma,a.commonAncestorContainer)&&a}}function X(d){function e(a,b){if(b.parentNode!==a&&b!==a){b.parentNode&&j(b,!0);for(var c=a.childNodes.length;c&&L(b.element,a.childNodes[c-1].element)<0;c--);b.parentNode=a,b.previousSibling=a.childNodes[c-1],b.nextSibling=a.childNodes[c],(b.previousSibling||{}).nextSibling=b,(b.nextSibling||{}).previousSibling=b,a.childNodes.splice(c,0,b)}}function j(a,b){if(a.parentNode){var e=a.parentNode.childNodes.indexOf(a);e>=0&&(!b&&a.widget.element===a.element&&G(c,d)&&(a.widget.destroyed=!0,V(a.widget,"destroy")),a.parentNode.childNodes.splice(e,1),a.parentNode=null,(a.previousSibling||{}).nextSibling=a.nextSibling,(a.nextSibling||{}).previousSibling=a.previousSibling)}}function l(b,h){function i(b){return b.widget&&B(b.element,Oa[b.widget.id].element)||(b.widget&&G(c,d)&&(b.widget.destroyed=!0,V(b.widget,"destroy")),delete b.widget,a.each(Oa,function(a,e){if(B(b.element,e.element))return b.widget=new k(La,a,b.element,e.options),G(c,d)&&V(b.widget,"init"),!1})),b.widget}function n(b){if("li"===A(b.element))if(a(b.element).children(ka)[0]){b.nodeType=va;var c=0;a(b.element).contents().each(function(a,d){B(d,ka)&&(a>c||!a)&&(p.push(I(b.element,c,b.element,a)),c=a+1)})}else b.nodeType=ua;a.each(b.childNodes.slice(0),function(a,b){!B(b.element,f)&&G(d,b.element)||(j(b),s.delete(b.element))})}var o=[s.get(b)],p=[];n(o[0]);var q=h?a(b).children():B(b,g)?a(b).children().find("*").andSelf():a("*",b);q.each(function(a,b){for(;p[0]&&F(p[0].startContainer.childNodes[p[0].startOffset],b)<0;)o.unshift(new m(ua,p.shift(),o[0].widget)),e(o[1],o[0]);for(;!K(o[0].element,b);)o.shift();if("br"===A(b))return void(s.has(b)&&C(o[0])&&(j(s.get(b)),s.delete(b)));var c=!s.has(b),d=s.get(b)||new m(0,b);d.widget=o[0].nodeType!==sa&&i(d)||o[0].widget;var f=Oa[d.widget.id];f.inline||d.widget===o[0].widget&&o[0].nodeType!==sa?d.nodeType=B(b,ka)?va:B(b,ja)?ua:wa:d.nodeType=B(b,f.editable)?ta:sa,n(d),e(o[0],d),s.set(b,d),h&&c&&l(b),o.unshift(d)})}function n(b){var c=a.map(b,function(b){return a(b.addedNodes).add(b.removedNodes).filter(":not(#Typer_RangeStart,#Typer_RangeEnd)")[0]?b.target:null});i.push.apply(t,c)}function o(a){for(var b=a;!s.has(b);b=b.parentNode);return l(b),s.get(a)}function q(){r?n(r.takeRecords()):p(q,function(){t.push(null)}),null===t[0]?l(t.splice(0)&&d):t[0]&&a(d.parentNode||d).find(a.unique(t.splice(0))).each(function(a,b){l(b,!!r)})}var r,s=new h,t=[];return G(c,d)||(d=B(d,g)||P(d)),b.MutationObserver&&G(c,d)&&(r=new MutationObserver(n),r.observe(d,{subtree:!0,childList:!0})),s.set(d,new m(ta,d,new k(La,0,Ma,u))),t.push(null),{get rootNode(){return this.getNode(d)},getNode:function(a){if(G(d,a))return 3!==a.nodeType&&"br"!==A(a)||(a=a.parentNode),q(),s.get(a)||o(a)}}}function Y(b){var c;return a.each(U(Aa),function(a,d){return c=Da((Oa[d.id].commands||{})[b])&&d,!c}),c}function Z(a,b,c,d){var e=I(a,b,c,d);Ea.removeAllRanges(),e&&G(Ma,e.commonAncestorContainer)&&(Ea.addRange(e),Ja=e,Ia.dirty=!0)}function $(a,b){if(a&&3!==a.nodeType){var c=new o(Ha.getNode(a),4);if(b)for(;c.nextNode()&&b>c.currentNode.length;b-=c.currentNode.length);else if(1/b<0){for(;c.nextNode(););b=c.currentNode.length}else c.nextNode();a=c.currentNode}Z(a,b||0,a,b||0)}function _(b){function c(a,b,c){var d;"br"===A(a)?(d=a.nextSibling,b=0):1===a.nodeType&&a.childNodes[0]&&(c||b===a.childNodes.length?(a=a.childNodes[(b||1)-1],3===a.nodeType&&(d=a,a=d.parentNode,b=d.length),c=!0):(a=a.childNodes[b],b=0)),3===a.nodeType&&(d=a,a=a.parentNode);var e=Ha.getNode(a);for(e.nodeType===va&&!B(e.containingElement,ka)&&d&&(e=t(e.childNodes,function(a){return K(a.element,d)})||e);e.nodeType===wa&&e.parentNode.nodeType!==ta;e=e.parentNode);if(e.nodeType===sa||e.nodeType===ta)a=e.widget.element,d=null;else if(!d&&1===a.nodeType){for(var f=new o(e,4);f.nextNode()&&c;);d=f.currentNode,b=c?d&&d.length:0}return{node:e,element:a,textNode:d,offset:b}}B(b,f)||(b=I.apply(null,s(arguments)));var d=b.commonAncestorContainer;b.startContainer===b.endContainer&&b.startOffset===b.endOffset-1&&(d=B(d.childNodes[b.startOffset],Element)||d),G(Ma,d)||(d=Ma);var e=Ha.getNode(d);e.nodeType===sa&&(e=Ha.getNode(e.widget.element));var g=c(b.startContainer,b.startOffset),h=b.collapsed?g:c(b.endContainer,b.endOffset,!0);return a.extend(new j,{isCaret:b.collapsed,caretPosition:b.collapsed&&L(b,g.node.element),focusNode:e,startNode:g.node,startElement:g.element,startTextNode:g.textNode||null,startOffset:g.offset||0,endNode:h.node,endElement:h.element,endTextNode:h.textNode||null,endOffset:h.offset||0})}function aa(a){if(Ja=W()||Ja,Ja&&(Ia=_(Ja),a!==!1)){var b={};V(ya,"beforeStateChange",b),V(ya,"stateChange",b)}}function ba(b){B(b,"li:only-child")&&(b=b.parentNode),a(b).remove()}function ca(b){b=B(b,f)||I(b||Ma,!0),M(function(){var c=d(u.attributes||"").split(" "),f=_(b).createTreeWalker(-1);return f.currentNode.nodeType!==ta||f.currentNode.childNodes[0]?(v(f,function(b){if(C(b)){var d=a("br:last-child",b.element)[0];d&&!d.nextSibling&&(a(Q()).insertBefore(d),ba(d));var f=a("br:first-child",b.element)[0];f&&!f.previousSibling&&ba(f);var g;a(b.childDOMNodes).each(function(b,c){3===c.nodeType&&(x(c.nodeValue)?c.nodeValue.charAt(0)===la?(c=c.splitText(1),a(c.previousSibling).remove()):c.nodeValue.slice(-1)===la&&(c.splitText(c.length-1),a(c.nextSibling).remove()):c.previousSibling&&c.nextSibling&&"br"!==A(c.previousSibling)&&(!Ja||L(c,Ja,!0))&&a(c).remove(),g=!0)}),g||(b.element.appendChild||b.element.insertNode).call(b.element,Q())}B(b.element,e)&&(b.nodeType!==va&&b.nodeType!==ua&&b.nodeType!==wa||a.each(D(b.element),function(d){a.inArray(d,c)<0&&a(b.element).removeAttr(d)}),b.nodeType===sa||Ja&&J(Ja,b.element)||(b.element.normalize(),b.nodeType===wa?A(b.element.previousSibling)===A(b.element)&&E(b.element,b.element.previousSibling)?(a(b.element).contents().appendTo(b.element.previousSibling),ba(b.element)):ia.indexOf(A(b.element))<0&&0===b.element.childElementCount&&!x(b.element.textContent)&&ba(b.element):(b.nodeType===ta||b.nodeType===va&&B(b.element,ka))&&(a(b.element).contents().each(function(b,c){3===c.nodeType&&(x(c.nodeValue)?a(c).wrap("<p>"):ba(c))}),b.element.childNodes[0]||a(na).appendTo(b.element))))}),a('br[type="_moz"]',Ma).remove(),void a(Ca&&"*",Ma).each(function(b,c){a(c).data("typerIEFix")||(a(c).data("typerIEFix",!0),a(c).bind("input",function(b){ga||Qa.trigger(a.Event("input",b))}),a(c).bind("textinput",function(b){ga||Qa.trigger(a.Event("textInput",b))}))})):void a(na).appendTo(f.currentNode.element)})}function da(b,d){function h(a){return I(a,(L(b,a)<0?pa:ra)|(a!==Ha.getNode(a).widget.element&&1===a.nodeType))}var i,j,k=(d||b)===!0?"extractContents":Da(d||b)?"deleteContents":"cloneContents",l=k.indexOf("de")<0,m=k.indexOf("cl")<0,n=c.createDocumentFragment();if(Ia.dirty&&aa(!1),d=B(d||b,Function),b=B(b,f)||I(B(b,e)||Ia),!b.collapsed){var o=_(b);Da(d)&&(i=h(o.startTextNode||o.startElement),j=o.isSingleEditable?h(o.endTextNode||o.endElement):i);var p=[[Ma,n]];v(o.createTreeWalker(-1,function(c){if(B(c.element,e)&&!G(p[0][0],c.element)&&p.shift(),K(b,c.element))return l&&a(p[0][1]).append(c.cloneDOMNodes(!0)),m&&(c.nodeType===ta?a(c.element).html(na):ba(c.element)),2;var d=C(c)&&I(c.element,b)[k]();if(l){if(c.nodeType===sa||c.nodeType===va||c.nodeType===ta&&c.element!==Ma||d&&d.firstChild.tagName!==c.element.tagName){var f=c.cloneDOMNodes(!1);p[0][1].appendChild(f),B(f,g)||p.unshift([c.element,f])}d&&p[0][1].appendChild(d)}return C(c)?2:1}))}return Da(d)&&d(i||I(b,!0),j||I(b,!1)),ca(b),aa(!1),n}function ea(b,c){b?"string"==typeof b&&(b=b.replace(/\u000d/g,"").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br>").replace(/<p>(<|$)/g,"<p>"+ma+"$1")||ma,b=a.parseHTML("<p>"+b+"</p>")):b=[],void 0===c||B(c,f)||(c=I.apply(null,s(arguments,1))),da(c,function(c,d){var e=I(c,d),f=_(e);f.startNode.nodeType===ta&&f.startNode===f.endNode&&(ca(e),f=_(I(f.startNode.element,!0)));var g,h,j=f.startNode,k=f.endNode,l=k.parentNode.nodeType===va?k.parentNode:k;if(j.nodeType===ua)h=[f.startElement];else if(j.nodeType===wa){var m=B(j.containingElement.parentNode,ka)||j.containingElement||Ha.getNode(j.containingElement).widget.element;h=a(f.startElement).parentsUntil(m).andSelf().get().reverse()}else h=[R("p")];for(var n,o=X(b),p=o.rootNode.childNodes.slice(0),q=!p[1]&&(!p[0]||C(p[0]))&&j!==k;p[0];){var s=p.pop();if(s.nodeType!==va||"li"!==A(k.containingElement)){var t=s.nodeType===wa?[s.element]:s.childDOMNodes.slice(0),u=s.nodeType===sa||!C(k),v=p[0]&&!n;if(u||v){var w=I((u?l:k).element,ra),x=I(d,w).extractContents(),y=x.childNodes[0];if((x.textContent||y&&(!C(s)||t[0]))&&(w.insertNode(x),k=_(w).focusNode,l=u?k:l,d=w,g=g||I(k.element,oa)),C(s)){t[0]&&(C(k)?(I(y,oa)||d).insertNode(S(t,h.slice(0,-1))):w.insertNode(S(t,h)),g=g||I(t[0],qa),n=!0);continue}}var z=t.slice(-1)[0];s.nodeType===sa||s.nodeType===va?(d.insertNode(s.element),g=g||I(s.element,ra)):p[0]?(d.insertNode(S(t,n?h:h.slice(0,-1))),g=g||I(z,qa),n=!0):t[0]&&(c.insertNode(j?P(t):S(t,h)),c=I(z,ra),g=g||I(z,qa))}else i.push.apply(p,r(s.childNodes))}q&&(g=g||c.cloneRange(),c.insertNode(I(k.element,!0).extractContents()),ba(k.element)),Z(g||d)})}function fa(a){var b=X(a),c=new n(b.rootNode,ua),d=w(c,function(a){var b=new o(a,5,function(a){return a.nodeValue||"br"===A(a)?1:3});return w(b,function(a){return a.nodeValue||"\n"}).join("")});return d.join("\n\n")}function xa(b){if(V(Aa,b))return!0;if("backspace"===b||"delete"===b){var c;if(Ia.isCaret){var d="backspace"===b?-1:1,e=d<0?Ia.previousTextNode:Ia.nextTextNode,f=d<0?Ia.textStart:Ia.textEnd;if(!e&&f)Ia.textStart&&Ia.textEnd&&ba(Ia.startElement),Z(d<0?Ia.previousNode.element:Ia.nextNode.element),c=!0;else if(Ia.startTextNode){if(f){var g=Ia.getSelectedElements("li")[0],h=d<0?Ia.previousNode:Ia.nextNode;if(B(g,"li:"+(d<0?"first-child":"last-child"))&&"li"===A(h.containingElement)&&!G(g.parentNode,h.containingElement)){var i=(a.uniqueSort||a.unique)([g.parentNode,h.containingElement.parentNode]);a(i[1]).appendTo(i[0]).children().unwrap(),Z(Ia)}else d<0?ea("",e,-0,Ia.startTextNode,0):ea("",Ia.startTextNode,-0,e,0);c=!0}}else Ia.caretPosition===d?Z(e,d<0?qa:oa):(Z(Ia.startElement),c=!0)}else ea(""),c=!0;if(c)return Pa.snapshot(),!0}return/ctrl(?![axcvr]$)|alt/i.test(b)}function Fa(){function b(b){if(b=x(b.replace(f,"").replace(g,"").replace(/(?!>)\u200b(?!<\/)/g,"")),b!==i){var c=a("<div>").html(b);return a(u.controlElements,c).remove(),a(d(u.controlClasses||"").replace(/\b(\S+)/g,".$1").replace(/\s+\./g,",."),c).removeClass(u.controlClasses),V(ya,"change",c.html()),i=b,!0}}function c(){M(function(){var c,d,e=W();Ia.dirty&&aa(),Ia.startTextNode?(Ia.startOffset>0&&(c=Ia.startTextNode.splitText(Ia.startOffset)),a(f).insertBefore(c||Ia.startTextNode)):Ia.startElement&&a(f).insertBefore(Ia.startElement),Ia.isCaret||(Ia.endTextNode?(Ia.endOffset<Ia.endTextNode.length&&(d=Ia.endTextNode.splitText(Ia.endOffset)),a(g).insertAfter(Ia.endTextNode)):Ia.endElement&&a(g).insertAfter(Ia.endElement));var i=Ma.innerHTML;if(i!==j[0]){var l=b(i);j.splice(0,k+!l,i),j.splice(u.historyLevel),k=0}a(h).remove(),c&&(Ia.startTextNode.nodeValue+=c.nodeValue,a(c).remove()),d&&(Ia.endTextNode.nodeValue+=d.nodeValue,a(d).remove()),e&&Z(Ia)})}function e(c){Qa.html(c);var d=a(h);if(d[0]){var e=I(d[0],!d[1]&&ra,d[1],!0);d.remove(),Z(e),aa()}b(c)}var f='<span id="Typer_RangeStart"></span>',g='<span id="Typer_RangeEnd"></span>',h="#Typer_RangeStart,#Typer_RangeEnd",i=x(Ma.innerHTML),j=[i],k=0;a.extend(Pa,{canUndo:function(){return k<j.length-1},canRedo:function(){return k>0},undo:function(){Pa.canUndo()&&e(j[++k])},redo:function(){Pa.canRedo()&&e(j[--k])},snapshot:function(a){p("snapshot"),a?p("snapshot",c,a):a!==!1&&c()}})}function Ga(){function e(){var a=l;l&&!l.destroyed&&(l=null,V(a,"focusout"))}var f,g,h,i,j,k,l;Qa.mousedown(function(){f=!0;var b={mousemove:function(a){return!a.which&&f?void b.mouseup():void p(Ga,aa)},mouseup:function(){f=!1,a(c.body).unbind(b),p(Ga,function(){aa(),ca(Ia.focusNode.element),Pa.snapshot()})}};a(c.body).bind(b)}),Qa.bind("compositionstart compositionupdate compositionend",function(a){g="end"!==a.type.substr(-3)}),Qa.bind("keydown keypress keyup",function(b){if(e(),g)return void b.stopImmediatePropagation();k=!0,setTimeout(function(){k=!1});var c=a.inArray(b.keyCode,[16,17,18,91,93])>=0,f=!c&&ha[b.keyCode]!==d.fromCharCode(b.keyCode).toLowerCase();if("keydown"===b.type){if(h=b.ctrlKey+b.shiftKey+b.altKey+b.metaKey+!c,h*=f||(h>2||h>1&&!b.shiftKey)&&!c,i=b.keyCode,h){var l=z((b.ctrlKey||b.metaKey?"Ctrl":"")+(b.altKey?"Alt":"")+(b.shiftKey?"Shift":"")+y(ha[i]||d.fromCharCode(b.charCode)));if(xa(l))return j=!0,void b.preventDefault()}j=!1,p(Ga,function(){aa(),ca(Ia.focusNode.element)})}else"keypress"===b.type?!h&&b.charCode||b.stopImmediatePropagation():((b.keyCode===i||c)&&h--&&b.stopImmediatePropagation(),j||c||(aa(),Pa.snapshot(50)))}),Qa.bind("textInput",function(){k||Pa.snapshot(50)}),Qa.bind("compositionstart keypress textInput",function(a){if(Pa.snapshot(!1),!Ia.startTextNode||Ia.paragraphElements[1]){"compositionstart"!==a.type&&a.preventDefault();var b=a.originalEvent.data||d.fromCharCode(a.charCode)||"";!Ia.startTextNode&&V(Ba,"textInput",b)||(ea(b),Pa.snapshot())}}),Qa.bind("dragstart",function(a){var b={drop:function(a){var c=da(!a.ctrlKey),d=N(a.originalEvent);ea(c,d),Pa.snapshot(),a.preventDefault(),Qa.unbind(b)}};Qa.bind(b)}),Qa.bind("cut copy",function(c){var d=c.originalEvent.clipboardData||b.clipboardData,e=da("cut"===c.type),f=fa(e);b.clipboardData?d.setData("Text",f):(d.setData("text/plain",f),d.setData("text/html",a('<div id="Typer">').append(e)[0].outerHTML),d.setData("application/x-typer","true")),c.preventDefault()}),Qa.bind("paste",function(c){var d=c.originalEvent.clipboardData||b.clipboardData;if(a.inArray("application/x-typer",d.types)>=0){var e=d.getData("text/html"),f=a(e).filter("#Typer").contents().get();ea(f)}else a.inArray("text/plain",d.types)>=0?ea(d.getData("text/plain")):b.clipboardData&&ea(d.getData("Text"));Pa.snapshot(),c.preventDefault(),Ca&&setTimeout(function(){Z(Ia)})}),Qa.bind("mouseup",function(a){var b=Ha.getNode(a.target);l!==b.widget&&e(),b.nodeType===sa&&(Ca&&setTimeout(function(){Z(b.widget.element)}),Z(b.widget.element),l!==b.widget&&(l=b.widget,V(b.widget,"focusin")))}),Qa.bind("focusin focusout",function(a){setTimeout(function(){Ka||("focusout"===a.type&&e(),V(ya,a.type))})})}u=a.extend({element:null,controlClasses:"",controlElements:"",attributes:"title target href src align name class width height",historyLevel:100,widgets:[],inlineStyle:!0,formatting:!0,list:!0,link:!0,change:null,beforeStateChange:null,stateChange:null},u);var Ha,Ia,Ja,Ka,La=this,Ma=u.element,Na=[],Oa=[u].concat(u.widgets),Pa={},Qa=a(Ma);Fa(),Ga(),a.each(T.widgets,function(b,c){if(u[b]===!0||a.isPlainObject(u[b])){var d=Object.create(c);d.options=Object.create(d.options||null),a.extend(d.options,u[b]),Oa.push(d)}}),Oa.push({element:":not("+ja+",br,a,b,em,i,u,small,strong,sub,sup,ins,del,mark,span)"},{ctrlZ:Pa.undo,ctrlY:Pa.redo,ctrlShiftZ:Pa.redo}),a.each(Oa,function(a,b){b.element||Na.push(new k(La,a,null,b.options))});var Ra={focusin:function(a){Ka=a.currentTarget},focusout:function(a){var b=a.currentTarget;setTimeout(function(){Ka!==b||W()||(Ka=null,Qa.trigger("focusout"))})}};a.extend(this,{element:Ma,canUndo:Pa.canUndo,canRedo:Pa.canRedo,undo:Pa.undo,redo:Pa.redo,hasCommand:function(a){return!!Y(a)},getSelection:function(){return new j(Ia)},select:function(a,b,c,d){Z(a,b,c,d),Pa.snapshot()},moveCaret:function(a,b){$(a,b),Pa.snapshot()},retainFocus:function(b){a(b).bind(Ra)},invoke:function(a){var b=this,c=[new H].concat(s(arguments,1));M(function(){"string"==typeof a&&(c[0].widget=Y(a),a=c[0].widget&&Oa[c[0].widget.id].commands[a]),Da(a)&&a.apply(b,c)}),aa(),Pa.snapshot()}}),H.prototype={widget:null,remove:ba,normalize:ca,invoke:La.invoke,hasCommand:La.hasCommand,insertText:function(a){ea(d(a||""))},insertHtml:function(b){return"string"==typeof b&&(b=a.parseHTML(b)),ea(b),b},execCommand:function(a,b){c.execCommand(a,!1,b||""),aa(!1)},getSelectedText:function(){var a=da();return fa(a)},getSelectedTextNodes:function(){return O(Ia),a.map(Ia.selectedElements,function(b){return a(b).contents().filter(function(a,b){return 3===b.nodeType&&F(Ia.startTextNode,b)<=0&&F(Ia.endTextNode,b)>=0})})},select:function(a,b,c,d){Z(a,b,c,d),aa(!1)},moveCaret:function(a,b){$(a,b),aa(!1)},restoreSelection:function(){Z(this.originalSelection),aa(!1)}},q(H.prototype,{selection:function(){return new j(Ia)}}),Qa.attr("contenteditable","true"),Ha=X(Ma),V(za,"init"),Ia=_(Ma,oa),ca()}function U(a,b){return b&&(a.whatToShow&xa||b.nodeType!==sa&&b.nodeType!==ta)}function V(a,b,c){return c&&!U(a,b)?2:b.nodeType===sa&&b.parentNode.nodeType===sa?3:u(a,b)}function W(a,b,c){if(V.returnValue=V(a,b,c),1===V.returnValue)return a.currentNode=b,!0}function X(a,b,c){for(var d=a.currentNode[b];d;){if(W(a,d,!0))return d;if(3===V.returnValue&&d[b])d=d[b];else{for(;!d[c];)if(d=U(a,d.parentNode)&&d.parentNode,!d||d===a.root||d===a.currentNode)return null;d=d[c]}}}function Y(a,b,c){for(var d=a.currentNode;d&&d!==a.root;){for(var e=d[c];e;){if(W(a,e))return e;e=2!==V.returnValue&&e[b]?e[b]:e[c]}if(d=U(a,d.parentNode)&&d.parentNode,!d||d===a.root||1===V(a,d,!0))return null}}function Z(a,b){var d=a.typerNodeIterator.currentNode;if(!C(d))return c.createNodeIterator(B(d.element,e)||d.containingElement,0);var g=B(d.element,f),h=c.createTreeWalker(g?d.containingElement:d.element,1|a.whatToShow,function(b){return 1===b.nodeType||g&&!J(g,b)?2:1|u(a,b)},!1);if("previousNode"===b){for(var i=a.currentNode;h.lastChild(););for(;F(i,h.currentNode,!0)<=0&&h[b](););}return h}function $(a,b){var c=a.currentNode;if(a.iterator[b]())return a.currentNode["nextNode"===b?"previousSibling":"nextSibling"]!==c&&a.typerNodeIterator[b]()&&(a.iteratorStack.unshift({dir:b,iterator:a.iterator}),a.iterator=Z(a,b),1===u(a.iterator)||a.iterator[b]())?a.currentNode:a.currentNode;for(;a.iteratorStack[0];){var d=a.iteratorStack.shift();if(d.dir===b)return a.iterator=d.iterator,a.currentNode}for(;a.typerNodeIterator[b]();)if(a.iterator=Z(a,b),1===u(a.iterator)||a.iterator[b]())return a.currentNode}function _(a,b,c){var d=I(a);return new n(a.focusNode,b|xa,function(a){return J(a.element,d)?a.selectedInRange(d)?c?c(a):1:3:2})}function aa(a,b,c){for(var d=a;d&&d.nodeType!==ta;d=d.parentNode);var e=new n(d,b);return e.currentNode=a,c&&(e=new o(e,4),e.currentNode=c),e}function ba(a){for(var b=[],c=a.focusNode;c;c=c.parentNode)c.nodeType===ta&&b.unshift(c);return b}function ca(b,c){return function(d){a.each(d.selection.paragraphElements,function(e,f){var g=B(f.parentNode,ka);if("indent"===b){var h=a(f).prev("li")[0]||a("<li>").insertBefore(f)[0],i=a(h).children(ka)[0]||a(g.cloneNode(!1)).appendTo(h)[0];a("<li>").append(f.childNodes).appendTo(i)}else if("outdent"===b){var j=a(g).parent("li")[0];a(f).next("li")[0]&&(j?a(g.cloneNode(!1)).append(a(f).nextAll()).appendTo(f):(a(g.cloneNode(!1)).append(a(f).nextAll()).insertAfter(g),a(f).children(ka).insertAfter(g))),a(R(j?"li":"p")).append(f.childNodes).insertAfter(j||g)}else{if("li"===A(f))return void((A(g)!==b||c&&!a(g).hasClass(c))&&a(g).wrap(R(b,c)).contents().unwrap());var k=b+(c||"").replace(/^(.)/,".$1"),l=a(f).prev(k)[0]||a(f).next(k)[0]||a(R(b,c)).insertAfter(f)[0];a("<li>").append(f.childNodes)[F(f,l)<0?"prependTo":"appendTo"](l)}d.remove(f)}),d.restoreSelection()}}function da(b){return function(c){a(c.selection.paragraphElements).attr("align",b)}}function ea(a,b){return function(c){c.selection.isCaret?c.insertHtml(R(b)):(c.selection.subscript&&"superscript"===a?c.execCommand("subscript"):c.selection.superscript&&"subscript"===a&&c.execCommand("superscript"),c.execCommand(a))}}function fa(a,b,c){T.widgets[a]={commands:b},(c||"").replace(/(\w+):(\w+)/g,function(b,c,d){T.widgets[a][c]=function(a){a.typer.invoke(d)}})}var ga,ha=JSON.parse('{"8":"backspace","9":"tab","13":"enter","16":"shift","17":"ctrl","18":"alt","19":"pause","20":"capsLock","27":"escape","33":"pageUp","34":"pageDown","35":"end","36":"home","37":"leftArrow","38":"upArrow","39":"rightArrow","40":"downArrow","45":"insert","46":"delete","48":"0","49":"1","50":"2","51":"3","52":"4","53":"5","54":"6","55":"7","56":"8","57":"9","65":"a","66":"b","67":"c","68":"d","69":"e","70":"f","71":"g","72":"h","73":"i","74":"j","75":"k","76":"l","77":"m","78":"n","79":"o","80":"p","81":"q","82":"r","83":"s","84":"t","85":"u","86":"v","87":"w","88":"x","89":"y","90":"z","91":"leftWindow","92":"rightWindowKey","93":"select","96":"numpad0","97":"numpad1","98":"numpad2","99":"numpad3","100":"numpad4","101":"numpad5","102":"numpad6","103":"numpad7","104":"numpad8","105":"numpad9","106":"multiply","107":"add","109":"subtract","110":"decimalPoint","111":"divide","112":"f1","113":"f2","114":"f3","115":"f4","116":"f5","117":"f6","118":"f7","119":"f8","120":"f9","121":"f10","122":"f11","123":"f12","144":"numLock","145":"scrollLock","186":"semiColon","187":"equalSign","188":"comma","189":"dash","190":"period","191":"forwardSlash","192":"backtick","219":"openBracket","220":"backSlash","221":"closeBracket","222":"singleQuote"}'),ia="area base br col command embed hr img input keygen link meta param source track wbr".split(" "),ja="h1,h2,h3,h4,h5,h6,p,ul,ol,li,q,blockquote,pre,code",ka="ul,ol",la="​",ma="&#8203;",na="<p>&#8203;</p>",oa=7,pa=6,qa=3,ra=2,sa=1,ta=2,ua=4,va=8,wa=16,xa=4096,ya=1,za=2,Aa=3,Ba=4,Ca=!!b.ActiveXObject||void 0!==c.documentElement.style.msTouchAction,Da=a.isFunction,Ea=b.getSelection();if(b.Typer=T,a.extend(T,{COLLAPSE_START_INSIDE:oa,COLLAPSE_START_OUTSIDE:pa,COLLAPSE_END_INSIDE:qa,COLLAPSE_END_OUTSIDE:ra,iterate:v,iterateToArray:w,compareAttrs:E,comparePosition:F,compareRangePosition:L,containsOrEquals:G,createRange:I,rangeIntersects:J,rangeCovers:K,getRangeFromMouseEvent:N,widgets:{}}),m.prototype={get containingElement(){return this.element.commonAncestorContainer||this.element},get childDOMNodes(){return B(this.element,f)?r(this.element.commonAncestorContainer.childNodes,this.element.startOffset,this.element.endOffset):r(this.element.childNodes)},get firstChild(){return this.childNodes[0]||null},get lastChild(){return this.childNodes.slice(-1)[0]||null},selectedInRange:function(a){return K(a,this.element)||!!t(this.childNodes,function(b){return K(a,b.element)})||!!t(this.childDOMNodes,function(b){return 3===b.nodeType&&J(a,b)})},createRange:function(a){return+a===a?I(this.element,B(this.element,f)?!!(4&a):a):B(this.element,f)?this.element.cloneRange():I(this.element,!!a)},createDOMNodeIterator:function(a,b){return new o(this,a,b)},cloneDOMNodes:function(b){return B(this.element,f)?P(a.map(this.childDOMNodes,function(a){return a.cloneNode(b)})):this.element.cloneNode(b)}},n.prototype={previousSibling:function(){return Y(this,"firstChild","nextSibling")},nextSibling:function(){return Y(this,"lastChild","previousSibling")},firstChild:function(){return X(this,"firstChild","nextSibling")},lastChild:function(){return X(this,"lastChild","previousSibling")},parentNode:function(){for(var a=this.currentNode;a&&a!==this.root;a=a.parentNode)if(W(this,a.parentNode,!0))return a.parentNode},previousNode:function(){for(var a=this.currentNode;a&&a!==this.root;){for(var b=a.previousSibling;b;b=a.previousSibling){a=b;for(var c=V(this,b);2!==c&&U(this,a.childNodes[0])&&a.childNodes[0];)a=a.lastChild,c=V(this,a,!0);if(1===c)return this.currentNode=a,a}if(a=U(this,a.parentNode)&&a.parentNode,!a||a===this.root)return null;if(W(this,a,!0))return a}},nextNode:function(){for(var a=this.currentNode,b=1;a;){for(;2!==b&&a.childNodes[0];){if(a=a.firstChild,W(this,a,!0))return a;b=V.returnValue}for(;a&&a!==this.root&&!a.nextSibling;)a=U(this,a.parentNode)&&a.parentNode;if(!a||a===this.root)return null;if(a=a.nextSibling,W(this,a))return a;b=V.returnValue}}},o.prototype={get currentNode(){return this.iterator.currentNode},set currentNode(a){this.iterator.currentNode=a},previousNode:function(){return $(this,"previousNode")},nextNode:function(){return $(this,"nextNode")}},q(o.prototype,{iterator:function(){var a=this.typerNodeIterator;return C(a.currentNode)||a.nextNode(),this.iteratorStack=[],Z(this)}}),j.prototype={getSelectedElements:function(b){return a(this.selectedElements).filter(b||"*").get()},getEditableElements:function(b,c){return a(b.element).find(this.editableElements).filter(c||"*").get()},createTreeWalker:function(a,b){return _(this,a,b)},createDOMNodeIterator:function(a,b){return new o(_(this,ua|wa|sa),a,b)}},q(j.prototype,{widgets:function(){return a.map(ba(this),function(a){return a.widget})},editableElements:function(){return a.map(ba(this).concat(w(_(this,ta))),function(a){return a.containingElement})},paragraphElements:function(){var b=new n(this.focusNode,ua|xa),c=w(b,null,this.startNode);return c.splice(c.indexOf(this.endNode)+1),a.map(c,function(a){return a.containingElement})},selectedElements:function(){return w(_(this,ua|wa),function(a){return a.containingElement})},previousNode:function(){return aa(this.startNode,ua|sa).previousNode()||null},nextNode:function(){return aa(this.endNode,ua|sa).nextNode()||null},previousTextNode:function(){return aa(this.startNode,ua,this.startTextNode||this.startElement).previousNode()||null},nextTextNode:function(){return aa(this.endNode,ua,this.endTextNode||this.endElement).nextNode()||null},textStart:function(){if(this.startTextNode&&(!this.startOffset||this.startTextNode.nodeValue.slice(0,this.startOffset)===la))return!this.previousTextNode||!K(this.startNode.element,this.previousTextNode)||"br"===A(this.previousTextNode.nextSibling)&&this.startTextNode.previousSibling===this.previousTextNode.nextSibling},textEnd:function(){if(this.endTextNode&&(this.endOffset===this.endTextNode.length||this.endTextNode.nodeValue.slice(this.endOffset)===la))return!this.nextTextNode||!K(this.endNode.element,this.nextTextNode)||"br"===A(this.nextTextNode.previousSibling)&&this.endTextNode.nextSibling===this.nextTextNode.previousSibling},isSingleEditable:function(){return!w(_(this,ta))[1]}}),k.prototype={remove:function(){var a=this;a.typer.invoke(function(b){b.select(a.element),b.insertText()})}},fa("inlineStyle",{bold:ea("bold","b"),italic:ea("italic","i"),underline:ea("underline","u"),superscript:ea("superscript","sup"),subscript:ea("subscript","sub"),applyClass:function(b,c){var d=b.selection.paragraphElements;a(b.getSelectedTextNodes()).wrap(R("span",c)),a("span:has(span)",d).each(function(b,c){a(c).contents().unwrap().filter(function(a,b){return 3===b.nodeType}).wrap(R("span",c.className))}),a('span[class=""]',d).contents().unwrap(),b.restoreSelection()}},"ctrlB:bold ctrlI:italic ctrlU:underline"),
fa("formatting",{justifyCenter:da("center"),justifyFull:da("justify"),justifyLeft:da("left"),justifyRight:da("right"),formatting:function(b,c){var d=/^([^.]*)(?:\.(.+))?/.exec(c)||[];"ol"===d[1]||"ul"===d[1]?ca(d[1],d[2])(b):a(b.selection.paragraphElements).not("li").wrap(R(d[1]||"p",d[2])).contents().unwrap(),b.restoreSelection()},insertLine:function(a){a.insertText("\n\n")},insertLineBreak:function(a){var b=a.insertHtml("<br>"+(a.selection.textEnd?ma:""));a.select(b[0],ra)}},"enter:insertLine shiftEnter:insertLineBreak ctrlShiftL:justifyLeft ctrlShiftE:justifyCenter ctrlShiftR:justifyRight"),fa("list",{insertOrderedList:ca("ol"),insertUnorderedList:ca("ul"),indent:ca("indent"),outdent:ca("outdent")}),fa("link",{createLink:function(a,b){b=b||/^[a-z]+:\/\//g.test(a.getSelectedText())&&RegExp.input||"#",a.select(a.selection.getSelectedElements("a")[0]||a.selection),a.execCommand("createLink",b)},unlink:function(a){var b=a.selection.getSelectedElements("a")[0];b&&(a.select(b),a.execCommand("unlink"))}}),a.fn.typer=function(b){return this.each(function(c,d){new T(a.extend({},b,{element:d}))})},!Ca){try{c.designMode="on",c.execCommand("enableObjectResizing",!1,!1),c.execCommand("enableInlineTableEditing",!1,!1)}catch(a){}c.designMode="off"}a(c.body).bind("mscontrolselect",function(a){a.preventDefault()}),"undefined"==typeof h&&(h=function(){Object.defineProperty(this,"__dataKey__",{value:"typer"+Math.random().toString(36).substr(2,8)})},h.prototype={get:function(b){return a(b).data(this.__dataKey__)},set:function(b,c){a(b).data(this.__dataKey__,c)},has:function(b){return this.__dataKey__ in a(b).data()},delete:function(b){delete a(b).data()[this.__dataKey__]}})}(jQuery,window,document,String,Node,Range,DocumentFragment,Map,[]),function(a,b){"use strict";function c(a,b){return new Array(b+1).join(a)}function d(b,c,d){var e=a(">tbody>tr",b.widget.element).eq(Math.max(0,b.widget.row+c)).children()[Math.max(0,b.widget.column+d)];b.normalize(b.widget.element),b.moveCaret(e,-0)}var e="<td></td>",f="<th></th>",g="<tr>%</tr>";b.widgets.table={element:"table",editable:"th,td",beforeStateChange:function(b){var c=b.typer.getSelection(),d=c.getEditableElements(b.widget),e=d.length>1?-1:a(d).index(),f=d.length>1?-1:a(d).parent().index();a.extend(b.widget,{row:f,rowCount:a(">tbody>tr",b.widget.element).length,rowCells:a(">tbody>tr:nth-child("+(f+1)+")>*",b.widget.element).get(),column:e,columnCount:a(">tbody>tr:first>*",b.widget.element).length,columnCells:a(">tbody>tr>*:nth-child("+(e+1)+")",b.widget.element).get()})},tab:function(b){var c=a(">tbody>tr>*",b.widget.element).get(),d=b.widget.row*b.widget.columnCount+b.widget.column;d<c.length-1&&b.typer.moveCaret(c[d+1])},shiftTab:function(b){var c=a(">tbody>tr>*",b.widget.element).get(),d=b.widget.row*b.widget.columnCount+b.widget.column;d>0&&b.typer.moveCaret(c[d-1],-0)},ctrlEnter:function(a){0===a.widget.row&&0===a.widget.column?a.typer.invoke("insertSpaceBefore"):a.widget.row===a.widget.rowCount-1&&a.widget.column===a.widget.columnCount-1&&a.typer.invoke("insertSpaceAfter")},commands:{justifyLeft:function(b){a(b.selection.getEditableElements(b.widget)).attr("align","left")},justifyCenter:function(b){a(b.selection.getEditableElements(b.widget)).attr("align","center")},justifyRight:function(b){a(b.selection.getEditableElements(b.widget)).attr("align","right")},addColumnBefore:function(b){a(b.widget.columnCells).filter("th").before(f),a(b.widget.columnCells).filter("td").before(e),d(b,0,0)},addColumnAfter:function(b){a(b.widget.columnCells).filter("th").after(f),a(b.widget.columnCells).filter("td").after(e),d(b,0,1)},addRowAbove:function(b){a(b.widget.rowCells).before(g.replace("%",c(e,b.widget.columnCount))),d(b,0,0)},addRowBelow:function(b){a(b.widget.rowCells).after(g.replace("%",c(e,b.widget.columnCount))),d(b,1,0)},removeColumn:function(b){a(b.widget.columnCells).remove(),d(b,0,-1)},removeRow:function(b){a(b.widget.rowCells).remove(),d(b,-1,0)},toggleTableHeader:function(b){a(b.widget.element).find("th")[0]?(a(b.widget.element).find("tr:has(th)").remove(),0===b.widget.row&&d(b,0,0)):(a(b.widget.element).find("tbody").prepend(g.replace("%",c(f,b.widget.columnCount))),d(b,-b.widget.row,-b.widget.column))},insertSpaceBefore:function(a){a.select(a.widget.element,b.COLLAPSE_START_OUTSIDE),a.insertText("")},insertSpaceAfter:function(a){a.select(a.widget.element,b.COLLAPSE_END_OUTSIDE),a.insertText("")}}}}(jQuery,window.Typer),function(a,b){"use strict";function c(b,c,d){"function"==typeof c&&(d=c,c=void 0),d=d||function(b){a.extend(this,b)};var e={},f="function"!=typeof b?null:function(){b.apply(this,arguments)},g=function(a){if(!(this instanceof g)){var b=new g(e);return g.apply(b,arguments),b}if(a!==e)try{this._super=f,d.apply(this,arguments)}finally{this._super=null}};return g.prototype=f?new b(c):b,g}function d(a){var b=/^([\w:]*)(?:\(([^}]+)\))?$/.exec(a),c=null;try{c=b[2]&&JSON.parse(("{"+b[2]+"}").replace(/([{:,])\s*([^\s:,}]+)/g,'$1"$2"'))}catch(a){}return{name:b[1],params:c}}function e(b){var c=a(b).css("text-align"),d=a(b).css("direction");switch(c){case"-webkit-left":return"left";case"-webkit-right":return"right";case"start":return"ltr"===d?"left":"right";case"end":return"ltr"===d?"right":"left";default:return c}}function f(b,c){return c=window.prompt(b,c),null!==c?a.when(c):a.Deferred().reject().promise()}function g(b,c){if(c=c||b,c.controls){var e=c.controls.split(/\s+/),f={};a.each(e,function(b,c){if("*"===c.slice(-1))a.each(p,function(a,b){a.slice(0,c.length-1)===c.slice(0,-1)&&e.indexOf("-"+a)<0&&!f[a]&&(f[a]=Object.create(b))});else if("-"!==c.charAt(0)){var g=d(c);p[g.name]&&e.indexOf("-"+g.name)<0&&!f[g.name]&&(f[g.name]=a.extend(Object.create(p[g.name]),g.params))}});var h=[];a.each(f,function(a,b){h.push(b)}),c.controls=h}else"function"==typeof c.createChildren&&(c.controls=c.createChildren(b,c)||[]);return a.each(c.controls||[],function(a,d){d.parent=c,g(b,d)}),c.controls}function h(b,c,e){function f(e){var g=a(b.renderer[e]||'<div><br x:t="children"></div>')[0];return a(g).find("*").andSelf().filter("[x\\:bind]").each(function(b,e){var f=d(a(e).attr("x:bind"));c.bindData.push([e,f.params])}),a("[x\\:t]",g).each(function(e,g){var h=d(a(g).attr("x:t"));a(g).replaceWith("function"==typeof b.renderer[h.name]?b.renderer[h.name](b,c,h.params):f(h.name))}),g}return c=c||b,c.bindData=[],c.element=f(c.type),a(c.element).bind(b.renderer[c.type+"ExecuteOn"],function(){b.execute(c)}),c.element}function i(b,c,d){return a.map(c.controls,function(a){return h(b,a,d)})}function j(b,c){if(a.each((c||b).controls||[],function(a,c){j(b,c)}),c){c.stateChange&&(c.stateChange(b,c),b.renderer[c.type+"StateChange"]&&b.renderer[c.type+"StateChange"](b,c));var d=b.enabled(c)===!1,e=!c.hiddenWhenDisabled||!d;"string"==typeof c.dependsOn?e&=b.typer.hasCommand(c.dependsOn):c.dependsOn&&(e&=!a.grep(c.dependsOn,function(a){return!b.typer.hasCommand(a)})[0]),e&&a.each(c.bindData,function(b,d){a.each(d[1],function(b,e){"_"===b?a(d[0]).text(c[e]||""):a(d[0]).attr(b,c[e]||"")})});var f=a(c.element);f.prop("disabled",d),b.options.controlDisabledClass&&f.toggleClass(b.options.controlDisabledClass,d),b.options.controlActiveClass&&f.toggleClass(b.options.controlActiveClass,!!b.active(c)),b.options.controlHiddenClass?f.toggleClass(b.options.controlHiddenClass,!e):e?f.data("original-display")?f.css("display",f.data("original-display")):f.show():("none"!==f.css("display")&&f.data("original-display",f.css("display")),f.hide())}}function k(b,c){g(b),b.element=h(b);var d=a(b.element).addClass("typer-toolbar");c?d.appendTo(c):(d.addClass("typer-toolbar-floating").css("z-index",1e3),d.mousedown(function(c){var e=d.position();if(c.target===b.element){var f=function(a){l(b,{top:e.top+(a.clientY-c.clientY),left:e.left+(a.clientX-c.clientX)})};a(document.body).mousemove(f),a(document.body).mouseup(function(){a(document.body).unbind("mousemove",f)})}setTimeout(function(){clearTimeout(b.toolbarTimeout)})})),a.each("enabled active execute".split(" "),function(a,c){b[c]=function(a){if("function"==typeof a[c]&&("execute"!==c||b.enabled(c)!==!1)){var d=Array.prototype.slice.apply(arguments);return d.unshift(b),a[c].apply(a,d)}}}),b.typer.retainFocus(b.element)}function l(c,d){if(c.widget||!c.options.container)if(clearTimeout(o),n!==c&&(m(!0),n=c,a(c.element).appendTo(document.body)),d)c.position="fixed",a(c.element).css(d);else if("fixed"!==c.position){var e=b.createRange(c.typer.element).getBoundingClientRect(),f=a(c.element).height();e.top+e.height>document.body.offsetHeight?c.position="":e.top<f&&(c.position="bottom"),a(c.element).css({left:e.left+document.body.scrollLeft,top:("bottom"===c.position?e.top+e.height+10:e.top-f-10)+document.body.scrollTop})}}function m(b){clearTimeout(o),b?n&&(a(n.element).detach(),n.position="",n=null):o=setTimeout(function(){m(!0)},100)}var n,o,p={};b.widgets.toolbar={options:{container:"",controlActiveClass:"active",controlDisabledClass:"disabled",controlHiddenClass:"",controls:"",renderer:null,formattings:{h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",p:"Paragraph",ul:"Unordered List",ol:"Ordered List"},inlineClasses:{},prompt:f,selectLink:function(){return this.prompt("Enter URL")},selectImage:function(){return this.prompt("Enter Image URL")}},init:function(a){var b=a.widget;b.controls=b.options.controls||"__root__",b.renderer=x[b.options.renderer]||x.default,k(b,b.options.container)},widgetInit:function(a,b){b.toolbar={typer:a.typer,widget:b,controls:"g:widget",renderer:a.widget.renderer,options:a.widget.options},k(b.toolbar)},focusin:function(a){l(a.widget)},focusout:function(a){setTimeout(m)},widgetFocusin:function(a,b){l(b.toolbar)},widgetFocusout:function(a,b){l(a.widget)},beforeStateChange:function(b){var c=b.typer.getSelection(),d={fontWeight:null,fontStyle:null,textDecoration:null,textAlign:null,inlineClass:null};a(c.selectedElements).each(function(b,c){a.each(d,function(b,f){var g;g="textAlign"===b?e(c):"inlineClass"===b?a(c).filter("span").attr("class")||"":a(c).css(b),d[b]=""===f||f&&f!==g?"":g})});var f=c.paragraphElements.slice(-1)[0];a(f).is("li")&&(f=a(f).closest("ol, ul")[0]||f);var g=f&&f.tagName.toLowerCase(),h=g+(a(f).attr("class")||"").replace(/^(.)/,".$1");b.widget.state={linkElement:c.getSelectedElements("a")[0]||null,bold:"bold"===d.fontWeight||"700"===d.fontWeight,italic:"italic"===d.fontStyle,underline:"underline"===d.textDecoration,superscript:c.getSelectedElements("sup").length>0,subscript:c.getSelectedElements("sub").length>0,insertUnorderedList:"ul"===g,insertOrderedList:"ol"===g,justifyLeft:"left"===d.textAlign,justifyCenter:"center"===d.textAlign,justifyRight:"right"===d.textAlign,inlineClass:d.inlineClass,formatting:g,formattingWithClassName:h}},stateChange:function(a){n&&j(n)}};var q=c({type:"button"}),r=c({type:"dropDown",stateChange:function(b,c){a.each(c.controls,function(d,e){if(b.active(e))return a("select",c.element).prop("selectedIndex",d),c.selectedIndex=d,c.selectedValue=e.label||e.name,!1})},execute:function(a,b){a.execute(b.selectedIndex)},enabled:function(a,b){return b.controls.length>0}}),s=c({type:"group",hiddenWhenDisabled:!0},function(b,c){this.controls=b,a.extend(this,c)}),t=c(q,function(a){this._super({name:a,dependsOn:a,execute:function(b){b.typer.invoke(a)},active:function(b){return b.state[a]},enabled:function(b){return!!b.state.formatting&&("indent"!==a&&"outdent"!==a||b.state.insertOrderedList||b.state.insertUnorderedList)}})}),u=c(q,function(b,c,d,e){this._super({name:b,execute:function(b){a.when((e||d)(b)).done(function(e){b.typer.invoke(function(b){if("object"!=typeof e){var f=e;e={},e[d]=f}b.insertHtml(a("<"+c+">",e)[0])})})}})});a.extend(p,{__root__:s("g:* -g:widget"),"g:history":s("history:*"),"g:insert":s("insert:*"),"g:formatting":s("formatting:paragraph formatting:inlineStyle formatting:*",{hiddenWhenDisabled:!0,enabled:function(a){return!!a.state.formatting}}),"formatting:bold":t("bold"),"formatting:italic":t("italic"),"formatting:underline":t("underline"),"formatting:unorderedList":t("insertUnorderedList"),"formatting:orderedList":t("insertOrderedList"),"formatting:indent":t("indent"),"formatting:outdent":t("outdent"),"formatting:justifyLeft":t("justifyLeft"),"formatting:justifyCenter":t("justifyCenter"),"formatting:justifyRight":t("justifyRight"),"formatting:paragraph":r({name:"paragraph",dependsOn:"formatting",hiddenWhenDisabled:!0,createChildren:function(b){return a.map(Object.keys(b.options.formattings||{}),function(a){return q({name:a,label:b.options.formattings[a],execute:function(){b.typer.invoke("formatting",a)},active:function(){return b.state.formattingWithClassName===a||b.state.formatting===a}})})}}),"formatting:inlineStyle":r({name:"inlineStyle",dependsOn:"applyClass",hiddenWhenDisabled:!0,createChildren:function(b){return a.map(Object.keys(b.options.inlineClass||{}),function(a){return q({name:a,label:b.options.inlineClass[a],execute:function(){b.typer.invoke("applyClass",a)},active:function(){return b.state.inlineClass===a}})})}}),"insert:anchor":u("insertAnchor","a","name",function(b){return a.when(b.options.prompt("Enter Anchor Name"))}),"insert:image":u("insertImage","img","src",function(b){return a.when(b.options.selectImage())}),"insert:link":q({name:"insertLink",dependsOn:"createLink",execute:function(b){a.when(b.options.selectLink({href:a(b.state.linkElement).attr("href"),target:a(b.state.linkElement).attr("target")})).done(function(a){b.typer.invoke("createLink",a)})},active:function(a){return!!a.state.linkElement}}),"history:undo":q({name:"undo",execute:function(a){a.typer.undo()},enabled:function(a){return a.typer.canUndo()}}),"history:redo":q({name:"redo",execute:function(a){a.typer.redo()},enabled:function(a){return a.typer.canRedo()}}),"g:widget":s("",{createChildren:function(b,c){if(b.widget){var d=[];return a(b.widget.element).is("img")&&d.push("media:filePicker(icon:insertImage) media:*"),d.push("widget:*"),c.controls=d.join(" "),g(b,c)}},enabled:function(a){return!!a.widget}}),"widget:delete":q({name:"delete",execute:function(a){a.widget.remove()},enabled:function(a){return!!a.widget}}),"media:filePicker":q({name:"filePicker",stateChange:function(b,c){c.label=(/(?:^|\/)(.+)$/.exec(a(b.widget.element).attr("src"))||[""])[0]},execute:function(b){var c=a(b.widget.element).attr("src");a.when(b.options.selectImage(c)).then(function(c){b.typer.invoke(function(d){a(b.widget.element).attr("src",c.src||c)})})}})});var v={createLink:"Insert Link",bold:"Bold",insertAnchor:"Insert Anchor",insertImage:"Insert Photo",italic:"Italic",indent:"Indent",insertUnorderedList:"Bullet List",insertOrderedList:"Numbered List",justifyCenter:"Align Center",justifyLeft:"Align Left",justifyRight:"Align Right",outdent:"Outdent",redo:"Redo",underline:"Underlined",undo:"Undo",delete:"Delete",formatting:"Formatting",inlineStyle:"Inline Style"},w={undo:"undo",redo:"redo",insertAnchor:"label",insertImage:"insert_photo",insertVideo:"videocam",tableTable:"border_all",bold:"format_bold",italic:"format_italic",underline:"format_underlined",insertUnorderedList:"format_list_bulleted",insertOrderedList:"format_list_numbered",indent:"format_indent_increase",outdent:"format_indent_decrease",justifyLeft:"format_align_left",justifyCenter:"format_align_center",justifyRight:"format_align_right",insertLink:"insert_link",delete:"delete"},x=c({group:'<div class="typer-toolbar-group"><br x:t="children"/></div>',label:'<span class="typer-toolbar-label"><br x:t="icon"/><span x:bind="(_:label)"></span></span>',button:'<button x:bind="(title:label)"><br x:t="label"/></button>',buttonExecuteOn:"click",dropDown:'<div class="typer-toolbar-dropdown" x:bind="(title:label)"><select><option x:t="children(t:dropDownItem)"/></select></div>',dropDownExecuteOn:"change",dropDownStateChange:null,dropDownItem:'<option x:bind="(value:name,_:label)"></option>',children:i});x.default=x(),x.material=x({resources:["https://fonts.googleapis.com/css?family=Roboto:400,500,700","https://fonts.googleapis.com/icon?family=Material+Icons","https://raw.githubusercontent.com/misonou/jquery-typer/master/css/jquery.typer.material.css"],labelText:function(a,b){return w[b.id]||w[b.name]?"":b.label},dropDown:'<div class="typer-toolbar-dropdown typer-toolbar-menu"><button x:bind="(title:label)"><span class="typer-toolbar-label"><br x:t="icon"/><span x:bind="(_:selectedValue)"></span></span></button><div class="typer-toolbar-controlpane"><br x:t="children"></div></div>',dropDownStateChange:function(a,b){},icon:function(a,b){var c=w[b.icon]||w[b.name];return c?'<i class="material-icons">'+c+"</i>":""}}),b.toolbar={labels:v,controls:p,renderer:x,button:q,dropDown:r,group:s}}(jQuery,window.Typer);
//# sourceMappingURL=jquery.typer.min.js.map