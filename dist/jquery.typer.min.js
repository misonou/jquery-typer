/*! jQuery Typer Plugin v0.11.3 | https://github.com/misonou/jquery-typer | The MIT License (MIT) */

!function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";!function(a,f,p){function q(a,b){var c=this;Yb.set(c,{}),c.typer=a,c.baseCaret=new w(a,c),c.extendCaret=new w(a,c),b&&c.select(b)}function r(a,b,c,d){var e=this;e.typer=a,e.id=b,e.element=c||null,e.options=d||{}}function s(a,b,c,d,e){var f=Qb(this,e);f.eventName=a,f.source=_b[1]===b?_b[0]:"script",f.timestamp=performance.now(),f.typer=b,f.widget=c||null,f.data=void 0!==d?d:null}function t(a,b,c,d){var e=this;e.typer=a,e.childNodes=[],e.nodeType=b,e.element=c,e.widget=d}function u(a,b,c){var d=this;d.whatToShow=b,d.filter=c||null,d.currentNode=a,d.root=a}function v(a,b,c){var d=this;d.whatToShow=b,d.filter=c||null,Na(d,a)}function w(a,b){this.typer=a,this.selection=b||null}function x(a,b,c,d){var e=this;e.left=a,e.top=b,e.right=c,e.bottom=d}function y(a){var b=0;return function(c,d,e){try{return b++,c.apply(e||this,d)}finally{0==--b&&a()}}}function z(a,b,c){d.defineProperty(a,b,{configurable:!0,writable:!0,value:c})}function A(a,b){a.prototype=b,z(b,"constructor",a)}function B(b,c){var d;return a.each(b,function(a,b){return!(d=c.call(this,b,a)&&b)}),d}function C(a,b){return b=b||a.currentNode,b&&a.whatToShow&(M(a,u)?b.nodeType:1<<b.nodeType-1)?a.filter?(a.filter.acceptNode||a.filter).call(a.filter,b):1:3}function D(b,c,d,e){switch(b.currentNode=d=d||b.currentNode,c=c||a.noop,C(b)){case 2:return;case 1:c(d)}for(var f;(f=b.nextNode())&&(!e||(Pb(e)?e(f):f!==e||void c(f)));c(f));}function E(b,c,d,e){var f=[];return D(b,p.push.bind(f),d,e),c?a.map(f,c):f}function F(a,b){return a[b<0?"previousNode":"nextNode"]()}function G(a,b){var c=[];a.forEach(function(a){c[c.length]=a}),a.clear(),c.forEach(b)}function H(a){return e(a||"").replace(/^(?:\u200b|[^\S\u00a0])+|(?:\u200b|[^\S\u00a0])+$/g,"")}function I(a){return e(a||"").replace(/[^\S\u00a0]+/g," ").replace(/\u200b/g,"")}function J(a){return a=e(a||""),a.charAt(0).toUpperCase()+a.slice(1)}function K(a){return a=e(a||""),a.charAt(0).toLowerCase()+a.slice(1)}function L(a){return a&&a.tagName&&a.tagName.toLowerCase()}function M(b,c){return!(!b||!c)&&(c.prototype?b instanceof c&&b:c.toFixed?b.nodeType&c&&b:("*"===c||L(b)===c||a(b).is(c))&&b)}function N(a){return a&&1===a.nodeType&&a}function O(a){return a&&3===a.nodeType&&a}function P(a){return"br"===L(a)&&a}function Q(a,b,c){var d=a.data;return c>=0&&(b===a.length||d.slice(b)===gb)?1:c<=0&&(!b||d.slice(0,b)===gb)?-1:0}function R(a,b){return!!Hb.test(a)||!/[^\s!-\/:-@\[\]^_`{|}~]/.test(a)&&b}function S(a){var b=Sb(N(a)||a.parentNode);return Eb[b.getPropertyValue("writing-mode")]^("rtl"===b.direction?2:0)}function T(a,b){for(;a&&!M(a,b);a=a.parentNode);return M(a,lb)?a.typer.getNode(a.widget.element):a}function U(a,b){var c=a.attributes,d=b.attributes;return c.length===d.length&&!B(c,function(a){return!d[a.nodeName]||a.value!==d[a.nodeName].value})}function V(a,b){return L(a)===L(b)&&U(a,b)}function W(a,b,c){if(a===b)return 0;var d=a&&b&&Nb.call(a,b);return 2&d?c&&8&d||1&d?NaN:1:4&d?c&&16&d||1&d?NaN:-1:NaN}function X(a,b){return a&&b&&!(1&Nb.call(a.commonAncestorContainer||a,b.commonAncestorContainer||b))}function Y(b,c){return b=(b||"").element||b,c=(c||"").element||c,b===c||a.contains(b,c)}function Z(a,b){for(b=b||a;a&&a!==b&&20!==Nb.call(a,b);a=a.parentNode);return a}function $(a,b){var c=a.length||a.childNodes.length;return 1/b<0?g.max(0,c+b):g.min(c,b)}function _(a,b){for(var c,d=new v(new u(a,wb),5),e=0;(c=d.nextNode())&&c!==b;e+=c.length||0);return e}function aa(a,b,d,e){if(a&&Pb(a.getRange))return a.getRange();var f;if(M(a,h)?(f=c.createRange(),+b!==b?(f["contents"!==b&&a.parentNode?"selectNode":"selectNodeContents"](a),"boolean"==typeof b&&f.collapse(b)):f.setStart(a,$(a,b)),M(d,h)&&X(a,d)&&f.setEnd(d,$(d,e))):M(a,i)&&(f=a.cloneRange(),f.collapsed||"boolean"!=typeof b||f.collapse(b)),M(b,i)&&X(f,b)){var g=f.collapsed&&b.collapsed?-1:1;Ob.call(f,0,b)*g<0&&f.setStart(b.startContainer,b.startOffset),Ob.call(f,2,b)*g>0&&f.setEnd(b.endContainer,b.endOffset)}return f}function ba(a,b){return a=M(a,i)||aa(a),b=M(b,i)||aa(b),X(a,b)&&Ob.call(a,3,b)<=0&&Ob.call(a,1,b)>=0}function ca(a,b){return a=M(a,i)||aa(a),b=M(b,i)||aa(b),X(a,b)&&Ob.call(a,0,b)<=0&&Ob.call(a,2,b)>=0}function da(a,b){return a=M(a,i)||aa(a),b=M(b,i)||aa(b),X(a,b)&&0===Ob.call(a,0,b)&&0===Ob.call(a,2,b)}function ea(a,b,c){a=M(a,i)||aa(a),b=M(b,i)||aa(b);var d=X(a,b)?Ob.call(a,0,b)+Ob.call(a,2,b):NaN;return c&&(0!==d&&ba(a,b)||0===d&&!da(a,b))?NaN:d&&d/g.abs(d)}function fa(a,b){var c;if(a=a||f,a.getRect)return a.getRect();if((a=a.element||a)===f)c=ga(0,0,f.offsetWidth,f.offsetHeight);else if(Y(f,a)){if(c=ga(a.getBoundingClientRect()),b){var d=Sb(a);c.top-=g.max(0,l(d.marginTop)),c.left-=g.max(0,l(d.marginLeft)),c.right+=g.max(0,l(d.marginRight)),c.bottom+=g.max(0,l(d.marginBottom))}}else c=ga(0,0,0,0);return c}function ga(a,b,c,d){function e(a){return g.round(1e3*a)/1e3}return void 0!==a.top?new x(e(a.left),e(a.top),e(a.right),e(a.bottom)):void 0===c?new x(a,b,a,b):new x(a,b,c,d)}function ha(a,b){function c(c){return g.abs(a[c]-b[c])<1}return c("left")&&c("top")&&c("bottom")&&c("right")}function ia(a,b){return b.left>=a.left&&b.right<=a.right&&b.top>=a.top&&b.bottom<=a.bottom}function ja(a,b,c,d){return d=d||0,c.width&&c.height&&a-c.left>=-d&&a-c.right<=d&&b-c.top>=-d&&b-c.bottom<=d}function ka(a,b){return ga(g.min(a.left,b.left),g.min(a.top,b.top),g.max(a.right,b.right),g.max(a.bottom,b.bottom))}function la(b){return a.map((M(b,i)||aa(b,"contents")).getClientRects(),ga)}function ma(a,b){var c=b/g.abs(b);a=M(a,x)||fa(a),b/=c;var d=2&b?-1:1,e=4&b?-1:1;c>0&&1&b&&(d^=e,e^=d,d^=e);var f=d<0?"right":"left",h=e<0?"bottom":"top";return a=1&b?ga(a[h]*e,a[f]*d,a[Db[h]]*e,a[Db[f]]*d):ga(a[f]*d,a[h]*e,a[Db[f]]*d,a[Db[h]]*e)}function na(a,b){b=+b===b?b:S(b),a=+a===a?a:Gb.indexOf(a);var c=a>>1&1^1&b?"left":"top";return!!(Fb[a>>1]&1<<b)^1&a?Db[c]:c}function oa(a){if(Rb.rangeCount){var b=Rb.getRangeAt(0);return Y(a,b.commonAncestorContainer)&&b}}function pa(b,d,e){if(e=e||c.body,Mb)return B(Mb.call(c,b,d),function(b){return Y(e,b)&&"none"!==a.css(b,"pointer-events")})||null;var f=c.elementFromPoint(b,d);if(!Y(e,f)&&ja(b,d,fa(e))){var g=[];try{for(;W(e,f,!0);){var h=a(f).parentsUntil(Z(e,f)).slice(-1)[0]||f;if(h===g[g.length-1])return null;h.style.pointerEvents="none",g[g.length]=h,f=c.elementFromPoint(b,d)}}finally{a(g).css("pointer-events","")}}return Y(e,f)?f:null}function qa(b){return M(b,j)||a(c.createDocumentFragment()).append(b)[0]}function ra(a){return c.createTextNode(a||gb)}function sa(a){return c.createElement(a)}function ta(a,b){return c.createNodeIterator(a,b,null,!1)}function ua(a,b){switch(b){case"uppercase":return a.toUpperCase();case"lowercase":return a.toLowerCase();case"capitalize":return a.replace(/\b(.)/g,function(a){return a.toUpperCase()})}return a}function va(a,b){a.data!==b&&(a.data=b)}function wa(b){a(b).remove()}function xa(b,c){return a.each(c,function(c,d){b=a(d.cloneNode(!1)).append(b)[0]}),M(b,h)||qa(b)}function ya(a){try{Rb.removeAllRanges()}catch(a){var b=c.body.createTextRange();b.collapse(),b.select(),Rb.removeAllRanges()}try{Rb.addRange(a)}catch(b){Rb.rangeCount||(Rb.addRange(aa(c.body)),Rb.removeAllRanges(),Rb.addRange(a))}}function za(b){for(;b!==f&&"visible"===a.css(b,"overflow");b=b.parentNode);return b}function Aa(d,e){var h=za(d),i=fa(h===c.body?f:h),j=Sb(h),k=h===f||h===c.body?b:h,l=a(k).scrollLeft(),m=a(k).scrollTop(),n=g.max(0,e.right-(i.right-("scroll"===j.overflowY||"auto"===j.overflowY&&h.scrollHeight>h.offsetHeight?cb:0)))||g.min(e.left-i.left,0),o=g.max(0,e.bottom-(i.bottom-("scroll"===j.overflowX||"auto"===j.overflowY&&h.scrollWidth>h.offsetWidth?cb:0)))||g.min(e.top-i.top,0);(n||o)&&(k.scrollTo?k.scrollTo(l+n,m+o):(k.scrollLeft=l+n,k.scrollTop=m+o));var p={x:a(k).scrollLeft()-l,y:a(k).scrollTop()-m};if(k!==b){var q=Aa(h.parentNode,e.translate(p.x,p.y));q&&(p.x+=q.x,p.y+=q.y)}return!(!p.x&&!p.y)&&p}function Ba(b){var d=Ba.cache||(Ba.cache={}),e=Sb(N(b)||b.parentNode),f=[e.fontFamily,e.fontWeight,e.fontStyle].join("|");if(!d[f]){var g=a('<div style="position:fixed;font-size:1000px;"><span style="display:inline-block;width:0;height:0;"></span>&nbsp;</div>').css({fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontStyle:e.fontStyle}).appendTo(c.body),h=g.children(),i=fa(g[0]).top;d[f]={baseline:(fa(h.css("vertical-align","baseline")[0]).top-i)/1e3,height:(fa(h.css("vertical-align","text-bottom")[0]).top-i)/1e3,middle:(fa(h.css("vertical-align","middle")[0]).top-i)/1e3,wsWidth:g.width()/1e3},g.remove()}var j=l(e.fontSize);return{fontSize:j,baseline:d[f].baseline*j,height:d[f].height*j,middle:d[f].middle*j,wsWidth:d[f].wsWidth*j}}function Ca(a){n(a._timeout),a._timeout=m.apply(null,arguments)}function Da(a,b){_b[0]||m(function(){_b=[]}),(_b[1]||b)===b&&fb.indexOf(a)>fb.indexOf(_b[0])&&(_b=[a,b])}function Ea(b,c){a(b).on("mousedown mouseup mousewheel keydown keyup keypress touchstart touchend",function(a){var b=a.type.charAt(0);Da("k"===b?"keyboard":"t"===b?"touch":"mouse",c),ab=a.target})}function Fa(){var b=a.grep(arguments,a.isFunction);return function(a){for(var c=1,d=0,e=b.length;d<e;d++){var f=b[d](a);if(2===f)return 2;c|=f}return c}}function Ga(b,d,e){var g,h=a.Deferred(),i=b,j=za(N(d)||b.target),k={keydown:function(a){27===a.which&&(h.reject(),k.mouseup(a))},mousemove:function(a){if(!a.which)return void k.mouseup(a);a.clientX===i.clientX&&a.clientY===i.clientY||(i=a,h.notify(a.clientX,a.clientY)),a.preventDefault()},mouseup:function(b){clearInterval(g),a(c.body).off(k),a(j).off(l),h.resolve()}},l={mouseout:function(a){g||Y(j,a.relatedTarget)&&(j!==f||a.relatedTarget!==f)||(g=setInterval(function(){Aa(j,ga(i.clientX-50,i.clientY-50,i.clientX+50,i.clientY+50))?h.notify(i.clientX,i.clientY):(clearInterval(g),g=null)},20))},mouseover:function(a){a.target!==f&&(clearInterval(g),g=null)}};return a(c.body).on(k),a(j).on(l),h.promise().progress(e||d)}function Ha(f,i){function k(a){this.widget=a||null}function l(a,b,c){var d=pa[a];return!(b in d)||"*"===d[b]||(" "+d[b]+" ").indexOf(" "+c+" ")>=0}function o(a,b){return b=T(b,tb),(pa[a].inline||!M(b,nb))&&l(b.widget.id,"allowedWidgets",a)}function p(a){switch(a){case yb:return na;case zb:case xb:return ia.getWidgets().reverse().concat(na)}}function x(a){return B(p(zb),function(b){var c=pa[b.id];return c.commands&&Pb(c.commands[a])})}function C(b,c,d,e){if(b.id===jb)return!1;var f=(p(b)||a.makeArray(b)).filter(function(a){return!a.destroyed&&Pb(pa[a.id][c])});return f[0]&&Ia(function(){a.each(f,function(a,f){return pa[f.id][c](new s(c,la,f,d,e)),b!==zb})}),!!f[0]}function Q(b,c,d,e){var f=M(e,a.Event)||a.Event(c);return C(b,c,d,Qb({preventDefault:f.preventDefault.bind(f),isDefaultPrevented:function(){return f.isDefaultPrevented()}},e!==f?e:null)),f.isDefaultPrevented()}function R(b,c){function d(a){Da.apply(null,a),Aa&&Z(),Ia(function(){G(v,function(a){C(a,a._event),C(yb,"widget"+J(a._event),null,{targetWidget:a}),a.destroyed="destroy"===a._event,delete a._event}),s.size&&(G(s,function(a){C(a,"contentChange")}),C(yb,"contentChange"))}),za.snapshot()}function e(a,b){c&&a.id!==kb&&(v.has(a)?(v.delete(a),delete a._event):(v.add(a),z(a,"_event",b),Ca(d,0,_b.slice(0))))}function g(a,b){for(var c=a.childNodes,d=c.length;d&&W(b.element,c[d-1].element)<=0;d--);if(c[d]!==b)return b.parentNode?h(b):D(new u(b,-1),function(a){Zb.delete(a.element),a.widget.element===a.element&&e(a.widget,"init")}),c.splice(d,0,b),b.parentNode=a,b.previousSibling=c[d-1]||null,b.nextSibling=c[d+1]||null,(b.previousSibling||{}).nextSibling=b,(b.nextSibling||{}).previousSibling=b,!0}function h(a,b){var c=a.parentNode,d=a.previousSibling,f=a.nextSibling;c.childNodes.splice(c.childNodes.indexOf(a),1),(d||{}).nextSibling=f,(f||{}).previousSibling=d,a.parentNode=null,a.nextSibling=null,a.previousSibling=null,b&&D(new u(a,-1),function(a){Zb.set(a.element,{node:(d||f||c).element,offset:!d&&(!!f||0)}),a.widget.element===a.element&&e(a.widget,"destroy")})}function k(a){var b=a.widget,c=a.parentNode;if(a.widget=(b||"").element!==a.element?c.widget:b,!M(c,lb|qb)){var d,f=B(pa,function(b,c){return M(a.element,b.element)&&(d=c)});!f||a.widget!==c.widget&&a.widget.id===d||(a.widget=new r(p,d,a.element,f.options),e(a.widget,"init"))}b&&b!==a.widget&&e(b,"destroy");var g=pa[a.widget.id];a.widget!==c.widget||M(c,lb|qb)?M(a.element,g.editable)||g.inline&&!g.editable?a.nodeType=g.inline?rb:M(a.element,eb)?nb:mb:a.nodeType=g.inline&&a.widget!==c.widget&&M(c,wb)?qb:lb:a.nodeType=M(a.element,eb)?ob:pb}function l(b,c){a.each(b.childNodes.slice(0),function(a,c){Y(b,c)||h(c,!0)}),a(b.element).children().not("br").each(function(a,d){var e=q.get(d)||new t(p,0,d);q.set(d,e),(g(b,e)||c)&&(k(e),l(e,!0))})}function m(c){var e=ia&&!ka,f=s.size,g=new Vb;a.each(c,function(a,c){var d=q.get(N(c.target)||c.target.parentNode);d&&(c.addedNodes[0]||c.removedNodes[0]?g.add(d):e&&(!c.attributeName||c.target!==b&&"id"!==c.attributeName&&"style"!==c.attributeName)&&s.add(d.widget))}),g.forEach(function(a){Y(b,a.element)&&(l(a),e&&s.add(a.widget))}),g.size&&ia&&Ra(function(){var a,b=ia.getRange();g.forEach(function(c){a|=ba(b,c.element)}),a&&Sa(ia)}),f!==s.size&&(Aa=!0,Ca(d,0,_b.slice(0)))}function n(a){var c=w.takeRecords();if(c[0]&&m(c),(O(a)||P(a))&&(a=a.parentNode||a),Y(b,a)){var d=q.get(a);return M(d,lb)?q.get(d.widget.element):d}}var o={},p=Y(f,b)?la:o,q=new Ub,s=new Vb,v=new Vb,w=new Tb(m);b.parentNode||(b=M(b,j)||qa(b)),c&&w.observe(b,{subtree:!0,childList:!0,attributes:!0,characterData:!0});var x=new t(p,ma,b,new r(p,jb,f,i));return q.set(b,x),l(x),Qb(o,{rootNode:x,getNode:n})}function S(b,c,d){var e=E(ta(b,4)),f="",g=[];c=c||function(a,b){return a+b},a.each(e,function(a,b){f=c(f,b.data),g[a]=f.length}),f=d(f),a.each(e,function(a,b){va(b,f.slice(g[a-1]||0,g[a]))})}function U(a){S(a,function(a,b){return(a+b).replace(/\u00a0{2}(?!\u0020?$)/g,"  ").replace(/[^\S\u00a0]{2}/g,"  ").replace(/\u00a0[^\S\u00a0]\u00a0(\S)/g,"   $1").replace(/(\S)\u00a0(?!$)/g,"$1 ")},function(a){return a.replace(/[^\S\u00a0]$/," ")})}function Z(){la.getNode(),Aa&&(ka=!0,D(new u(la.rootNode,wb|mb|sb),function(b){var c=b.element;if(M(b,mb))return b.firstChild?void a(c).contents().each(function(b,d){if(d.parentNode===c){for(var e=[];d&&(O(d)||P(d)||M(la.getNode(d),vb));d=d.nextSibling)(e.length||N(d)||H(d.data))&&e.push(d);e.length&&a(e).wrap("<p>")}}):void a(c).html("<p>"+(H(c.textContent)||hb)+"</p>");if(M(b,ob|nb)){if(!c.firstChild)return void a(ra()).appendTo(c);var d=a(">br:last-child",c)[0];d&&!d.nextSibling&&(a(ra()).insertBefore(d),wa(d));var e=a(">br:first-child",c)[0];e&&!e.previousSibling&&wa(e),(!ia||ia.startNode!==b&&ia.endNode!==b)&&a.each(E(ta(c,4)),function(a,b){va(b,I(b.data)||gb),O(b.nextSibling)&&(b.nextSibling.data=I(b.data+b.nextSibling.data),wa(b))})}!M(b,pb)||ia&&(ia.startElement===c||ia.endElement===c)||H(c.textContent)||wa(c),a(">br",c).each(function(b,c){O(c.nextSibling)||a(ra()).insertAfter(c)})}),a('br[type="_moz"]',f).remove(),la.getNode(),ka=!1,Aa=!1)}function $(b,d,e){var g="cut"===d?"extractContents":"paste"===d?"deleteContents":"cloneContents",h="paste"!==d,i="copy"!==d,k=c.createDocumentFragment(),l=M(b,q)?b.clone():new q(la,b),m=ia.timestamp;return b=l.getRange(),Ia(function(){if(!l.isCaret){var c=[[f,k]],d=function(){var a=c.shift();a[2]&&a[2].element===a[0]&&C(a[2],"extract",null,{extractedNode:a[1]})};for(D(l.createTreeWalker(-1,function(e){var f=e.element,k=M(e,lb|mb|nb)&&pa[e.widget.id].extract,m=e.widget.element===f;if((!k||e===l.focusNode)&&!m&&M(e,mb))return 3;for(;!Y(c[0][0],f);)d();if(!k||m&&ca(b,f)||(m?a(f):a(f).parentsUntil(c[0][0]).addBack()).each(function(a,b){c.unshift([b,b.cloneNode(!1),e.widget]),c[1][1].appendChild(c[0][1])}),ca(b,f)){var n=f===c[0][0],o=i?f:f.cloneNode(!0);return i&&!n&&M(e,nb)&&(o=a(f.cloneNode(!1)).append(f.childNodes[0])),a(c[0][1]).append(n?o.childNodes:o),2}if(M(e,wb)){var p=aa(f,b)[g](),q=M(p,j)?p.firstChild:p,r=M(q,L(f)),s=!k;return h&&q&&(!r&&s?p=xa(p,[M(e,nb)?sa("p"):f]):r&&!s&&(p=qa(q.childNodes)),k||S(p,null,function(b){return ua(b,a.css(f,"text-transform"))}),a(c[0][1]).append(p)),2}return 1}));c[0];d());}if(Pb(e)){if(ia.timestamp!==m?l=ia:l.direction>0?l.select(b):(l.select(aa(b,!1)),l.extendCaret.moveTo(aa(b,!0))),!l.isSingleEditable){var n=l.createTreeWalker(tb,function(a){return pa[a.widget.id].textFlow?1:3}),o=T(l.baseCaret.node,tb),p=T(l.extendCaret.node,tb);for(n.currentNode=o;F(n,l.direction););n.currentNode!==p&&(n.currentNode!==o?l.extendCaret.moveTo(n.currentNode.element,0*-l.direction):l.collapse())}e(l)}}),a(k).find("[style]").removeAttr("style"),k}function _(b,c){var d;M(c,h)?(Y(f,c)&&wa(c),c=a.makeArray(qa(c).childNodes),d=1===c.length&&M(c[0],"p:not([class])")):(c=a.parseHTML(e(c||"").replace(/\u000d/g,"").replace(/</g,"&lt;").replace(/\n{2,}/g,"</p><p>").replace(/\n/g,"<br>").replace(/.*/,"<p>$&</p>").replace(/\s/g," ")),d=!0),$(b,"paste",function(b){var e,f=b.startNode,g=b.endNode,h=(("__root__ "+(pa[b.focusNode.widget.id].allowedWidgets||"*")).split(" "),b.getCaret("start").clone()),i=aa(T(f,tb).element,0),j=!!M(f,nb),k=!!M(f,wb),l=!0,m=[],n=la.getNode(b.startElement);if(M(n,vb)){for(;n!==f;n=n.parentNode)M(n,pb)&&m.push(n.element);m.push(f.element)}else M(n,ob)?m[0]=f.element:M(n,nb)||(m[0]=sa("p"));if(c.forEach(function(b){var g,n=la.getNode(h.element),p=new t(la,d?ob:pb,b),q=!!P(b),r=!1,s=!1;if(!d&&!q&&N(b)&&(i.insertNode(b),p=la.getNode(b),wa(b),p.widget!==n.widget))for(var u=n;M(u,vb|ob)||M(u,nb)&&u===n;u=u.parentNode){if(1===c.length&&p.widget.id===u.widget.id){var v={receivedNode:b,caret:h.clone()};if(Q(u.widget,"receive",null,v))return h=ia.clone(),void(e=!0)}if(!o(p.widget.id,u)){b=ra(p.widget.id===kb?I(H(b.textContent)):ea(b)),p=new t(la,pb,b);break}}if(!M(n,tb)){if(q){for(r=!M(n,ob);M(n.parentNode,vb);n=n.parentNode);g=aa(n.element,!1)}else M(p,vb)||(n=T(n,ob)||n,g=aa(n.element,!1),M(p,ob)?(s=!d&&!j&&M(n,ob)&&!V(p.element,n.element)&&!!H(b.textContent),r=!l||s&&!!H(aa(aa(n.element,!0),aa(h))),l=!s,k=k&&l):H(aa(aa(n.element,!0),aa(h)))&&((r=H(aa(g,aa(h))))||(n=n.nextSibling||n.parentNode,h.moveTo(g))));if(r){var w=aa(aa(h),g).extractContents();H(w.textContent)||(w=qa(xa(ra(),m)));var x=w.firstChild;g.insertNode(w);for(var y=la.getNode(x);y&&!H(y.element.textContent);y=y.firstChild)if(M(y,qb|rb)){a(y.element.childNodes).insertBefore(y.element),wa(y.element);break}if(M(n,wb)&&!(n.element.firstChild||"").length&&a(ra()).appendTo(n.element),H(n.element.textContent)&&" "===n.element.textContent.slice(-1)&&U(n.element),H(x.textContent)&&" "===x.textContent.charAt(0)&&U(x),q)return aa(x,!0).insertNode(b),void h.moveTo(x,0);n=la.getNode(x),h.moveTo(x,0),e=!0}}k=k&&M(p,wb|vb),q||(M(p,vb)&&!k?b=xa(b,m):!M(p,vb)&&k&&l&&(b=qa(b.childNodes)));var z=qa(b).lastChild;if(k){if(z)if(h.getRange().insertNode(b),U(n.element),q||M(p,qb)){var A=a(ra()).insertAfter(z)[0];h.moveTo(A,-0)}else h.moveTo(z,-0);l=j}else(e||!M(f,lb)||H(b.textContent))&&(M(n,tb)&&!M(n.parentNode,tb)?a(b).appendTo(n.element):a(b).insertBefore(n.element),k=!!M(p,wb|vb),l=s||!k,h.moveTo(z,!l&&-0)),e=!0}),!e&&f!==g)if(ea(f.element)){if(M(f,ob)&&M(g,ob)){var p=qa(aa(g.element,"contents").extractContents()),q=p.firstChild;for(h.moveTo(f.element,-0),aa(f.element,-0).insertNode(p),wa(g.element);N(q)&&V(q,q.previousSibling);){var r=q;q=a(q.childNodes).appendTo(q.previousSibling)[0],wa(r)}U(f.element)}}else h.moveTo(g.element,!M(g,wb)||0),wa(f.element);ia.select(h)})}function ea(b){var c,d,e=aa(b||f,"contents");M(b,h)&&!X(f,b)?(d=R(b),c=new v(new u(d.rootNode,-1),5)):c=new v((M(b,q)||new q(la,e)).createTreeWalker(-1),5,function(a){return ba(e,aa(a,"contents"))?1:2});var g,i,j,k="",l="";return D(c,function(b){var c=(d||la).getNode(b);if(j=pa[c.widget.id].text,c!==g&&(g&&(k+=ua(l,i),l="",M(g,ub)&&M(c,ub)&&"\n\n"!==k.slice(-2)&&(k+="\n\n"),c.widget!==g.widget&&j&&(k+=j(c.widget))),g=c,i=a.css(c.element,"text-transform")),M(c,wb)&&!j)if(O(b)){var f=b.data;b===e.endContainer&&(f=f.slice(0,e.endOffset)),b===e.startContainer&&(f=f.slice(e.startOffset)),l+=f.replace(" "," ")}else P(b)&&(l+="\n")}),k+=j?j(g.widget):ua(l,i),H(k).replace(/\u00a0/g," ")}function fa(a){for(;a;a=a.parentNode)if(ya.has(a))return Xb.set(la,a),!0}function ga(a,b){(i[a]||(i.widgets||"")[a])&&(pa[a]=d.create(b),pa[a].options=Qb(d.create(b.options||null),i[a]),b.element||na.push(new r(la,a,null,pa[a].options)))}function ha(b){var c=b.relatedTarget||ab;Y(b.currentTarget,c)||fa(c)||(Xb.get(la)===b.currentTarget&&Xb.delete(la),f===c?ia.focus():Fa.trigger(a.Event("focusout",{relatedTarget:b.relatedTarget})))}M(f,h)||(i=f,f=f.element),i=Qb(!0,{},(!i||!1!==i.defaultOptions)&&Ha.defaultOptions,i);var ia,ja,ka,la=this,ma=i.inline||M(f,eb)?nb:mb,na=[],pa={},ya=new Ub,za={},Aa=!0,Ba=!1,Fa=a(f),Ia=function(){var a=y(function(){Z(),ja=!1});return function(b,c,d){ja=!0,Da("script",la),a(b,c,d),la.getNode()}}();Ea(f,la),function(){function a(){var a=ia.focusNode.widget;h!==a&&(h&&C(h,"focusout"),h=a,C(h,"focusin")),C(xb,"beforeStateChange"),C(xb,"stateChange")}function b(a){for(var b=[],c=a.node;c.parentNode;c=c.parentNode)b.unshift(c.parentNode.childNodes.indexOf(c));return b[b.length]=a.textNode?a.wholeTextOffset:a.offset,b.join(" ")}function c(a,b){var c=b.split(" "),d=f,e=c.splice(-1)[0];c.forEach(function(a){d=d.children[+a]}),isNaN(e)?a.moveTo(d,"true"===e):a.moveToText(d,+e)}function d(){var c=za.getValue();j[0]&&c===j[k].value||(j.splice(0,k,{value:c}),j.splice(Ha.historyLevel),k=0),j[k].basePos=b(ia.baseCaret),j[k].extendPos=b(ia.extendCaret),j[k].html=f.innerHTML,a(),n(i)}function e(b){Fa.html(b.html),c(ia,b.basePos),c(ia.extendCaret,b.extendPos),a(),n(i)}var h,i,j=[],k=0,l=0;Qb(za,{getValue:function(){return H(f.innerHTML.replace(/\s+style(?:="[^"]*")?|\u200b+(?!<\/)|(^|[^>])\u200b+/g,"$1"))},canUndo:function(){return k<j.length-1},canRedo:function(){return k>0},undo:function(){za.canUndo()&&e(j[++k])},redo:function(){za.canRedo()&&e(j[--k])},snapshot:function(a){var b=+new Date;n(i),!0===a?d():(l=g.max(l,b+(a||0)),i=m(d,l-b))}})}(),function(){na[0]=new r(la,jb),a.each(i.widgets||{},ga),a.each(Ha.widgets,ga),na[na.length]=new r(la,ib),pa[jb]=i,pa[ib]={},pa[kb]={element:i.disallowedElement||":not("+eb+",br,b,em,i,u,strike,small,strong,sub,sup,ins,del,mark,span)"},i.textFlow=!0;var b=d.keys(pa).slice(0,-1).filter(function(a){return pa[a].element});b.forEach(function(a){pa[a].allowedWidgets=b.filter(function(b){return b!==jb&&l(b,"allowedIn",a)&&l(a,"allow",b)}).join(" ")})}(),function(){function d(a,b){var c=(a.ctrlKey||a.metaKey?"Ctrl":"")+(a.altKey?"Alt":"")+(a.shiftKey?"Shift":"");return c?K(c+J(b)):b}function g(){var a=oa(f);Xb.has(la)||!a||da(a,aa(ia))||(za.snapshot(200),ia.select(a))}function h(a){if(ia.isCaret){var b=ia.clone();b.extendCaret.moveByCharacter("backspace"===a.data?-1:1)&&_(b,"")}else _(ia,"")}function i(a,b,c){var e=la.getNode(a.target),f={clientX:(b||a).clientX,clientY:(b||a).clientY,target:a.target};M(e,lb|qb)?ia.select(e.widget.element):ia.moveToPoint(f.clientX,f.clientY),ia.focus(),za.snapshot(),C(M(e,lb|qb)?e.widget:yb,d(a,c||a.type),null,f)}function j(a){Da("input",la),a&&(Q(ia.focusNode.widget,"textInput",a)||Q(yb,"textInput",a))||(ia.startTextNode&&ia.isCaret?a&&Ia(function(){var b=ia.startTextNode;b.data=b.data.substr(0,ia.startOffset)+a+b.data.slice(ia.startOffset),U(ia.startNode.element),ia.moveToText(b,ia.startOffset+a.length),za.snapshot(200)}):_(ia,a))}function k(b){if(a.inArray("application/x-typer",b.types)>=0){var c=b.getData("text/html"),d=qa(a(c).filter("#Typer").contents());_(ia,d)}else{var e=b.getData(Cb?"Text":"text/plain");e===Wb.textContent?_(ia,Wb.content.cloneNode(!0)):j(e)}}var l,n,o,p;Fa.on("mousedown",function(a){if(1===a.which){var b;Ga(a,function(a,c){b=!0,za.snapshot(200),ia.extendCaret.moveToPoint(a,c)}).done(function(){b||i(a,null,"click")}),(a.shiftKey?ia.extendCaret:ia).moveToPoint(a.clientX,a.clientY)}ia.focus()}),Fa.on("compositionstart compositionend",function(a){var b=l,c=oa(f),d=c.startContainer,e=c.startOffset;if(N(d)&&(d=d.childNodes[e]||d.lastChild,e=d.length),l="t"===a.type.slice(-1)&&{},ka=!!l,l)l.node=d,l.offset=e;else{var g=a.originalEvent.data||b.node.data.slice(b.offset-e);aa(d,e-g.length,d,e).deleteContents(),ia.select(d,e-g.length),j(g)}}),Fa.on("keydown keyup",function(b){if(!l){var c=a.inArray(b.keyCode,[16,17,18,91,93])>=0;if("keydown"===b.type){var e=!c&&(db[b.keyCode]||"").length>1;if(n=b.ctrlKey+b.shiftKey+b.altKey+b.metaKey+!c,n*=e||(n>2||n>1&&!b.shiftKey)&&!c,o=b.keyCode,n){var f=d(b,db[o]||b.key);C(zb,f)&&b.preventDefault(),(Q(xb,"keystroke",f,b)||/ctrl(?![acfnprstvwx]|f5|shift[nt]$)|enter/i.test(f))&&b.preventDefault()}}else(b.keyCode===o||c)&&n--}}),Fa.on("keypress beforeinput",function(a){l||n||"beforeinput"!==a.type&&!a.originalEvent.synthetic&&"onbeforeinput"in f||(j(a.originalEvent.data||a.char||a.key||e.fromCharCode(a.charCode)),a.preventDefault())}),Fa.on("cut copy",function(c){var d=c.originalEvent.clipboardData||b.clipboardData;Da(c.type,la),Wb.content=$(ia,c.type),Wb.textContent=ea(Wb.content),Cb?d.setData("Text",Wb.textContent):(d.setData("text/plain",Wb.textContent),d.setData("text/html",a('<div id="Typer">').append(Wb.content.cloneNode(!0))[0].outerHTML),d.setData("application/x-typer","true")),c.preventDefault()}),Fa.on("paste",function(a){if(Da("paste",la),k(a.originalEvent.clipboardData||b.clipboardData),a.preventDefault(),Cb){var c=ia.clone();m(function(){ia.select(c)})}}),Fa.on("drop",function(a){Da("drop",la),ia.moveToPoint(a.clientX,a.clientY)&&k(a.originalEvent.dataTransfer),ia.focus(),a.preventDefault()}),Fa.on("touchstart touchmove touchend",function(a){"touchend"===a.type&&p&&i(a,p,"click");var b=a.originalEvent.touches||a;p="touchstart"===a.type&&!b[1]&&b[0]}),Fa.on("contextmenu",function(a){var b=new w(la);b.moveToPoint(a.clientX,a.clientY),!ia.isCaret&&ba(ia,b)||ia.select(b)}),Fa.on("dblclick",function(a){i(a),a.preventDefault()}),Fa.on("mousewheel",function(a){Ba&&Q(zb,"mousewheel",Ha.ui.getWheelDelta(a))&&a.preventDefault()}),Fa.on("focusin",function(a){Xb.delete(la),Ba||ja&&!_a||(_a=!1,$a=!1,bb=g,Ba||(Ba=!0,ia.focus(),C(xb,"focusin")))}),Fa.on("focusout",function(a){if(c.activeElement!==f&&Ba){if(void 0===a.relatedTarget)return;fa(a.relatedTarget||ab)||(Ba=!1,bb=null,C(xb,"focusout"),Y(f,c.activeElement)&&(a.relatedTarget?a.relatedTarget.focus():f.blur()))}});var q={ctrlZ:za.undo,ctrlY:za.redo,ctrlShiftZ:za.redo,backspace:h,delete:h,escape:function(){f.blur(),oa(f)&&Rb.removeAllRanges()}};a.each({moveByLine:"upArrow downArrow shiftUpArrow shiftDownArrow",moveByWord:"ctrlLeftArrow ctrlRightArrow ctrlShiftLeftArrow ctrlShiftRightArrow",moveToLineEnd:"home end shiftHome shiftEnd",moveByCharacter:"leftArrow rightArrow shiftLeftArrow shiftRightArrow"},function(b,c){a.each(c.split(" "),function(a,c){var d=1&a?1:-1,e=!!(2&a);q[c]=function(){e||ia.isCaret?(e?ia.extendCaret:ia)[b](d):ia.collapse(d<0?"start":"end")}})}),Qb(pa[ib],{dblclick:function(a){ia.select("word")},keystroke:function(a){!a.isDefaultPrevented()&&a.data in q&&(a.preventDefault(),q[a.data](a))}})}(),Fa.attr("contenteditable","true"),Ab&&Fa.css("-webkit-user-modify","read-write-plaintext-only"),Qb(la,za,R(f,!0),{element:f,hasCommand:function(a){return!!x(a)},focused:function(a){return Ba&&(!a||Y(f,c.activeElement))},widgetEnabled:function(a){return pa.hasOwnProperty(a)},widgetAllowed:function(a,b){return b=M(b,t)||la.getNode(b||f),!!o(a,b)},getWidgetOption:function(a,b){return pa[a]&&pa[a][b]},getStaticWidget:function(a){return B(na.slice(1,-1),function(b){return b.id===a})},getStaticWidgets:function(){return na.slice(1,-1)},getSelection:function(){return ia},extractText:function(a){return ea(a)},retainFocus:function(b){ya.has(b)||(ya.set(b,!0),a(b).on("focusout",ha))},releaseFocus:function(b){ya.delete(b),a(b).off("focusout",ha)},invoke:function(a,b){var c=new k;"string"==typeof a&&(c.commandName=a,c.widget=x(a),a=c.widget&&pa[c.widget.id].commands[a]),Pb(a)&&Ia(function(){a.call(la,c,b),za.snapshot(),Ba&&!Xb.has(la)&&ia.focus()})}}),A(k,{typer:la,get selection(){return ia},insertText:function(a){_(ia,a)},insertHtml:function(a){_(ia,M(a,h)||qa(a))},insertWidget:function(a,b){var c=(pa[a]||"").create;Pb(c)&&c.call(la,this,b)},removeWidget:function(a){var b=pa[a.id].remove;if(Pb(b))b.call(la,new k(a));else if("keepText"===b){var c=ea(a.element);_(aa(a.element,!0),c),wa(a.element)}else _(aa(a.element),"")}}),Z(),ia=new q(la,aa(f,0)),C(yb,"init")}function Ia(a,b){return b&&(a.whatToShow&sb||b.element.offsetWidth>0||b.element.offsetHeight>0)&&b}function Ja(a,b,c){return c&&b!==a.root&&!Ia(a,b)?2:M(b,lb)&&M(b.parentNode,lb)?3:C(a,b)}function Ka(a,b,c){if(Ja.returnValue=Ja(a,b,c),1===Ja.returnValue)return a.currentNode=b,!0}function La(a,b,c){for(var d=a.currentNode[b];d;){if(Ka(a,d,!0))return d;if(3===Ja.returnValue&&d[b])d=d[b];else{for(;!d[c];)if(!(d=Ia(a,d.parentNode))||d===a.root||d===a.currentNode)return null;d=d[c]}}}function Ma(a,b,c){for(var d=a.currentNode;d&&d!==a.root;){for(var e=d[c];e;){if(Ka(a,e))return e;e=2!==Ja.returnValue&&e[b]?e[b]:e[c]}if(!(d=Ia(a,d.parentNode))||d===a.root||1===Ja(a,d,!0))return null}}function Na(a,b){var d=b.currentNode.typer,e=c.createTreeWalker(b.root.element,1|a.whatToShow,function(c){var e=d.getNode(c);return Ka(b,e,!0)?!O(c)&&!P(c)||M(e,wb)?1|C(a,c):2:Ja.returnValue},!1);z(a,"iterator",e)}function Oa(a,b,c){var d=aa(a),e=Yb.get(a).d,f=function(a){return ba(a.element,d)?1:2};return new u(a.focusNode,b&~sb,Fa(f,e&&e.acceptNode&&e.acceptNode.bind(e),c))}function Pa(a){var b=new v(Oa(a,wb),4);return b.currentNode=a.startTextNode||a.startElement,a.startOffset===(a.startTextNode||"").length&&b.nextNode(),E(b,null,null,function(b){return W(b,a.endTextNode||a.endElement)<=(0!==a.endOffset?0:-1)})}function Qa(a){var b=a.getCaret("start"),c=a.getCaret("end");c.textNode&&!Q(c.textNode,c.offset,1)&&c.textNode.splitText(c.offset),b.textNode&&!Q(b.textNode,b.offset,-1)&&Wa(b,b.node,b.element,b.textNode.splitText(b.offset),0)}function Ra(a,b,c){return Ra.executing=!0,Ra.run(a,b,c)}function Sa(a){if(Ra.executing)return void $b.add(a);var b=Yb.get(a);b.d=null,b.m=0,a.timestamp=performance.now(),a.direction=ea(a.extendCaret.getRange(),a.baseCaret.getRange())||0,a.isCaret=!a.direction;for(var c=0,d=a.getCaret("start"),e=a.getCaret("end");c<4;c++)a[Sa.NAMES[c+4]]=d[Sa.NAMES[c]],a[Sa.NAMES[c+8]]=e[Sa.NAMES[c]];var f=a.typer.getNode(Z(a.baseCaret.element,a.extendCaret.element));a.focusNode=T(f,lb|qb|tb|rb),a===a.typer.getSelection()&&(a.typer.focused()&&!Xb.has(a.typer)&&a.focus(),a.typer.snapshot())}function Ta(a,b,c){var d=new v(new u(b||a.typer.rootNode,wb|lb),4|c);return d.currentNode=a.textNode||a.element,d}function Ua(a,b){return a.selection?Ra(b,null,a):b.call(a)}function Va(a){var b=a.typer.element,c=a.textNode||a.element;if(!Y(b,c)||a.offset>c.length)if(a.node)if(Y(b,a.textNode)&&a.offset<=c.length)a.moveTo(c,a.offset);else if(Y(b,a.node.element))a.moveToText(a.node.element,a.wholeTextOffset);else{var d={node:a.element};for(a.typer.getNode(c);!Y(b,d.node)&&Zb.has(d.node);d=Zb.get(d.node));a.moveTo(d.node,d.offset)}else a.moveTo(b,0);return a}function Wa(a,b,c,d,e,f){var g=a.textNode||a.element,h=a.offset;a.node=b,a.element=c,a.textNode=d||null,a.offset=e,a.wholeTextOffset=(d?a.offset:0)+_(b,d||c),a.beforeSoftBreak=!!f;var i=g!==(d||c)||h!==e;return i&&a.selection&&Sa(a.selection),i}function Xa(b,c,d,e){var f,g;P(c)||(c.firstChild&&(g=d===c.childNodes.length,c=c.childNodes[d]||c.lastChild,d=g?c.length:0),f=O(c));var h=b.typer.getNode(c);if(M(h,lb|qb)&&(c=h.element,f=null),!M(h,wb|lb|qb)){var i=B(h.childNodes,function(a){return W(f,a.element)<0});h=i||h.lastChild||h,f=null,g=!i}if(b.selection&&b===b.selection.extendCaret&&M(h.previousSibling,lb)===b.selection.baseCaret.node&&(h=h.previousSibling,f=null,g=!0),!f&&M(h,wb)){for(var j=new v(new u(h,wb),4);j.nextNode()&&g;);f=O(j.currentNode)||a(ra())[g?"appendTo":"prependTo"](h.element)[0],d=f&&g?f.length:0}if(f&&!e){for(var k=function(c,e,g,h){var i=Q(f,d,c)&&N(f[e]);if(i&&!P(i)&&M(b.typer.getNode(i),wb))return f=O(i[g])||a(ra())[h](i)[0],
d=$(f,0*c),!0};k(-1,"previousSibling","lastChild","appendTo")||k(1,"nextSibling","firstChild","prependTo"););f.length||(f.data=gb,d=1)}return Wa(b,T(h,ub),f?f.parentNode:h.element,f,f?d:!g,e)}function Ya(b,d,e,f){var g=S(b),h=d===b.length||!!e&&d>0,i=!!(2&g),j=b.data.charAt(d-h);if(R(j)!==i&&"override"!==a.css(b.parentNode,"unicode-bidi").slice(-8)){for(var l=b.parentNode;"inline"===a.css(l,"display")&&"isolate"!==a.css(l,"unicode-bidi").slice(0,7);l=l.parentNode);if((i?Ib:Hb).test(l.textContent)){var m=function(b,d,e){var f=c.createTreeWalker(l,5,function(b){if(N(b)&&!P(b)){if("inline"!==a.css(b,"display")||M(b,"audio,canvas,embed,iframe,img,input,object,video"))return 2;switch(a.css(b,"unicode-bidi")){case"normal":case"plaintext":return 3;case"isolate":case"isolate-override":return 2}}return 1},!1);for(f.currentNode=b;O(b);){for(;d!==$(b,0*-e);)if(d+=e,/(\S)/.test(b.data.charAt(d)))return R(k.$1,i);b=F(f,e),d=e>0?-1:(b||"").length}return!b||P(b)?i:"rtl"===a.css(b,"direction")},n=m(b,d-h,-1),o=m(b,d-h,1),p=n===o&&/\s/.test(j)?n:R(j,i);h||p===i||n!==i||(h=!0,p=n),g=-3&g|(p?2:0)}}var q=la(aa(b,d-h,b,d+!h))[0]||ga(0,0);return f&&h&&/\s/.test(b.data.charAt(d-h))&&!ma(q,g).width&&(q[na(3,g)]+=Ba(b).wsWidth),q.collapse(na(2|h,g))}function Za(b,c,d,e,f){function h(b){var c=q.indexOf(b);if(c>=0)return r[c];for(var d=Sb(b),e=b;"inline"===a.css(e,"display");e=e.parentNode);var f=r[q.push(b)-1]=Ba(b);return f.lineHeight="px"===d.lineHeight.slice(-2)?l(d.lineHeight):("normal"===d.lineHeight?1.15:d.lineHeight)*f.fontSize,f.verticalAlign=d.verticalAlign,f.baselineOffset=f.baseline-f.height+i(b,e),f}function i(a,b){if(a===b)return 0;if(a.parentNode!==b)return i(a,a.parentNode)+i(a.parentNode,b);var c=h(a);switch(c.verticalAlign){case"baseline":return 0;case"middle":var d=h(a.parentNode);return-c.height/2+(d.baseline-d.middle);case"top":case"bottom":return NaN;case"text-top":return(c.lineHeight-c.height)/2;case"text-bottom":return(c.lineHeight+c.height)/2-h(a.parentNode).height;case"sub":return-.21*c.fontSize;case"super":return.34*c.fontSize}return isNaN(c.verticalAlign)?l(c.verticalAlign)/100*c.lineHeight:+c.verticalAlign||0}function j(a){var b,f;e?(f=e>0?a.right:a.left,b=(f-d.left)*e):(b=g.min(0,a.right-d.left)||g.max(0,a.left-d.left),f=d.left+b),(e?b>s:g.abs(b)<g.abs(s))&&(s=b,c=a.node,n=ma(ga(f,a.centerY),-p))}function m(a,b,c,e,f){var i,k=new v(new u(a,wb),4),l=c>0?"bottom":"top",m=d,n=[];if(O(b))k.currentNode=b;else{for(;k.nextNode()&&c<0;);if(b=k.currentNode,!O(b))return m[l]}do{var o=h(b.parentNode),q=la(b);c<0&&q.reverse();for(var r=0,s=q.length;r<s;r++){var t=ma(q[r],p),w=o.lineHeight-t.height>>1,x=ga(t.left,t.top-w,t.right,t.bottom+w),y=t.bottom+o.baselineOffset,z=!1;if(x.node=b,!(void 0===i&&x[l]*c<m[Db[l]]*c)){if(isNaN(i)||g.abs(y-i)<1||x.top<m.bottom&&x.bottom>m.top)z=!0;else if(isNaN(y))if(o.verticalAlign===Db[l])z=x[Db[l]]*c<=m[l]*c;else{if(!n[0]||x[l]===n[0][l]){n.push(x);continue}var A=n.splice(0,n.length,x);A[0][l]===m[l]&&A.forEach(j)}if(void 0!==i&&isNaN(y)||(i=y),!z&&!--e||i*c>f*c)return m[l];m=ka(m,x),1===e&&(n.splice(0).forEach(j),j(x))}}}while(b=F(k,c));return m[l]}var n,o=T(b.typer.getNode(c),ub),p=S(c),q=[],r=[],s=-1/0;if(d=ma(ga(d.centerX,d.centerY),p),b.softPoint&&(d.left=d.right=ma(b.softPoint,p).left),f){var t=m(o,c,f,2);if(!n){var w=new u(b.typer.rootNode,ub);w.currentNode=o;for(var x;o=F(w,f);){var y=ma(fa(o.element),p),z=f>0?"bottom":"top";if(!(y[Db[z]]*f<t*f)){if(y[Db[z]]*f>=x*f)break;m(o,null,f,1,x),x=y[z]}}if(!n&&void 0!==x)return Xa(b,w.currentNode.element,0)}}else m(o,c,(e||1)*(2&p?-1:1),1);if(n){var A=e>0||s<0,C=function(b,c,d,e){function f(a){var f=ma(Ya(b,a,e),d);return(f.centerY-c.centerY|0)*(1/0)||f.left-c.left|0}var h=0,i=b.length;if("override"!==a.css(b.parentNode,"unicode-bidi").slice(-8)&&(2&d?Ib:Hb).test(b.data)){var j,l=2&d?[Ib,Jb]:[Hb,Kb],m=0;for(i=-1;!j&&l[1&++m].test(b.data.slice(i+1));)h=g.max(0,i),i=b.data.indexOf(k.$1,i+1),j=B(la(aa(b,h,b,i)),function(a){return a.top<=c.top&&a.bottom>=c.top&&a.left<=c.left&&a.right>=c.left});d^=1&m?2:0,j||(i=b.length)}for(c=ma(c,d);i-h>1;){var n=i+h>>1,o=f(n)<=0;h=o?n:h,i=o?i:n}return g.abs(f(h))<g.abs(f(i))?h:i}(c,n,p,A);return b.softPoint=f?ma(ga(d.left,ma(n,p).centerY),-p):null,Xa(b,c,C,A)}return!1}var $a,_a,ab,bb,cb,db=JSON.parse('{"8":"backspace","9":"tab","13":"enter","16":"shift","17":"ctrl","18":"alt","19":"pause","20":"capsLock","27":"escape","32":"space","33":"pageUp","34":"pageDown","35":"end","36":"home","37":"leftArrow","38":"upArrow","39":"rightArrow","40":"downArrow","45":"insert","46":"delete","48":"0","49":"1","50":"2","51":"3","52":"4","53":"5","54":"6","55":"7","56":"8","57":"9","65":"a","66":"b","67":"c","68":"d","69":"e","70":"f","71":"g","72":"h","73":"i","74":"j","75":"k","76":"l","77":"m","78":"n","79":"o","80":"p","81":"q","82":"r","83":"s","84":"t","85":"u","86":"v","87":"w","88":"x","89":"y","90":"z","91":"leftWindow","92":"rightWindowKey","93":"select","96":"numpad0","97":"numpad1","98":"numpad2","99":"numpad3","100":"numpad4","101":"numpad5","102":"numpad6","103":"numpad7","104":"numpad8","105":"numpad9","106":"multiply","107":"add","109":"subtract","110":"decimalPoint","111":"divide","112":"f1","113":"f2","114":"f3","115":"f4","116":"f5","117":"f6","118":"f7","119":"f8","120":"f9","121":"f10","122":"f11","123":"f12","144":"numLock","145":"scrollLock","186":"semiColon","187":"equalSign","188":"comma","189":"dash","190":"period","191":"forwardSlash","192":"backtick","219":"openBracket","220":"backSlash","221":"closeBracket","222":"singleQuote"}'),eb="h1,h2,h3,h4,h5,h6,p,q,blockquote,pre,code,li,caption,figcaption,summary,dt,th",fb="script mouse touch keyboard input drop cut copy paste".split(" "),gb="​",hb="&#8203;",ib="__core__",jb="__root__",kb="__unknown__",lb=1,mb=2,nb=32,ob=4,pb=16,qb=64,rb=128,sb=8192,tb=mb|nb,ub=lb|ob|tb,vb=pb|qb|rb,wb=ob|nb|pb|rb,xb=1,yb=2,zb=3,Ab=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!b.MSStream,Bb=!!b.ActiveXObject,Cb=Bb||void 0!==f.style.msTouchAction||void 0!==f.style.msUserSelect,Db={top:"bottom",left:"right",right:"left",bottom:"top"},Eb={"horizontal-tb":0,"vertical-rl":5,"vertical-lr":1,"sideways-rl":5,"sideways-lr":11,lr:0,rl:0,tb:5,"lr-tb":0,"lr-bt":4,"rl-tb":0,"rl-bt":4,"tb-rl":5,"bt-rl":5,"tb-lr":1,"bt-lr":1},Fb=[240,3276,1450,3840],Gb="block-start block-end inline-start inline-end over under line-left line-right".split(" "),Hb=new k("([֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),Ib=new k("([^\\s֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),Jb=new k("(\\s|[֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),Kb=new k("(\\s|[^֐-߿‏‫‮יִ-﷽ﹰ-ﻼ])"),Lb=/[\u200b\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f\udc00-\udcff\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u08d4-\u08e1\u08e3-\u08ff\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u3099\u309a]/,Mb=c.msElementsFromPoint||c.elementsFromPoint,Nb=c.compareDocumentPosition,Ob=i.prototype.compareBoundaryPoints,Pb=a.isFunction,Qb=a.extend,Rb=b.getSelection(),Sb=b.getComputedStyle,Tb=o.MutationObserver,Ub=o.WeakMap,Vb=o.Set,Wb={},Xb=new Ub,Yb=new Ub,Zb=new Ub,$b=new Vb,_b=[];if(b.Typer=Ha,Qb(Ha,{NODE_WIDGET:lb,NODE_PARAGRAPH:ob,NODE_EDITABLE:mb,NODE_EDITABLE_PARAGRAPH:nb,NODE_INLINE:pb,NODE_INLINE_WIDGET:qb,NODE_INLINE_EDITABLE:rb,NODE_ANY_ALLOWTEXT:wb,NODE_ANY_BLOCK_EDITABLE:tb,NODE_ANY_INLINE:vb,ZWSP:gb,ZWSP_ENTITIY:hb,msie:Cb,msie10:Bb,is:M,trim:H,iterate:D,iterateToArray:E,setTimeoutOnce:Ca,closest:T,getCommonAncestor:Z,sameElementSpec:V,comparePosition:W,compareRangePosition:ea,containsOrEquals:Y,createElement:sa,createTextNode:ra,createRange:aa,rangeIntersects:ba,rangeCovers:ca,rangeEquals:da,rectEquals:ha,rectCovers:ia,pointInRect:ja,toPlainRect:ga,mergeRect:ka,getRect:fa,getRects:la,getAbstractSide:na,elementFromPoint:pa,draggable:Ga,historyLevel:100,defaultOptions:{widgets:{}},widgets:{}}),A(Ha,{createCaret:function(a,b){var c=new w(this);return a&&c.moveTo(a,b),c},createSelection:function(a,b,c,d){return new q(this,aa(a,b,c,d))},createTreeWalker:function(a,b,c){return new u(a||this.rootNode,b,c)},nodeFromPoint:function(a,b,c){var d=pa(a,b,this.element);if(d){var e=this.getNode(d);if(M(e,mb)){var f=S(d),g=ma(ga(a,b),f);e=B(e.childNodes,function(a){var b=ma(fa(a.element,!0),f);return b.top<=g.top&&b.bottom>=g.top})||e}return T(e,c||-1)}},hasContent:function(){return!!this.getValue()},setValue:function(a){this.selectAll(),this.invoke(function(b){b.insertHtml(a)})},select:function(a,b,c,d){this.getSelection().select(a,b,c,d)},selectAll:function(){this.getSelection().selectAll()}}),A(t,{get firstChild(){return this.childNodes[0]||null},get lastChild(){var a=this.childNodes;return a[a.length-1]||null}}),A(u,{previousSibling:function(){return Ma(this,"lastChild","previousSibling")},nextSibling:function(){return Ma(this,"firstChild","nextSibling")},firstChild:function(){return La(this,"firstChild","nextSibling")},lastChild:function(){return La(this,"lastChild","previousSibling")},parentNode:function(){for(var a=this.currentNode;a&&a!==this.root;a=a.parentNode)if(Ka(this,a.parentNode,!0))return a.parentNode},previousNode:function(){for(var a=this,b=a.currentNode;b&&b!==a.root;){for(var c=b.previousSibling;c;c=b.previousSibling){b=c;for(var d=Ja(a,c);2!==d&&Ia(a,b.firstChild);)b=b.lastChild,d=Ja(a,b,!0);if(1===d)return a.currentNode=b,b}if(!(b=Ia(a,b.parentNode))||b===a.root)return null;if(Ka(a,b,!0))return b}},nextNode:function(){for(var a=this,b=1,c=a.currentNode;c;){for(;2!==b&&c.firstChild;){if(c=c.firstChild,Ka(a,c,!0))return c;b=Ja.returnValue}for(;c&&c!==a.root&&!c.nextSibling;)c=Ia(a,c.parentNode);if(!c||c===a.root)return null;if(c=c.nextSibling,Ka(a,c,!0))return c;b=Ja.returnValue}}}),A(v,{get currentNode(){return this.iterator.currentNode},set currentNode(a){this.iterator.currentNode=a},previousNode:function(){return this.iterator.previousNode()},nextNode:function(){return this.iterator.nextNode()}}),Ra.run=y(function(){Ra.executing=!1,$b.forEach(Sa),$b.clear()}),Sa.NAMES="node element textNode offset startNode startElement startTextNode startOffset endNode endElement endTextNode endOffset".split(" "),A(q,{get isSingleEditable(){return this.isCaret||!Oa(this,tb).nextNode()},getCaret:function(a){var b=this.baseCaret,c=this.extendCaret;switch(a){case"extend":return c;case"start":return this.direction<0?c:b;case"end":return this.direction<0?b:c;default:return b}},getRange:function(a){var b=this.baseCaret,c=this.extendCaret;return void 0!==a||this.isCaret?(!1!==a?b:c).getRange():aa(b.getRange(),c.getRange())},getWidgets:function(){for(var a=[],b=this.focusNode;b.widget.id!==jb;b=b.parentNode)a.unshift(b.widget),b=this.typer.getNode(b.widget.element);return a},getParagraphElements:function(){var a=this;return a.startNode===a.endNode?M(a.startNode,ob)?[a.startNode.element]:[]:E(Oa(a,ob),function(a){return a.element})},getSelectedElements:function(){var b=this;return b.isCaret?[b.startElement]:a(Pa(b)).parent().get()},getSelectedText:function(){return this.typer.extractText(this)},getSelectedTextNodes:function(){var a=this;return a.isCaret?[]:(Qa(a),Pa(a))},createTreeWalker:function(a,b){return Oa(this,a,b)},collapse:function(a){return a=this.getCaret(a),(a===this.baseCaret?this.extendCaret:this.baseCaret).moveTo(a)},select:function(a,b,c,d){var e,f=this;return Ra(function(){if("word"===a)e=f.getCaret("start").moveByWord(-1)+f.getCaret("end").moveByWord(1)>0;else{var g=aa(a,b,c,d);e=f.baseCaret.moveTo(g,!0)+f.extendCaret.moveTo(g,!1)>0}}),a.acceptNode&&(Yb.get(f).d=a),e},selectAll:function(){return this.select(this.typer.element,"contents")},focus:function(){var a=this.typer.element;Y(c,a)&&(_a=!0,ya(aa(this)),Cb||c.activeElement===a||a.focus(),Aa(a,this.extendCaret.getRect()))},clone:function(){var a=this,b=new q(a.typer);return Ra(function(){b.baseCaret.moveTo(a.baseCaret),b.extendCaret.moveTo(a.extendCaret)}),Yb.get(b).d=Yb.get(a).d,b},widgetAllowed:function(a){return this.typer.widgetAllowed(a,this.focusNode)}}),a.each("moveTo moveToPoint moveToText moveByLine moveToLineEnd moveByWord moveByCharacter".split(" "),function(a,b){q.prototype[b]=function(){var a=this;return Ra(function(){return w.prototype[b].apply(a.baseCaret,arguments)+a.collapse("base")>0},arguments)}}),a.each("getWidgets getParagraphElements getSelectedElements getSelectedText getSelectedTextNodes".split(" "),function(a,b){var c=q.prototype[b];q.prototype[b]=function(){var d=Yb.get(this);return d.m&1<<a||(d[b]=d.d&&d.d[b]?d.d[b](this):c.apply(this),d.m|=1<<a),d[b]}}),A(w,{getRect:function(){var a=Va(this);if(!a.textNode){return fa(a.element).collapse(na(2|!a.offset,S(a.element)))}return Ya(a.textNode,a.offset,a.beforeSoftBreak,!0)},getRange:function(){var a=Va(this),b=a.textNode||a.element,c=a.offset;return b===a.typer.element?aa(b,c?0:-0):c%b.length==0?aa(b,!c):aa(b,c)},clone:function(){var a=Va(this);return Qb(new w(a.typer),a)},moveTo:function(a,b){if(M(a,w))return Wa(this,a.node,a.element,a.textNode,a.offset,a.beforeSoftBreak);var c=aa(a,b);return!(!c||!Y(this.typer.element,c.startContainer))&&Xa(this,c.startContainer,c.startOffset)},moveToPoint:function(a,b){var c=this,d=c.typer.nodeFromPoint(a,b);return!!d&&Za(c,d.element,ga(a,b))},moveToText:function(a,b){if(3!==a.nodeType){var c=new v(new u(this.typer.getNode(a),wb),4);if(1/b>0)for(;b>=0&&c.nextNode();b-=c.currentNode.length);else for(;c.nextNode(););a=c.currentNode,b=a&&g.min(b+a.length,a.length)}return!!a&&Xa(this,a,$(a,b))},moveToLineEnd:function(a){var b=Va(this);return Za(b,b.textNode||b.element,b.getRect(),a,0)},moveByLine:function(a){var b=this;return Za(b,b.textNode||b.element,b.getRect(),0,a)||b.moveToLineEnd(a)},moveByWord:function(a){var b,c=this,d=c.textNode,e=a<0?/\b(\S*\s+|\S+)$/:/^(\s+\S*|\S+)\b/,f="";if(d&&(f=a<0?d.data.substr(0,c.offset):d.data.slice(c.offset),(b=e.test(f))&&k.$1.length!==f.length))return c.moveToText(d,c.offset+a*k.$1.length);for(var g=Ta(c,c.node),h=g.currentNode,i=b&&k.$1.length;d=F(g,a);){if(f=a<0?d.data+f:f+d.data,(b=e.test(f))&&k.$1.length!==f.length)return k.$1.length===i?c.moveToText(h,0*-a):c.moveToText(d,a*(k.$1.length-(f.length-d.length)));h=d,i=k.$1.length}return!(!b||!d&&!i)&&c.moveToText(d||h,0*-a)},moveByCharacter:function(a){for(var b=this,c=S(b.element),d=ma(b,c),e=Ta(b,null,5),f=O(e.currentNode),g=b.offset,h=!1;;){if(!f||g===$(f,0*-a)){for(;!(f=F(e,a))||!f.length;){if(!f)return!1;if(M(b.typer.getNode(f),lb)&&!Y(f,b.element))return b.moveToText(f,0*a)||b.moveTo(f,a<0);h|=!!P(f)}g=(a<0?f.length:0)+((h||!Y(b.node.element,f))&&-a)}if(g+=a,!Lb.test(f.data.charAt(g))){var i=ma(Ya(f,g),c);if(!ha(d,i))return Xa(b,f,g,a>0&&d.centerY!==i.centerY)}}}}),a.each("moveByLine moveByWord moveByCharacter".split(" "),function(a,b){var c=w.prototype[b];w.prototype[b]=function(a){var b=Va(this);return Ua(b,function(){for(var d=a;d&&c.call(b,a/g.abs(a));d+=d>0?-1:1);return!a||d!==a})}}),A(x,{get width(){return this.right-this.left},get height(){return this.bottom-this.top},get centerX(){return(this.left+this.right)/2},get centerY(){return(this.top+this.bottom)/2},collapse:function(a){var b=this;return"left"===a||"right"===a?ga(b[a],b.top,b[a],b.bottom):ga(b.left,b[a],b.right,b[a])},translate:function(a,b){var c=this;return ga(c.left+a,c.top+b,c.right+a,c.bottom+b)}}),A(r,{remove:function(){var a=this;a.typer.invoke(function(b){b.removeWidget(a)})}}),!Cb){try{c.designMode="on",c.execCommand("enableObjectResizing",!1,!1),c.execCommand("enableInlineTableEditing",!1,!1)}catch(a){}c.designMode="off"}setInterval(function(){!$a&&bb&&bb()},100),a(b).on("focusin focusout",function(a){(Cb?a.relatedTarget:a.target!==b)||($a="focusout"===a.type)}),a(function(){Ea(c.body);var b=a('<div style="overflow:scroll;height:80px"><div style="height:100px"></div></div>').appendTo(c.body);cb=b.width()-b.children().width(),b.remove()})}(a,c.documentElement,f.prototype),function(a,b){b.presets={},b.preset=function(c,d,e){var f,g=b.presets[d],h={};e={inline:!0,defaultOptions:!1,disallowedElement:"*",widgets:{},__preset__:a.extend({},e)},a.each(g,function(a,b){("function"==typeof b||"options"===a||"commands"===a?h:e)[a]=b}),a.each(e.__preset__,function(a,b){h.options&&a in h.options||(e[a]=b,delete e.__preset__[a])});var i=e.init;return e.init=function(b){f=b.typer.getStaticWidget("__preset__"),a.each(g.overrides,function(a,c){b.typer[a]=function(a){return c.call(this,f,a)}}),"function"==typeof i&&i.call(e,b)},e.widgets.__preset__=h,h.inline=!0,new b(c,e)},a.fn.typer=function(a){return this.each(function(c,d){new b(d,a)})}}(a,Typer),function(a,f){function i(){return g.random().toString(36).substr(2,8)}function j(a){return"string"==typeof a&&a}function l(a){return a=e(a||""),a.charAt(0).toUpperCase()+a.slice(1)}function n(a){return a=e(a||""),a.charAt(0).toLowerCase()+a.slice(1)}function o(a,b){var c={};for(var d in a)d in b||(c[d]=a[d]);return c}function p(a,b){return(Aa[b]||(Aa[b]=new k("(?:^|\\s)("+b.replace(/\s+/g,"|")+")(?=$|\\s)"))).test(e(a||""))&&k.$1}function q(a,b){for(var c in a)if(!p(b[c],a[c]))return!1;return!0}function r(a,b){if(b in a)for(var c=a;c;c=d.getPrototypeOf(c))if(c.hasOwnProperty(b))return qa(c,b)}function s(a,b,c,e,f){var g={};g.configurable=c.indexOf("c")>=0,g.enumerable=c.indexOf("e")>=0,c.indexOf("g")>=0?(g.get=e,g.set=f||null):(g.writable=!0,g.value=e),d.defineProperty(a,b,g)}function t(b,c,e){var f=new Function("fn","return function "+(b||"")+"() { return fn.apply(this, arguments); }")(function(b){if(!(this instanceof f)){var c=d.create(f.prototype);return f.apply(c,arguments),c}if(!oa(e))return a.extend(this,b);e.apply(this,arguments)}),g=function(){};return g.prototype=za,f.prototype=new g,d.getOwnPropertyNames(c||{}).forEach(function(a){d.defineProperty(f.prototype,a,qa(c,a))}),s(f.prototype,"constructor","c",f),f}function u(a,b,c){var d=r(a,b)||{value:a[b]};s(a,b,!1!==d.enumerable?"eg":"g",function(){return d.get?d.get.call(a):d.value},function(e){e!==this[b]&&(d.set?d.set.call(a,e):d.value=e,c.call(this,b,e))})}function v(a){var b=/^([\w-:]*)(?:\(([^}]+)\))?$/.exec(a),c=null;try{c=b[2]&&JSON.parse(("{"+b[2]+"}").replace(/([{:,])\s*([^\s:,}]+)/g,'$1"$2"'))}catch(a){}return{name:b[1],params:c||{}}}function w(a,b){var c=new k("(^|\\s)\\s*"+b+"(?:-(\\S+)|\\b)$","ig"),d=[!1];return(a.className||"").replace(c,function(a,b){d[b?d.length:0]=b||!0}),d[1]?d.slice(1):d[0]}function x(a,b,c){var d=new k("(^|\\s)\\s*"+b+"(?:-(\\S+)|\\b)|\\s*$","ig"),e=0;a.className=(a.className||"").replace(d,function(){return e++||!c||0===c.length?"":" "+b+(c[0]?[""].concat(c).join(" "+b+"-"):"")})}function y(a,c){var d=b.getComputedStyle(a,c||null);return p(d.position,"absolute fixed relative")&&"auto"!==d.zIndex?parseInt(d.zIndex):-1}function z(a){var b=-1,d=c.createTreeWalker(c.body,1,function(c){if(f.comparePosition(c,a,!0))return 2;var d=y(c);return d>=0?(b=g.max(b,d),2):(b=g.max(b,y(c,"::before"),y(c,"::after")),1)},!1);return f.iterate(d),b+1}function A(a,b,c,d){d=f.is(d||c,h);var e=sa(d||ca),g=sa(d),i=p(c||b,"left right")||"left",j=p(c||b,"top bottom")||"top",k={};return b=(0|(a.top||a.clientY||a.y||b))-e.top,a=(0|(a.left||a.clientX||a.x||a))-e.left,k[i]=("left"===i?a:g.width-a)+"px",k[j]=("top"===j?b:g.height-b)+"px",k[ka[i]]="auto",k[ka[j]]="auto",k}function B(a,b){var c=A(a,null,b);return c.width=(0|a.width)+"px",c.height=(0|a.height)+"px",c}function C(b,c,e,f){var g=pa(c)||!c?{}:sa(c);"left"in g||(g.left=g.right=0|(c.left||c.clientX||c.x),g.top=g.bottom=0|(c.right||c.clientY||c.y));var h=p(e,"inset-x inset-y inset")||"inset-x",i="inset"===h?g:sa(f),j=sa(b,!0),k={},l={},m=function(a,b,c,d){if(!ka[a]){var e=g[ka[c]]+g[c];return a=e-2*i[c]<j[d]?c:2*i[ka[c]]-e<j[d]?ka[c]:"",l[c]=(a?i[a]:e/2)+k[a||c],a}var f=b?ka[a]:a;if(g[a]*la[f]+j[d]<=i[f]*la[f])l[c]=g[a]+k[ka[f]];else{if(!(g[ka[a]]*la[f]-j[d]>i[ka[f]]*la[f]))return l[c]=i[a]+k[a],a;a=ka[a],l[c]=g[a]+k[f]}return b?a:ka[a]},n=sa(b);d.keys(ka).forEach(function(a){k[a]=j[a]-n[a]});var o=p(e,"left right center")||"left",q=p(e,"top bottom center")||"bottom",r=m(o,ka[q]&&"inset-x"===h,"left","width"),s=m(q,ka[o]&&"inset-y"===h,"top","height"),t=A(l,r+" "+s);t.position="fixed",t.transform=ja[!s<<1|!r],a(b).css(t)}function D(){Da.forEach(function(a){f.is(a.ref,":visible")&&!f.rectEquals(sa(a.ref),a.rect||{})&&(a.list.forEach(function(b){f.is(b.elm,":visible")&&C(b.elm,a.ref,b.dir)}),a.rect=sa(a.ref))})}function E(b,d,e,g){for(var h=0;h<Ea.length;h++)if(Ea[h].control!==b&&!Ea[h].control.parentOf(b)){F(Ea[h].control);break}var i=Ea[0];i&&i.control===b||(i={},Ea.unshift(i)),a.when(i.promise).always(function(){a(d).appendTo(c.body).css({position:"fixed",zIndex:z(b.element)}),i.control=b,i.element=d,i.focusedElement=f.is(c.activeElement,ea),(pa(e)?C:Fa.snap)(d,e,g||"left bottom"),i.promise=a.when(I(b,"afterShow",i))})}function F(b){for(var c=Ea.length-1;c>=0&&b!==Ea[c].control&&!b.parentOf(Ea[c].control);c--);a.each(Ea.slice(0,c+1),function(b,c){"pending"===c.promise.state()||c.isClosing||(Fa.unsnap(c.element),c.isClosing=!0,c.promise=a.when(I(c.control,"beforeHide",c)).done(function(){Ea.splice(Ea.indexOf(c),1),a(c.element).detach()}))})}function G(a,b){try{return Ca.unshift(a),b()}finally{Ca.shift()}}function H(a,b,c,d,e){return e=e||a,oa(e[b])?G(a,function(){return e[b](a.ui,a,c,d)}):void 0}function I(a,b,c){return H(a,b,c,null,xa[a.ui.theme])}function J(a,b,c){if(a.ui===a||p(b,ga))H(a,b,c,null,a.ui),I(a,b,c);else{var d=a.constructor.prototype;a[b]!==d[b]&&H(a,b,c,null,d),H(a,b,c),I(a,a.type+l(b),c)}}function K(b,c,f,g,h){g=g||b.all||b.contextualParent.all,g._cache||s(g,"_cache","c",{}),f=f||b.defaultNS,h=h||{},b.name&&g!==b.contextualParent.all&&(h[b.name]=!0);var i=(f||"*")+"/"+c;b!==b.ui&&g===ua&&(i=[b.ui.type||"*",b.type,i].join("/"));var j=g._cache[i];if(j)return d.keys(o(j.include,a.extend(h,j.exclude)));var k={},l={};return e(c||"").replace(/(?:^|\s)(-?)((?:([\w-:]+|\*):)?(?:[\w-]+|\*|(?=\()))(\([^)]+\))?(?=$|\s)/g,function(b,c,d,e,h){var i={},j=(e||f||"").replace(/.$/,"$&:");d&&"*"!==d.slice(-1)?(d=d.indexOf(":")<0?j+d:d,g[d]&&(i[d]=!0)):a.each(g,function(a){("*"===e||a.substr(0,j.length)===j&&a.indexOf(":",j.length)<0)&&(i[a]=!0)}),h&&(h=v(h).params,a.each(i,function(a){q(h,g[a])||delete i[a]})),c?(a.extend(k,i),l=o(l,i)):a.extend(l,i)}),g._cache[i]={include:l,exclude:k},d.keys(o(l,a.extend(h,k)))}function L(b){var c={};a.each(b,function(a,b){c[b.name]=a}),b.sort(function(a,b){function d(a,b,c,d){return a[c]?K(a.contextualParent,a[c],a.name.substr(0,a.name.lastIndexOf(":"))).indexOf(b.name)>=0?d:-d:0}var e=d(a,b,"after",1),f=d(a,b,"before",-1),g=d(b,a,"after",-1),h=d(b,a,"before",1);return(!e&&!f)^(!g&&!h)?e||f||g||h:e+f+g+h||c[a.name]-c[b.name]})}function M(b,c,e){var f=b.ui;c=b instanceof Fa.group?c||f:b,e=e||{},oa(b.controls)&&(b.controls=b.controls(f,b)),j(b.controls)&&(b.controls=K(b,b.controls,null,ua,e),a.each(b.controls,function(a,b){e[b]=!0})),void 0!==b.controls&&(c.all=c.all||{}),b.controls=a.map(b.controls||[],function(g,h){var k=d.create(j(g)?ua[g]:g),l=k.name||j(g)||i();return l.indexOf(":")<0&&b.defaultNS&&(l=b.defaultNS+":"+l),a.extend(k,{ui:f,name:l,parent:b,contextualParent:c,defaultNS:j(k.defaultNS)||l,icon:j(k.icon)||l,label:j(k.label)||l}),!j(k.shortcut)&&j(k.execute)&&(k.shortcut=Fa.getShortcut(k.execute)),c.all[l]=k,s(k,"_m","c",0),M(k,c,(b===f||b===c)&&a.extend({},e)),k}),L(b.controls)}function N(b,c){function d(c,d){d=oa(xa[g.theme]["bind"+l(c)])?I(b,"bind"+l(c),d):I(b,"bind",d),a.each(h[c],function(b,c){"_"===c[1]?a(c[0]).html(d||""):p(c[1],fa)?a(c[0]).prop(c[1],!!d&&"false"!==d):d?a(c[0]).attr(c[1],d):a(c[0]).removeAttr(c[1])})}function e(c){a(c).find("*").addBack().filter("[x\\:bind]").each(function(c,e){var f=v(a(e).attr("x:bind"));a.each(f.params,function(a,c){h[c]||(h[c]=[],u(b,c,d)),h[c].push([e,a])})}).removeAttr("x:bind")}function f(c){var d=a(xa[g.theme][c]||'<div><br x:t="children"></div>')[0];return e(d),a("[x\\:t]",d).each(function(c,d){var h,i=v(a(d).attr("x:t"));if(oa(xa[g.theme][i.name]))h=a(xa[g.theme][i.name](g,b,i.params)),e(h);else if("children"===i.name){var j=b.controls;for(var k in i.params){j=j.filter(q.bind(null,i.params));break}h=j.map(function(a){return N(a,i.params)})}else h=f(i.name);a(d).replaceWith(h)}),d}var g=b.ui,h={};return b.element=f(b.renderAs||b.type),a(b.element).attr("role",b.name).addClass(b.cssClass).data("typerControl",b),a.each(h,function(a,c){d(a,b[a])}),b.element}function O(b,c){var d=b.all||b.contextualParent.all,e=K(b,c,null,d);return e.length?a.map(e,function(a){return d[a]}):a.map(b.controls,function(a){return O(a,c)})}function P(a,b,c){var d=b<<8;return a._m&d||(a._m|=d|c()*b),(a._m&b)>0}function Q(a){return P(a,1,function(){var b=a.ui;return!(!b.typer&&(a.requireTyper||a.requireWidget||a.requireWidgetEnabled||a.requireCommand))&&(!(a.requireCommand&&!b.typer.hasCommand(a.requireCommand)||a.requireWidgetEnabled&&!b.typer.widgetEnabled(a.requireWidgetEnabled))&&(!(!0===a.requireWidget&&!d.getOwnPropertyNames(b._widgets)[0]||a.requireWidget&&!a.widget)&&(!(!0===a.requireChildControls&&(!a.controls.some(Q)||a.controls.every(S)))&&(!1!==a.enabled&&!1!==H(a,"enabled")))))})}function R(a){return P(a,2,function(){return!0===a.active||!!H(a,"active")})}function S(a){return P(a,4,function(){return!Q(a)&&a.hiddenWhenDisabled||!1===a.visible||!1===H(a,"visible")})}function T(a){var b=a.ui,c=xa[b.theme];a._m=0;var d;(a.requireWidget||a.requireWidgetEnabled)&&(a.widget=b._widgets[a.requireWidget||a.requireWidgetEnabled]||b.widget,d=a.requireWidget&&!a.widget),!d&&Ca.indexOf(a,1)<0&&(a.getState(c.controlErrorClass||"error")&&W(a),J(a,"stateChange"));var e=!Q(a);void 0!==a.element.disabled&&(a.element.disabled=e),a.setState(c.controlDisabledClass||"disabled",e),a.setState(c.controlActiveClass||"active",R(a)),a.setState(c.controlHiddenClass||"hidden",S(a))}function U(a,b,c){try{if(b(a,c),Ba.indexOf(a)>0)return Ba[0].promise}finally{if(Ba[0]===a)for(;(!Ba[0].promise||"pending"!==Ba[0].promise.state())&&Ba.shift()&&Ba[0];);}}function V(a){var b=a.ui.typer;b?oa(a.execute)?b.invoke(function(b){H(a,"execute",b,a.getValue())}):b.hasCommand(a.execute)&&b.invoke(a.execute,a.getValue()):H(a,"execute",null,a.getValue()),J(a,"executed")}function W(a){var b=[],c={};return H(a,"validate",function(a,d,e){a||(d=d||"generic",c[d]=!0,b.push({type:d,description:e||""}))}),x(a.element,xa[a.ui.theme].controlErrorClass||"error",d.keys(c)),I(a,"validate",b),b[0]&&a}function X(b,c,e,f){a.each(d.keys(b.all).reverse(),function(a,d){d=b.all[d],d.all&&X(d,c,e,f),c(d,e,f)})}function Y(b){var c=b.ui,d=a.Deferred(),e=function(e,f){if(c.validate()){f=f||c.resolveOne(b.resolveBy);var g=a.when(H(b,"submit",f));"pending"===g.state()&&J(b,"waiting",f),g.done(function(a){J(b,"success",a),d.resolve(e)}),g.fail(function(a){J(b,"error",a),Fa.focus(b.element,!0)})}},f=function(){var a=c.resolveOne(b.resolveWith)||b;e(a.getValue(),this)},g=function(){d.reject()};return b.resolve(b.resolveBy).forEach(function(a){a.execute=f}),b.resolve(b.rejectBy).forEach(function(a){a.execute=g}),H(b,"setup",e,g),{promise:d.promise(),resolve:f,reject:g}}function Z(a,b){return j(b)?a.resolveOne(b):b||a.controls[0]}function $(a,b,c){ya[a]=ya[a]||{hooks:[],commands:[]},ya[a][b].push(c)}function _(b){var c=[b.element];return X(b,function(b){if(!ra(b,b.parent)){for(var d=b.element;d.parentNode&&!a.contains(d.parentNode,c[0]);d=d.parentNode);c[c.length]=d}}),a.unique(c)}function aa(a,b){return _(a).some(function(a){return ra(a,b)})}var ba,ca,da=":text, :password, :checkbox, :radio, textarea, [contenteditable]",ea=":input, [contenteditable], a[href], area[href], iframe",fa="checked selected disabled readonly multiple ismap",ga="executing executed cancelled",ha=navigator.userAgent.indexOf("Macintosh")>=0,ia="ontouchstart"in b,ja="none translate(-50%,0) translate(0,-50%) translate(-50%,-50%)".split(" "),ka={top:"bottom",left:"right",right:"left",bottom:"top"},la={top:-1,left:-1,right:1,bottom:1},ma={ctrl:"⌘",alt:"⌥",shift:"⇧",enter:"↩",tab:"ℵ",pageUp:"⇞",pageDown:"⇟",backspace:"⌫",escape:"⎋",leftArrow:"⭠",upArrow:"⭡",rightArrow:"⭢",downArrow:"⭣",home:"⭦",end:"⭨"},na=a._data,oa=a.isFunction,pa=a.isPlainObject,qa=d.getOwnPropertyDescriptor,ra=f.containsOrEquals,sa=f.getRect,ta=c.createElement("div"),ua={},va={},wa={},xa={},ya={},za={},Aa={},Ba=[],Ca=[],Da=[],Ea=[],Fa=f.ui=t("TyperUI",null,function(b,c){j(b)&&(b={controls:b});var e=Ca[0]||Ba[0];e&&a.extend(b,{theme:e.ui.theme,typer:e.ui.typer,widget:e.ui.widget,parent:e.ui,parentControl:e});var f=a.extend(this,b);f.ui=f,f.theme=f.theme||d.keys(xa)[0],f.all={},M(f),N(f),a(f.element).addClass("typer-ui typer-ui-"+f.theme),a(f.element).mousedown(function(){Fa.focus(f.element)}),X(f,J,"init"),J(f,"init"),f.typer&&f.retainFocus(f.typer),pa(c)&&a.each(c,function(a,b){f.setValue(a,b)})});a.extend(Fa.prototype,{language:"en",update:function(){var b=this;b._widgets={},b.widget?b._widgets[b.widget.id]=b.widget:b.typer&&a.each(b.typer.getSelection().getWidgets().concat(b.typer.getStaticWidgets()),function(a,c){b._widgets[c.id]=c}),X(this,T)},destroy:function(){var b=this;X(b,J,"destroy"),Fa.unsnap(b.element),a(b.element).remove()},getControl:function(b){var c=a(b).parents("[role]").addBack("[role]").get().reverse();return a.map(c,function(b){return a(b).data("typerControl")})[0]},resolve:function(a){var b=Ca[0];return O(b&&b.ui===this?b:this,a)},trigger:function(a,b,c){a=Z(this,a),J(a,b,c)},show:function(a,b,c,d){a&&a.ui===this?(a=Z(this,a),E(a,b,c,d)):E(this,this.element,a,b)},hide:function(a){return(a=a?Z(this,a):this)&&F(a)},enabled:function(a){return(a=Z(this,a))&&Q(a)},active:function(a){return(a=Z(this,a))&&R(a)},visible:function(a){return(a=Z(this,a))&&!S(a)},getIcon:function(a){return(va[a.icon]||va[a.name]||va[a]||"")[this.iconset||xa[this.theme].iconset]||""},getLabel:function(a){if(a=(a||"").label||a,wa[a]){if(this.language in wa[a])return wa[a][this.language];for(var b in wa[a])return wa[a][b]}return a},validate:function(){var a,b;return X(this,function(c){c.validate&&Q(c)&&(b=W(c)),a=a||b}),a&&Fa.focus(a.element,!0),!a},reset:function(){var a=this,b=xa[a.theme].controlErrorClass||"error";X(a,function(a){a.validate&&a.setState(b,!1),J(a,"reset")}),a.update()},getValue:function(a){return(a=Z(this,a))&&a.getValue()},setValue:function(a,b){return arguments.length<2?this.setValue(this.controls[0],a):(a=Z(this,a))&&a.setValue(b)},getState:function(a,b){return(a=Z(this,a))&&a.getState(b)},setState:function(a,b,c){this.resolve(a).forEach(function(a){a.setState(b,c)})},set:function(a,b,c){this.resolve(a).forEach(function(a){a.set(b,c)})},execute:function(b,c){if((b=Z(this,b))&&Ba.indexOf(b)<0&&Q(b)){if(void 0!==c&&b.setValue(c),Ba.unshift(b),J(b,"executing"),oa(b.dialog)){var d=b.promise=a.when(H(b,"dialog"));return d.done(function(a){U(b,function(){b.setValue(a),V(b)})}),d.fail(function(){U(b,J,"cancelled")}),d}return U(b,V)}},focus:function(){Fa.focus((Z(this)||this).element)},retainFocus:function(a){_(this).forEach(a.retainFocus.bind(a))}}),a.extend(Fa,{isTouchDevice:ia,controls:ua,themes:xa,controlExtensions:za,matchWSDelim:p,getZIndex:y,getZIndexOver:z,getRect:sa,listen:u,cssFromPoint:A,cssFromRect:B,getState:w,setState:x,define:function(b,c,d){if(pa(b))return void a.each(b,Fa.define);c=c||{},d=d||(qa(c,"constructor")||"").value,c.type=b,Fa[b]=t("TyperUI"+l(b),c,d)},getShortcut:function(a){var b=ya._map[a];return b&&b[0]},addControls:function(b,c){var d=j(b)?b+":":"";a.each(c||b,function(a,b){ua[d+a]=b})},addIcons:function(b,c,d){var e=j(c)?c+":":"";a.each(d||c,function(a,c){a=e+a,va[a]||(va[a]={}),va[a][b]=c})},addLabels:function(b,c,d){var e=j(c)?c+":":"";a.each(d||c,function(a,c){a=e+a,wa[a]||(wa[a]={}),wa[a][b]=c})},addHook:function(b,c){if(pa(b))return void a.each(b,Fa.addHook);(b||"").replace(/\S+/g,function(a){$(a,"hooks",c)})},setShortcut:function(b,c){if(pa(b))return void a.each(b,Fa.setShortcut);b=v(b),ya._map=ya._map||{};var d=ya._map[b.name]=ya._map[b.name]||[],e=d.slice(0);(c||"").replace(/\S+/g,function(a){var c=e.indexOf(a);c>=0?e.splice(c,1):(d[d.length]=a,$(a,"commands",{command:b.name,value:(b.params||"").value
}))}),a.each(e,function(c,e){d.splice(d.indexOf(e),1),a.each(ya[e],function(a,c){if(c.command===b.name&&c.value===(b.params||"").value)return ya[e].splice(a,1),!1})})},setZIndex:function(b,c){b.style.zIndex=z(c),"static"===a(b).css("position")&&(b.style.position="relative")},snap:function(a,b,d){Fa.unsnap(a),b=f.is(b,h)||c.documentElement,(na(b).typerSnaps||(na(b).typerSnaps=Da[Da.push({ref:b,list:[]})-1])).list.push({elm:a,dir:d}),C(a,b,d)},unsnap:function(a){for(var b=Da.length-1;b>=0;b--){for(var c=Da[b].list.length-1;c>=0;c--)ra(a,Da[b].list[c].elm)&&Da[b].list.splice(c,1);Da[b].list[0]||delete na(Da.splice(b,1)[0].ref).typerSnaps}},focus:function(b,d){(!a.contains(b,c.activeElement)||d&&!a(c.activeElement).is(da))&&a(d?da:ea,b).not(":disabled, :hidden").addBack()[0].focus()},alert:function(a){return Fa("dialog:prompt -dialog:input -dialog:buttonCancel",{message:a}).execute()},confirm:function(a){return Fa("dialog:prompt -dialog:input",{message:a}).execute()},prompt:function(a,b){return Fa("dialog:prompt",{message:a,input:b}).execute()},hint:function(a){return Fa("dialog:hint",{message:a}).execute()},getWheelDelta:function(a){a=a.originalEvent||a;var b=-a.wheelDeltaY||-a.wheelDelta||a.detail;return b/g.abs(b)*(ha?-1:1)}}),a.extend(za,{buttonsetGroup:"left",cssClass:"",hiddenWhenDisabled:!1,pinDirection:"none",renderAs:"",requireChildControls:!1,requireTyper:!1,requireWidget:"",requireWidgetEnabled:"",showButtonLabel:!0,hideCalloutOnExecute:!0,is:function(a){return":"===a.charAt(0)?w(this.element,a):p(this.type,a)},parentOf:function(a){for(;a;a=a.parent)if(this===a)return!0;return!1},resolve:function(a){return O(this,a)},resolveOne:function(a){return this.resolve(a)[0]},set:function(a,b){var c=this;G(c,function(){if(j(a))c[a]=b;else for(var d in a)c[d]=a[d]}),T(c)},getValue:function(){var b=this;return G(b,function(){if(b.valueMap){var c={};return a.each(b.valueMap,function(a,d){c[a]=b.ui.getValue(d)}),c}return b.value})},setValue:function(b){var c=this;G(c,function(){c.valueMap?a.each(c.valueMap,function(a,d){c.ui.setValue(d,(b||"")[a])}):c.value=b}),T(c)},getState:function(a){return w(this.element,a)},setState:function(a,b){return x(this.element,a,b)}}),Fa.theme=t("TyperUITheme"),Fa.themeExtensions=Fa.theme.prototype,a.extend(Fa.themeExtensions,{textboxPresetOptions:null,bind:function(a,b,c){return ta.textContent=a.getLabel(c)||"",ta.innerHTML.replace(/(^|\s)\*\*(.+)\*\*(?=\s|$)/g,"$1<b>$2</b>").replace("\n","<br>")},bindIcon:function(a,b,c){return a.getIcon(c)},bindShortcut:function(a,b,c){var d={},e=(c||"").replace(/ctrl|alt|shift/gi,function(a){return ha?(d[a.toLowerCase()]=ma[a.toLowerCase()],""):l(a)+"+"});return ha?(d.alt||"")+(d.shift||"")+(d.ctrl||"")+(ma[n(e)]||e):e}}),function(a,b){var c=a[b];s(a,b,"ceg",function(){var a=this.contextualParent;return a?a[b]:c},function(a){s(this,b,"ce",a)})}(za,"pinDirection"),Fa.define({group:{hiddenWhenDisabled:!0,requireChildControls:!0,controls:"*",constructor:function(b,c){j(b)?(this.controls=b,j(c)?this.type=c:a.extend(this,c)):a.extend(this,b)}},dropdown:{optionFilter:"(type:button) -(dropdownOption:exclude)",defaultEmpty:!1,allowEmpty:!1,selectedIndex:-1,requireChildControls:!0,controls:"*",get value(){return this.selectedValue},set value(b){var c=this;c.selectedIndex=-1,a.each(c.resolve(c.optionFilter),function(a,d){if(d.value===b)return c.selectedIndex=a,c.selectedText=d.label||d.name,c.selectedValue=d.value,!1}),-1===c.selectedIndex&&(c.selectedValue="",c.selectedText=c.label||c.name),X(c,T)},init:function(b,c){c.selectedText=c.label||c.name,a.each(c.resolve(c.optionFilter),function(a,d){d.active=function(){return c.selectedIndex===a},d.execute=function(){c.value=d.value,b.execute(c)}}),a(c.element).click(function(){Q(c)&&I(c,"showCallout")})},stateChange:function(a,b){var c=b.resolve(b.optionFilter);(b.selectedIndex<0||!Q(c[b.selectedIndex]))&&(b.defaultEmpty?b.selectedIndex>=0&&(b.value=""):b.value=(c.filter(Q)[0]||"").value)},validate:function(a,b,c){c(b.allowEmpty||b.selectedIndex>=0,"required")},reset:function(a,b){b.value=b.defaultEmpty?"":(b.resolve(b.optionFilter).filter(Q)[0]||"").value}},callout:{allowButtonMode:!1,controls:"*",stateChange:function(a,b){if(b.allowButtonMode){var c=b.resolve("*:*").filter(Q);if(1===c.length)b.icon=c[0].icon,b.label=c[0].label;else{var e=d.getPrototypeOf(b);b.icon=e.icon||b.name,b.label=e.label||b.name}}},execute:function(a,b){if(b.allowButtonMode){var c=b.resolve("*:*").filter(Q);if(1===c.length)return void a.execute(c[0])}I(b,"showCallout")}},label:{get value(){return this.label},set value(a){this.label=a}},button:{},link:{},file:{},textbox:{preset:"textbox",get value(){return this.preset.getValue()},set value(a){this.preset.setValue(a)},validate:function(a,b,c){b.preset.validate(c)},reset:function(a,b){b.preset.setValue("")},init:function(b,c){var d=a(xa[b.theme].textboxElement,c.element)[0],e=a.extend({},xa[b.theme].textboxPresetOptions,c.presetOptions,{contentChange:function(a){W(c),a.typer.focused()&&b.execute(c)}});c.preset=f.preset(d,c.preset,e),c.preset.parentControl=c,c.presetOptions=c.preset.getStaticWidget("__preset__").options}},checkbox:{required:!1,validate:function(a,b,c){c(!b.required||b.value,"required")},reset:function(a,b){b.value=!1}},dialog:{pinnable:!1,modal:!0,keyboardResolve:!0,keyboardReject:!0,resolveBy:"dialog:buttonOK",rejectBy:"dialog:buttonCancel",dialog:function(b,d){var e=ba,f=c.activeElement,g=Y(d),h={control:d,element:d.element};return b.update(),a(b.element).appendTo(c.body),m(function(){I(d,"afterShow",h),Fa.focus(d.element)}),g.promise.always(function(){a.when(I(d,"beforeHide",h)).always(function(){b.destroy()}),ba=e,f&&f.focus()}),Fa.setZIndex(b.element,c.body),ba={control:d,clickReject:!d.modal&&g.reject,keyboardResolve:d.keyboardResolve&&g.resolve,keyboardReject:d.keyboardReject&&g.reject},g.promise}}}),Fa.addControls("dialog",{buttonset:Fa.group("(type:button)",{type:"buttonset",defaultNS:"dialog"}),buttonOK:Fa.label({type:"button",buttonsetGroup:"right"}),buttonCancel:Fa.label({type:"button",buttonsetGroup:"right"}),message:Fa.label(),input:Fa.textbox(),prompt:Fa.dialog({pinnable:!0,defaultNS:"dialog",controls:"message input buttonset",resolveWith:"input"}),hint:Fa.dialog({pinnable:!0,modal:!1,defaultNS:"dialog",controls:"message"})}),Fa.addLabels("en","dialog",{input:"",buttonOK:"OK",buttonCancel:"Cancel"}),Fa.addIcons("material","dialog",{buttonOK:"",buttonCancel:""}),f.defaultOptions.shortcut=!0,f.widgets.shortcut={keystroke:function(b){var c=ya[b.data]||{};!b.isDefaultPrevented()&&c.commands&&a.each(c.commands,function(a,c){if(b.typer.hasCommand(c.command))return b.typer.invoke(c.command,c.value),b.preventDefault(),!1}),a.each(c.hooks||[],function(a,c){c(b)})}},a(function(){function d(a){if("none"===b.getComputedStyle(a.target).pointerEvents){a.stopPropagation();var d=c.createEvent("MouseEvent");d.initMouseEvent(a.type,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget),f.elementFromPoint(a.clientX,a.clientY).dispatchEvent(d)}}if(a(b).keydown(function(b){!ba||13!==b.which&&27!==b.which||(ba[13===b.which?"keyboardResolve":"keyboardReject"]||a.noop)()}),a(b).focusin(function(a){ba&&a.relatedTarget&&!aa(ba.control,a.target)&&m(Fa.focus,0,ba.control.element)}),a(b).on("resize scroll orientationchange",function(){f.setTimeoutOnce(D)}),a(c.body).on("mousemove mousewheel keyup touchend",function(){f.setTimeoutOnce(D)}),a(c.body).on("click","label",function(b){a(ea,b.currentTarget).not(":disabled, :hidden").eq(0).focus()}),a(c.body).on(ia?"touchstart":"mousedown",function(b){ba&&ba.clickReject&&!aa(ba.control,b.target)&&ba.clickReject(),a.each(Ea.slice(0),function(a,c){aa(c.control,b.target)||c.focusedElement&&ra(c.focusedElement,b.target)||F(c.control)})}),ia){var e;a(c.body).on("focusin focusout",function(a){e="focusin"===a.type?a.target:null}),a(c.body).on("touchend",function(b){e&&!ra(e,b.target)&&(e.blur(),a(e).trigger(a.Event("focusout",{relatedTarget:b.target})))})}f.msie10&&a.each("mousedown mouseup mousemove click".split(" "),function(a,b){c.body.addEventListener(b,d,!0)}),ca=a('<div style="position:fixed;top:0;left:0;">').appendTo(c.body)[0]})}(a,Typer),function(a,d){function e(){D.timestamp=r.getSelection().timestamp,D.rect=y(r).translate(x.scrollLeft,x.scrollTop),a.extend(this,{typer:r,pointerX:D.x||0,pointerY:D.y||0,mousedown:F,hoverNode:t||null,activeHandle:s||null,editorReflow:!E.rect||!d.rectEquals(E.rect,D.rect),pointerMoved:E.x!=D.x||E.y!=D.y,selectionChanged:E.timestamp!==D.timestamp}),a.extend(E,D)}function f(a,b){this.cursor=a||"pointer",this.done=b}function i(){var e={N:"typer-visualizer",G:"background",S:"selection",X:"transparent"};a(c.body).append("<style>.has-N{caret-color:X;}.has-N:focus{outline:none;}.has-N::S,.has-N ::S{G:X;}.has-N::-moz-S,.has-N ::-moz-S{G:X;}@keyframes caret{0%{opacity:1;}100%{opacity:0;}}</style>".replace(/\b[A-Z]/g,function(a){return e[a]||a})).append(z),a(z).mousedown(function(b){1&b.buttons&&(s=A.get(b.target),d.draggable(b,r.element).always(function(){(s.done||a.noop).call(s),s=null}),b.preventDefault())}),a(c.body).on("mousedown mousemove mouseup",function(a){D.x=a.clientX,D.y=a.clientY,t=r&&r.nodeFromPoint(D.x,D.y),n(w),"mousemove"===a.type?w=m(q,0):(F=1&a.buttons,w=m(q,0,!0))}),a(b).on("scroll resize orientationchange focus",q)}function j(b){var c=d.getAbstractSide("inline-start",b.startContainer),e=d.getAbstractSide("inline-end",b.startContainer),f=[];return a.each(d.getRects(b),function(a,b){g.abs(b[c]-b[e])<=1&&(b[e]+=5),f.forEach(function(a){g.abs(b.left-a.right)<=1&&(a.right=b.left),g.abs(b.top-a.bottom)<=1&&(a.bottom=b.top)}),f.unshift(b)}),f}function k(a,b){B[a]=[b,[],{},!0]}function p(a,b,c,e,f){for(var g=0,h=u.length;g<h;g++)if(u[g].state===b&&u[g].kind===a)return void(v[v.length]=u.splice(g,1)[0]);v[v.length]={kind:a,state:b,rect:c||("top"in b?b:d.getRect),css:e,handle:f}}function q(b){if(b=!0===b,n(w),r&&(b||r.focused(!0))){var f=new e;(b||f.editorReflow||f.selectionChanged||f.pointerMoved)&&a.each(B,function(e,g){v=g[1],u=v.splice(0),!1!==g[3]&&g[0].call(null,f,g[2]),u.forEach(function(b){C[C.length]=a(b.dom).detach().removeAttr("style")[0],A.delete(b.dom)}),v.forEach(function(e){if(b||!e.dom||f.editorReflow||a.isFunction(e.rect)){var g=e.dom||(e.dom=a(C.pop()||c.createElement("div")).appendTo(z)[0]);a(g).css(a.extend({position:"absolute",cursor:(e.handle||"").cursor,pointerEvents:e.handle?"all":"none"},e.css,d.ui.cssFromRect("top"in e.rect?e.rect:e.rect(e.state),z))),A.set(g,e.handle)}})})}}var r,s,t,u,v,w,x=c.documentElement,y=d.getRect,z=a('<div style="position:absolute;top:0;left:0;">')[0],A=new o.WeakMap,B={},C=[],D={},E={},F=!1;a.extend(e.prototype,{refresh:function(){m(q,0,!0)},toggleLayer:function(a,b){var c=!1;a.split(" ").forEach(function(a){c|=b^(B[a]||"")[3],(B[a]||{})[3]=b}),c&&m(q,0,!0)},fill:function(a,b,c){var e={};if(e.background=b||"rgba(0,31,81,0.2)",a instanceof h||"top"in a)p("f",a,null,e,c);else{var f=[];d.iterate(r.createSelection(a).createTreeWalker(-1,function(b){return d.rangeCovers(a,b.element)?(f[f.length]=y(b),2):d.is(b,d.NODE_ANY_ALLOWTEXT)?(f.push.apply(f,j(d.createRange(a,d.createRange(b.element,"content")))),2):1})),f.forEach(function(a){p("f",a,null,e,c)})}},drawCaret:function(a){p("k",a,null,{animation:"caret 0.5s infinite alternate ease-in",outline:"1px solid rgba(0,31,81,0.8)"})},drawBorder:function(a,b,c,d,e){var f={};f.border=l(b)+"px "+(d||"solid")+" "+(c||"black"),f.margin=e?"0px":-l(b)+"px",f.boxSizing=e?"border-box":"auto",p("b",a,null,f)},drawLine:function(a,b,c,e,f,h,i,j){var k=c-a,m=e-b,n={};n.borderTop=l(f)+"px "+(i||"solid")+" "+(h||"black"),n.transformOrigin="0% 50%",n.transform="translateY(-50%) rotate("+g.atan2(m,k)+"rad)",p("l",d.toPlainRect(a,b,a+g.sqrt(m*m+k*k),b),null,n,j)},drawHandle:function(a,b,c,e,f){var g={};g.border="1px solid #999",g.background="white"+(e?' url("'+e+'")':""),c=c||8,p("c",a,function(){var e=y(a),f=d.ui.matchWSDelim(b,"left right")||"centerX",g=d.ui.matchWSDelim(b,"top bottom")||"centerY";return e.left-=c,e.top-=c,d.toPlainRect(e[f],e[g],e[f]+c,e[g]+c)},g,f)}}),k("selection",function(a){var b=a.typer.getSelection(),c=b.startNode;b.isCaret?"caretColor"in x.style&&a.drawCaret(b.baseCaret):d.is(c,d.NODE_WIDGET)===b.focusNode?a.fill(c.element):a.fill(b.getRange())}),d.widgets.visualizer={init:function(b){a(b.typer.element).addClass("has-typer-visualizer"),i.init||(i(),i.init=!0)},focusin:function(a){r=a.typer,d.ui.setZIndex(z,r.element),q(!0)},focusout:function(b){r=null,a(z).children().detach()},contentChange:function(a){q(!0)},stateChange:function(a){q()}},d.defaultOptions.visualizer=!0,d.canvas={addLayer:k,handle:function(a,b){return new f(a,b)}}}(a,Typer),function(a,b){var c,d,e=b.getRect,f=b.containsOrEquals,g=b.canvas.handle("move",function(){c&&d&&c.typer.invoke(function(a){a.selection.select(d),a.insertHtml(c.element)})});b.canvas.addLayer("dragWidget",function(a){var h=a.hoverNode;if(a.activeHandle===g){var i=b.closest(h,b.NODE_PARAGRAPH|b.NODE_WIDGET);if(d=null,i&&!f(c,i)){var j=e(i),k=e(b.closest(i,b.NODE_EDITABLE)),l=a.pointerY<j.centerY,m=l?i.previousSibling:i.nextSibling;if(m!==c&&a.typer.widgetAllowed(c.widget.id,i)){var n;if(m){var o=e(m);n=(j.bottom<=o.top?j.bottom+o.top:o.bottom+j.top)/2}else n=e(i,!0)[l?"top":"bottom"];a.drawLine(k.left,n,k.right,n,1,"red","dashed"),d=a.typer.createCaret(i.element,l)}}a.fill(c.element)}else!h||c&&!f(c,h)&&b.pointInRect(a.pointerX,a.pointerY,e(c),10)||(c=b.closest(h,b.NODE_WIDGET));c&&a.drawHandle(c,"top left",11,"data:image/gif;base64,R0lGODlhCwALAKEBAE1PUP///////////yH5BAEKAAIALAAAAAALAAsAAAIUjI8ZoAffDFOzuoexk5zGBUXTlxQAOw==",g)})}(0,Typer),function(a,c){function e(b){return b.filter(function(c){return!b.some(function(b){return a.contains(b,c)})})}function f(b){var c=a(b).css("text-align"),d=a(b).css("direction");switch(c){case"-webkit-left":case"-webkit-right":case"-webkit-center":return c.slice(8);case"start":return"ltr"===d?"left":"right";case"end":return"ltr"===d?"right":"left";default:return c}}function g(b,c){var d;return a(b).each(function(b,e){var g;g="textAlign"===c?f(e):"inlineClass"===c?a(e).attr("class")||"":a(e).css(c),d=""===d||d&&d!==g?"":g}),d||""}function i(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),a===b||A.test(a)&&A.test(b)}function j(a,b){var d=c.createElement(a);return b&&(d.className=b),d}function l(b,d){return d=c.is(d,h)||j(d),a(d).append(b.childNodes).replaceAll(b)[0]}function m(d,e,f,g,h){var i=d.selection,j=i.getParagraphElements();if(i.isCaret&&!g)d.insertHtml(e),e.appendChild(c.createTextNode()),i.moveToText(e,-0);else{var k=i.getSelectedTextNodes();j.forEach(function(d){if(!h||!c.ui.matchWSDelim(b.getComputedStyle(d)[h[0]],h[1]))if(g){var i=a(k,d).parentsUntil(d).filter(f),j=i.contents().filter(function(a,b){return k.every(function(a){return!c.containsOrEquals(b,a)})});i.contents().unwrap(),j.wrap(e)}else a(d).find(k).wrap(e)}),i.select(k[0],0,k[k.length-1],-0)}a(j).find(f).filter(":has("+f+")").each(function(b,c){a(c).contents().unwrap().filter(function(a,b){return 3===b.nodeType}).wrap(c)}),a(j).find('span[class=""],span:not([class])').contents().unwrap(),a(j).find(f).each(function(b,d){c.sameElementSpec(d.previousSibling,d)&&(a(d.childNodes).appendTo(d.previousSibling),a(d).remove())})}function n(b){a(b.selection.getParagraphElements()).attr("align",v[b.commandName])}function o(a){var b=a.commandName;m(a,j(w[b].split(",")[0]),w[b],a.widget[b],x[b])}function p(b,d){var e="insertOrderedList"===b.commandName||d?"ol":"ul",f="<"+e+(d||"").replace(/^.+/,' type="$&"')+">",g=function(b,f){return c.is(f,e)&&(a(f).attr("type")||"")===(d||"")},h=[];a.each(b.selection.getParagraphElements(),function(d,e){if(a(e).is("ol>li,ul>li"))a(e.parentNode).filter(g)[0]?a(e).is("li")&&a.inArray(e.parentNode,h)<0&&r(b,[e]):(l(e.parentNode,a(f)[0]),h.push(e.parentNode));else{var i=a(e).prev().filter(g)[0]||a(e).next().filter(g)[0]||a(f).insertAfter(e)[0];a(e)[c.comparePosition(e,i)<0?"prependTo":"appendTo"](i),l(e,"li"),h.push(i)}})}function q(b,d){d=a.makeArray(d||e(b.selection.getParagraphElements())),a.each(d,function(b,d){var e=a(d).parent("ul,ol")[0]||a(d).prev("ul,ol")[0]||a("<ul>").insertBefore(d)[0],f=e;if(f===d.parentNode){var g=a(d).prev("li")[0]||a("<li>").insertBefore(d)[0];f=a(g).children("ul,ol")[0]||a(e.cloneNode(!1)).appendTo(g)[0]}a(l(d,"li")).appendTo(f),a(f).parent("li")[0]&&a(c.createTextNode(" ")).insertBefore(f),e.children[0]||a(e).remove()})}function r(b,d){d=a.makeArray(d||e(b.selection.getParagraphElements())),a.each(d,function(d,e){var f=a(e).parent("ul,ol")[0],g=a(f).parent("li")[0];a(e).next("li")[0]&&(g?a(f.cloneNode(!1)).append(a(e).nextAll()).appendTo(e):(a(f.cloneNode(!1)).append(a(e).nextAll()).insertAfter(f),a(e).children("ul,ol").insertAfter(f))),g?(a(e).insertAfter(g),c.trim(b.typer.extractText(g))||a(g).remove()):a(l(e,"p")).insertAfter(f),f.children[0]||a(f).remove()})}function s(a,b){var d=a.typer.getSelection();return!!(b?d.startNode.nodeType&(c.NODE_PARAGRAPH|c.NODE_EDITABLE_PARAGRAPH|c.NODE_INLINE):d.getParagraphElements()[0])}function t(a,b){return c.ui.button({requireWidget:b,requireCommand:a,execute:a,active:function(b,c){return c.widget&&c.widget[a]},enabled:function(a){return s(a,"inlineStyle"===b)}})}function u(b,d){return c.ui.button({name:y[b],annotation:d,requireWidgetEnabled:"list",value:b,execute:function(a,c,d){d.insertWidget("list",b)},active:function(c,d){return d.widget&&a(d.widget.element).attr("type")===b}})}var v={justifyLeft:"left",justifyRight:"right",justifyCenter:"center",justifyFull:"justify"},w={bold:"b,strong",italic:"i,em",underline:"u",strikeThrough:"strike"},x={bold:["fontWeight","bold 700"],italic:["fontStyle","italic"],underline:["textDecoration","underline"],strikeThrough:["textDecoration","line-through"]},y={1:"decimal",A:"upper-alpha",a:"lower-alpha",I:"upper-roman",i:"lower-roman"},z=/^([a-z\d]*)(?:\.(.+))?/i,A=/^(p|h[1-6])(?:\.(.+))?$/i;c.widgets.inlineStyle={beforeStateChange:function(b){var d=b.typer.getSelection().getSelectedElements();b.widget.inlineClass=g(a(d).filter("span"),"inlineClass"),a.each(x,function(a,e){b.widget[a]=!!c.ui.matchWSDelim(g(d,e[0]),e[1])})},commands:{bold:o,italic:o,underline:o,strikeThrough:o,superscript:o,subscript:o,applyClass:function(a,b){m(a,j("span",b),"span")}}},c.widgets.formatting={beforeStateChange:function(b){var c=b.typer.getSelection(),d=c.getParagraphElements().slice(-1)[0];a(d).is("li")&&(d=a(d).closest("ol, ul")[0]||d);var e=d&&d.tagName.toLowerCase(),f=e+(a(d).attr("class")||"").replace(/^(.)/,".$1"),h=g(c.getSelectedElements(),"textAlign");a.extend(b.widget,{justifyLeft:"left"===h,justifyCenter:"center"===h,justifyRight:"right"===h,justifyFull:"justify"===h,formatting:e,formattingWithClassName:f})},enter:function(a){a.typer.widgetEnabled("lineBreak")&&c.is(a.typer.getSelection().startNode,c.NODE_EDITABLE_PARAGRAPH)?a.typer.invoke("insertLineBreak"):a.typer.invoke("insertLine")},commands:{justifyCenter:n,justifyFull:n,justifyLeft:n,justifyRight:n,formatting:function(b,d){var e=/^([a-z\d]*)(?:\.(.+))?/i.exec(d)||[];"ol"===e[1]||"ul"===e[1]?b.insertWidget("list","ol"===e[1]&&"1"):a(b.selection.getParagraphElements()).not("li").each(function(a,b){e[1]&&!c.is(b,e[1])&&i(e[1],b.tagName)?l(b,j(e[1]||"p",e[2])):b.className=e[2]||""})},insertLine:function(a){a.insertText("\n\n")},insertLineBefore:function(a){var b=a.selection.focusNode.widget;"__root__"!==b.id&&(a.selection.select(b.element,!0),a.insertText("\n\n"))}}},c.widgets.lineBreak={enter:function(a){a.typer.invoke("insertLineBreak")},shiftEnter:function(a){a.typer.invoke("insertLineBreak")},commands:{insertLineBreak:function(a){a.insertHtml("<br>")}}},c.widgets.list={element:"ul,ol",editable:"ul,ol",textFlow:!0,create:p,remove:function(a){r(a,a.widget.element.children)},extract:function(a){},receive:function(a){c.sameElementSpec(a.widget.element,a.receivedNode)&&(a.preventDefault(),a.typer.invoke(function(b){b.insertHtml(a.receivedNode.childNodes)}))},tab:function(a){a.typer.invoke("indent")},shiftTab:function(a){a.typer.invoke("outdent")},init:function(b){a(b.widget.element).filter("ol").attr("type-css-value",y[a(b.widget.element).attr("type")]||"decimal"),a(b.widget.element).parent("li")[0]&&!b.widget.element.previousSibling&&a(c.createTextNode()).insertBefore(b.widget.element)},contentChange:function(b){a(b.widget.element).children("li")[0]||b.typer.invoke(function(c){a(b.widget.element).remove()})},commands:{indent:q,outdent:r}},a.each("formatting list inlineStyle lineBreak".split(" "),function(a,b){c.defaultOptions[b]=!0}),c.ui.addControls("typer:toolbar",{formatting:c.ui.group("* -inlineStyleOptions -inlineStyleClear",{requireTyper:!0,defaultNS:"typer:formatting"})}),c.ui.addControls("typer:formatting",{paragraph:c.ui.dropdown({requireWidget:"formatting",requireCommand:"formatting",hiddenWhenDisabled:!0,controls:function(b){var e=a.map(d.keys(b.options.formattings||{}),function(a){return c.ui.button({hiddenWhenDisabled:!0,value:a,label:b.options.formattings[a],enabled:function(a,b){var c=a.typer.getSelection(),d=(c.startNode===c.endNode?c.startNode:c.focusNode).element;return!z.test(b.value)||i(d.tagName,k.$1)}})}),f=c.ui.button({requireWidget:"formatting",hiddenWhenDisabled:!0,enabled:function(a,b){for(var c=0,d=e.length;c<d;c++)if(e[c].value===b.widget.formatting)return!1;return b.label="typer:formatting:tagname:"+(z.exec(b.widget.formatting)||[])[1],b.value=b.widget.formatting,!0}});return e.concat(f)},execute:"formatting",enabled:function(a){return s(a,!1)},stateChange:function(a,b){for(var c=0,d=b.controls.length;c<d;c++)if(b.controls[c].value===b.widget.formattingWithClassName)return void(b.value=b.widget.formattingWithClassName);b.value=b.widget.formatting}}),inlineStyle:c.ui.dropdown({allowEmpty:!0,requireWidget:"inlineStyle",requireCommand:"applyClass",hiddenWhenDisabled:!0,defaultNS:"typer:formatting",controls:"inlineStyleOptions inlineStyleClear",execute:"applyClass",enabled:function(a){return s(a,!0)},stateChange:function(a,b){b.value=b.widget.inlineClass}}),inlineStyleOptions:c.ui.group({controls:function(b){return a.map(d.keys(b.options.inlineClass||{}),function(a){return c.ui.button({value:a,label:b.options.inlineClass[a]})})}}),inlineStyleClear:c.ui.button({dropdownOption:"exclude",requireWidget:"inlineStyle",execute:"applyClass"}),bold:t("bold","inlineStyle"),italic:t("italic","inlineStyle"),underline:t("underline","inlineStyle"),strikeThrough:t("strikeThrough","inlineStyle"),unorderedList:c.ui.button({requireWidgetEnabled:"list",execute:function(a,b,c){c.insertWidget("list","")},active:function(a,b){return b.widget&&c.is(b.widget.element,"ul")},enabled:function(a){return s(a,!1)&&a.typer.getSelection().widgetAllowed("list")}}),orderedList:c.ui.callout({requireWidgetEnabled:"list",controls:[u("1","1, 2, 3, 4"),u("a","a, b, c, d"),u("A","A, B, C, D"),u("i","i, ii, iii, iv"),u("I","I, II, III, IV")],active:function(a,b){return b.widget&&c.is(b.widget.element,"ol")},enabled:function(a){return s(a,!1)&&a.typer.getSelection().widgetAllowed("list")}}),indent:t("indent","list"),outdent:t("outdent","list"),justifyLeft:t("justifyLeft","formatting"),justifyCenter:t("justifyCenter","formatting"),justifyRight:t("justifyRight","formatting"),justifyFull:t("justifyFull","formatting")}),c.ui.addLabels("en","typer:formatting",{bold:"Bold",italic:"Italic",underline:"Underlined",strikeThrough:"Strikethrough",unorderedList:"Bullet list",orderedList:"Numbered list",indent:"Indent",outdent:"Outdent",justifyLeft:"Align left",justifyCenter:"Align center",justifyRight:"Align right",justifyFull:"Align justified",paragraph:"Formatting",inlineStyle:"Text style",inlineStyleClear:"Clear style"}),c.ui.addLabels("en","typer:formatting:orderedList",{decimal:"Decimal numbers","lower-alpha":"Alphabetically ordered list, lowercase","upper-alpha":"Alphabetically ordered list, uppercase","lower-roman":"Roman numbers, lowercase","upper-roman":"Roman numbers, uppercase"}),c.ui.addLabels("en","typer:formatting:tagname",{p:"Paragraph",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6",table:"Table",td:"Table cell",th:"Table header",ul:"Unordered list",ol:"Ordered list",li:"List item",blockquote:"Blockquote"}),c.ui.addIcons("material","typer:formatting",{bold:"",italic:"",underline:"",strikeThrough:"",unorderedList:"",orderedList:"",indent:"",outdent:"",justifyLeft:"",justifyCenter:"",justifyRight:"",justifyFull:""}),c.ui.setShortcut({bold:"ctrlB",italic:"ctrlI",underline:"ctrlU",justifyLeft:"ctrlShiftL",justifyCenter:"ctrlShiftE",justifyRight:"ctrlShiftR",insertLineBefore:"ctrlEnter"}),c.ui.addHook("tab",function(a){!a.isDefaultPrevented()&&a.typer.widgetEnabled("list")&&(a.typer.invoke(q),a.preventDefault())})}(a,Typer),function(a,d){function e(a){var b=c.createElement("A");return b.href=a||"",location.protocol===b.protocol&&location.hostname===b.hostname&&(location.port===b.port||""===location.port&&b.port===("https:"===location.protocol?"443":"80"))?b.pathname.replace(/^(?!\/)/,"/")+b.search+b.hash:a}d.widgets.link={element:"a[href]",inline:!0,create:function(b,c){c=e(c),"link"===b.selection.focusNode.widget.id?b.invoke("setURL",c):b.insertHtml(a("<a>").text(b.selection.getSelectedText()||c).attr("href",c)[0])},remove:"keepText",init:function(b){a(b.widget.element).css("cursor","text")},ctrlClick:function(a){b.open(a.widget.element.href)},commands:{setURL:function(a,b){a.widget.element.href=e(b)},unlink:function(a){a.removeWidget(a.widget)}}},d.defaultOptions.link=!0,d.ui.addControls("typer",{"toolbar:link":d.ui.button({after:"insert",requireWidgetEnabled:"link",hiddenWhenDisabled:!0,dialog:function(b,c){var e=c.widget||b.typer.getSelection().getSelectedText(),f={href:c.widget?a(c.widget.element).attr("href"):/^[a-z]+:\/\//g.test(e)?e:"",text:c.widget?a(c.widget.element).text():e,blank:!!c.widget&&"_blank"===a(c.widget.element).attr("target")};return"function"==typeof b.options.selectLink?b.options.selectLink(f):d.ui("typer:link:selectLink",{"typer:link:selectLink":f}).execute()},execute:function(b,c,d,e){if(!e)return null;var f,g=e.href||e,h=e.text||g;c.widget?f=c.widget.element:(f=a('<a href="">').text(h)[0],d.insertHtml(f),d.selection.select(f,"contents")),a(f).text(h),d.typer.invoke("setURL",g),e.blank?a(f).attr("target","_blank"):a(f).removeAttr("target")},active:function(a,b){return!!a.is("toolbar")&&b.widget},visible:function(a,b){return a.is("toolbar")||!!b.widget},stateChange:function(a,b){b.label=b.widget?"typer:toolbar:link:edit":"typer:toolbar:link"}}),"contextmenu:link":d.ui.group("typer:toolbar:link typer:link:*(type:button)"),"link:open":d.ui.button({requireWidget:"link",hiddenWhenDisabled:!0,shortcut:"ctrlClick",execute:function(a,c){b.open(c.widget.element.href)}}),"link:unlink":d.ui.button({hiddenWhenDisabled:!0,requireWidget:"link",execute:"unlink"}),"link:selectLink:text":d.ui.textbox({presetOptions:{required:!0}}),"link:selectLink:url":d.ui.textbox({presetOptions:{required:!0}}),"link:selectLink:blank":d.ui.checkbox(),"link:selectLink:buttonset":d.ui.group("dialog:buttonOK dialog:buttonCancel remove","buttonset"),"link:selectLink:buttonset:remove":d.ui.button({hiddenWhenDisabled:!0,buttonsetGroup:"left",cssClass:"warn",enabled:function(a){return!!a.parentControl.widget}}),"link:selectLink":d.ui.dialog({controls:"*",valueMap:{text:"text",href:"url",blank:"blank"},setup:function(a,b,c,d){b.resolveOne("buttonset").resolveOne("remove").execute=function(){a.parentControl.widget.remove(),d()}}})}),d.ui.addLabels("en","typer",{"toolbar:link":"Insert hyperlink","toolbar:link:edit":"Edit hyperlink","link:url":"Link URL","link:blank":"Open in new window","link:open":"Open hyperlink","link:unlink":"Remove hyperlink","link:selectLink":"Create hyperlink","link:selectLink:text":"Text","link:selectLink:url":"URL","link:selectLink:blank":"Open in new window","link:selectLink:buttonset:remove":"Remove"}),d.ui.addIcons("material","typer",{"toolbar:link":"","link:url":""}),d.ui.addHook("space enter",function(a){if(a.typer.widgetEnabled("link")){var b=a.typer.getSelection().clone();if("enter"===a.data&&b.moveByCharacter(-1),b.getCaret("start").moveByWord(-1)&&"link"!==b.focusNode.widget.id&&/^([a-z]+:\/\/\S+)|(\S+@\S+\.\S+)/g.test(b.getSelectedText())){var c=k.$1||"mailto:"+k.$2;a.typer.invoke(function(d){"space"===a.data&&d.insertText(" ");var e=d.selection.clone();a.typer.snapshot(!0),a.typer.select(b),d.insertWidget("link",c),a.typer.select(e)}),a.preventDefault()}}})}(a,Typer),function(a,b){function c(a){return b.ui.button({requireWidgetEnabled:"media",dialog:function(c){return"function"==typeof c.options.selectMedia?c.options.selectMedia(a):b.ui.prompt("typer:media:selectImage")},execute:function(a,b,c,d){c.insertWidget("media",d)},enabled:function(a){return a.typer.getSelection().widgetAllowed("media")},visible:function(a){return a.typer.widgetEnabled("media")}})}var d=/\.(?:(jpg|jpeg|png|gif|webp)|(mp4|ogg|webm)|(mp3))(?:\?.*)?$/i;b.widgets.media={element:"img,audio,video,a:has(>img)",text:function(a){return a.element.src},create:function(c,e){var f=b.createElement(d.test(e.src||e)?k.$2?"video":k.$3?"audio":"img":"img");f.src=e.src||e,b.is(f,"video")&&a(f).attr("controls",""),c.insertHtml(f)}},b.defaultOptions.media=!0,b.ui.addControls("typer",{"widget:media":b.ui.group("typer:media:*"),"insert:image":c("image"),"insert:video":c("video"),"media:filePicker":b.ui.button({requireWidget:"media",stateChange:function(b,c){c.value=a(c.widget.element).attr("src"),c.label=(/(?:^|\/)([^\/?#]+)(?:\?.+)?$/.exec(c.value)||[])[1]||""},dialog:function(a,c){if("function"==typeof a.options.selectMedia){var e=d.exec(c.label)&&(k.$1?"image":k.$2?"video":"audio");return a.options.selectMedia(e,c.value)}return b.ui.prompt("dialog:selectImage",c.value)},execute:function(b,c,d,e){a(c.widget.element).attr("src",e.src||e)}}),"media:altText":b.ui.textbox({requireWidget:"media",hiddenWhenDisabled:!0,stateChange:function(b,c){c.value=a(c.widget.element).attr("alt")},execute:function(b,c,d){a(c.widget.element).attr("alt",c.value).attr("title",c.value)}})}),b.ui.addLabels("en","typer",{"insert:image":"Image","insert:video":"Video","media:altText":"Alternate text","media:selectImage":"Enter image URL"}),b.ui.addIcons("material","typer",{"insert:image":"","insert:video":"","media:altText":""})}(a,Typer),function(a,b){function c(b,c,d){a(b.typer.element).parents(b.options.target).addBack().eq(0).toggleClass(b.options[c],d)}b.widgets.stateclass={options:{target:null,focused:"focused",empty:"empty"},focusin:function(a){c(a.widget,"focused",!0)},focusout:function(a){c(a.widget,"focused",!1)},contentChange:function(a){c(a.widget,"empty",!a.typer.hasContent())},init:function(a){c(a.widget,"empty",!a.typer.hasContent())}}}(a,Typer),function(a,b){function c(a,b,c,d,e){var f=this;f.widget=a,f.element=a.element,f.minCol=c,f.minRow=b,f.maxCol=e,f.maxRow=d}function e(b){var d=b.focusNode.widget;if("table"===d.id){var e=a(b.startElement).parentsUntil(d.element).addBack(),f=a(b.endElement).parentsUntil(d.element).addBack();return new c(d,e.eq(1).index(),e.eq(2).index(),f.eq(1).index(),f.eq(2).index())}}function h(a,b){return new f(b+1).join(a)}function i(b){a(b).remove()}function j(b,c){return a(z,b.element||b)[c]}function k(a,b,c){return"string"==typeof b?k(a,g.min(a[b+"Row"],l(a)-1),g.min(a[b+"Col"],m(a)-1)):j(a,b).children[c]}function l(b){return a(z,b.element||b).length}function m(a){return j(a,0).childElementCount}function n(a){return!!b.is(k(a,0,0),"th")}function o(b,c,d){if(b.isSingleEditable){var e=a(b.focusNode.element)[c]()[0]||a(b.focusNode.element).parent()[c]().children(d)[0];e&&b.moveToText(e,-0)}}function p(b){a("td,th",b.element||b).css({outline:"1px dotted rgba(0,0,0,0.3)",minWidth:"3em"})}function q(a,b,d,e,f){a.typer.select(new c(a,b,d,b+e-1,d+f-1))}function r(b,c,d,e){var f="string"==typeof c?c+"-child":"nth-child("+(c+1)+")",g=e?"before":"after"
;a(b.element||b).find(z+">th:"+f)[g](h(x,d)),a(b.element||b).find(z+">td:"+f)[g](h(w,d)),p(b)}function s(b,c,d,e,f){a(j(b,"last"===c?l(b)-1:c))[f?"before":"after"](h(y.replace("%",h(e,m(b))),d)),p(b)}function t(b,c){var d=n(b);d&&!c?(a(">th",j(b,0)).wrapInner("<p>").each(function(b,c){a(c).replaceWith(a(w).append(c.childNodes))}),p(b)):d||!c&&void 0!==c||s(b,0,1,x,!0)}function u(c,d,e){for(var f=a(d?z+":first>*":z,c.element),g=f.length-1;g>=0;g--){var h=b.getRect(f[g]);if((d?h.left:h.top)<e)return g}return 0}var v,w="<td></td>",x="<th></th>",y="<tr>%</tr>",z=">tbody>tr";c.prototype={get numCol(){return g.abs(this.maxCol-this.minCol)+1},get numRow(){return g.abs(this.maxRow-this.minRow)+1},get mode(){return(this.numCol===m(this))+2*(this.numRow===l(this))},rows:function(b){a(z,this.element).splice(this.minRow,this.numRow).forEach(b)},cells:function(b){var c=this;c.rows(function(d,e){a(d.children).splice(c.minCol,c.numCol).forEach(function(a,c){b(a,e,c)})})},getRange:function(){return b.createRange(k(this,"min"),0,k(this,"max"),-0)},acceptNode:function(a){var c=!1;return a.element===this.element?1:(this.cells(function(d){c|=b.containsOrEquals(d,a.element)}),c||2)},remove:function(a){var b=this;1===a?b.rows(i):2===a&&b.cells(i),b.widget.typer.select(k(b,"min"),-0)}},b.widgets.table={element:"table",editable:"th,td",create:function(a,b){b=b||{},a.insertHtml("<table>"+h(y.replace("%",h(w,b.columns||2)),b.rows||2)+"</table>")},init:function(b){a(b.widget.element).removeAttr("x-table-copymode"),p(b.widget)},extract:function(b){var c=b.widget.element,d=b.extractedNode;if(v&&v.widget===b.widget){var e=v.mode;1!==e&&2!==e||(a(d).attr("x-table-copymode",e),"paste"!==b.source&&"cut"!==b.source||v.remove(e))}else if(l(d)>1){var f=m(c);a(z,d).each(function(b,c){c.childElementCount<f&&a(h(a(">th",c)[0]?x:w,f-c.childElementCount))[b?"appendTo":"prependTo"](c)})}},receive:function(b){var c=+a(b.receivedNode).attr("x-table-copymode");if(c||"paste"===b.source){var d=b.typer.getSelection(),f=v&&v.widget===b.widget?v:e(d),h=b.widget.element,i=b.receivedNode,o=n(h);t(i,1!==c&&(2===c?o:0===f.minRow&&o));var u=l(i),x=m(i),y=l(h),A=m(h),B=1===c?f.minRow===y:f.minCol===A;2===c?(s(u>y?h:i,"last",g.abs(u-y),w,!1),a(z,i).each(function(b,c){a(c.children)[B?"insertAfter":"insertBefore"](k(h,b,f.minCol-B))}),q(b.widget,0,f.minCol,l(h),x)):1===c?(0===f.minRow&&o&&f.minRow++,r(x>A?h:i,"last",g.abs(x-A),!1),a(z,i)[B?"insertAfter":"insertBefore"](j(h,f.minRow-B)),q(b.widget,f.minRow,0,u,m(h))):(1===f.numRow&&1===f.numCol&&(f.maxCol=f.minCol+x-1,f.maxRow=f.minRow+u-1,f.maxRow>y-1&&s(h,"last",f.maxRow-y+1,w,!1),f.maxCol>A-1&&r(h,"last",f.maxCol-A+1,!1)),f.cells(function(b,c,d){a(b).replaceWith(k(i,c%u,d%x).cloneNode(!0))}),d.select(f)),p(h),b.preventDefault()}},tab:function(a){o(a.typer.getSelection(),"next",":first-child")},shiftTab:function(a){o(a.typer.getSelection(),"prev",":last-child")},keystroke:function(a){if(v&&v.widget===a.widget&&("backspace"===a.data||"delete"===a.data)){var b=v.mode;1!==b&&2!==b||(a.preventDefault(),v.remove(b))}},commands:{addColumnBefore:function(a){var b=e(a.selection);r(a.widget,b.minCol,b.numCol,!0)},addColumnAfter:function(a){var b=e(a.selection);r(a.widget,b.maxCol,b.numCol,!1)},addRowAbove:function(a){var b=e(a.selection);s(a.widget,b.minRow,b.numRow,w,!0)},addRowBelow:function(a){var b=e(a.selection);s(a.widget,b.maxRow,b.numRow,w,!1)},removeColumn:function(a){e(a.selection).remove(2)},removeRow:function(a){e(a.selection).remove(1)},toggleTableHeader:function(b){t(b.widget),a(">th",j(b.widget,0)).text(function(a,b){return b||"Column "+(a+1)})}}},b.ui.define("tableGrid",{type:"tableGrid"}),a.extend(b.ui.themeExtensions,{tableGrid:'<div class="typer-ui-grid"><div class="typer-ui-grid-wrapper"></div><br x:t="label"/></div>',tableGridInit:function(b,c){var d=a(c.element);d.find(".typer-ui-grid-wrapper").append(h('<div class="typer-ui-grid-row">'+h('<div class="typer-ui-grid-cell"></div>',7)+"</div>",7)),d.find(".typer-ui-grid-cell").mouseover(function(){c.value.rows=a(this).parent().index()+1,c.value.columns=a(this).index()+1,c.label=c.value.rows+" × "+c.value.columns,d.find(".typer-ui-grid-cell").removeClass("active"),d.find(".typer-ui-grid-row:lt("+c.value.rows+")").find(".typer-ui-grid-cell:nth-child("+c.value.columns+")").prevAll().addBack().addClass("active")}),c.label="0 × 0",c.value={},d.click(function(){b.execute(c)})}}),b.ui.addControls("typer",{"insert:table":b.ui.callout({requireWidgetEnabled:"table",enabled:function(a){return a.typer.getSelection().widgetAllowed("table")},visible:function(a){return a.typer.widgetEnabled("table")}}),"insert:table:create":b.ui.tableGrid({execute:function(a,b,c){c.insertWidget("table",b.value)}}),"contextmenu:table":b.ui.callout({requireWidget:"table",hiddenWhenDisabled:!0,defaultNS:"typer:table"}),"table:toggleTableHeader":b.ui.checkbox({requireWidget:"table",execute:"toggleTableHeader",stateChange:function(b,c){c.value=!!a(c.widget.element).find("th")[0]}}),"table:style":b.ui.dropdown({requireWidget:"table",controls:function(c,e){var f=a.map(d.keys(c.options.tableStyles||{}),function(a){return b.ui.button({value:a,label:c.options.tableStyles[a]})}),g=b.ui.button({value:"",label:"typer:table:styleDefault"});return f.concat(g)},execute:function(a,b,c){b.widget.element.className=b.value||""},stateChange:function(a,b){b.value=b.widget.element.className||"",b.selectedText=b.label}}),"table:tableWidth":b.ui.dropdown({requireWidget:"table",execute:function(b,c,d){c.value?a(c.widget.element).attr("width","100%"):a(c.widget.element).removeAttr("width")},stateChange:function(b,c){c.value=a(c.widget.element).attr("width")||"",c.selectedText=c.label}}),"table:tableWidth:fitContent":b.ui.button({value:""}),"table:tableWidth:fullWidth":b.ui.button({value:"100%"}),"table:addRemoveCell":b.ui.group(),"table:addRemoveCell:addColumnBefore":b.ui.button({requireWidget:"table",execute:"addColumnBefore"}),"table:addRemoveCell:addColumnAfter":b.ui.button({requireWidget:"table",execute:"addColumnAfter"}),"table:addRemoveCell:addRowAbove":b.ui.button({requireWidget:"table",execute:"addRowAbove",enabled:function(a,b){return!n(b.widget)||e(a.typer.getSelection()).minRow>0}}),"table:addRemoveCell:addRowBelow":b.ui.button({requireWidget:"table",execute:"addRowBelow"}),"table:addRemoveCell:removeColumn":b.ui.button({requireWidget:"table",execute:"removeColumn"}),"table:addRemoveCell:removeRow":b.ui.button({requireWidget:"table",execute:"removeRow"})}),b.ui.addLabels("en","typer",{"insert:table":"Table","contextmenu:table":"Modify table","table:toggleTableHeader":"Show header","table:style":"Table style","table:styleDefault":"Default","table:addRemoveCell:addColumnBefore":"Add column before","table:addRemoveCell:addColumnAfter":"Add column after","table:addRemoveCell:addRowAbove":"Add row above","table:addRemoveCell:addRowBelow":"Add row below","table:addRemoveCell:removeColumn":"Remove column","table:addRemoveCell:removeRow":"Remove row","table:tableWidth":"Table width","table:tableWidth:fitContent":"Fit to content","table:tableWidth:fullWidth":"Full width"});var A,B=b.canvas.handle("cell"),C=b.canvas.handle("cell");b.canvas.addLayer("table",function(a){var d=a.hoverNode&&a.hoverNode.widget;if(d&&"table"===d.id){var f=b.getRect(d);a.drawLine(f.left,f.top,f.right,f.top,10,"transparent","solid",B),a.drawLine(f.left,f.top,f.left,f.bottom,10,"transparent","solid",C)}var h=a.typer.getSelection(),i=a.activeHandle;if(i===B||i===C){var j=i===B,n=u(A?v:d,j,j?a.pointerX:a.pointerY);A||(v=new c(d,0,0,l(d)-1,m(d)-1),v[j?"minCol":"minRow"]=n),v[j?"maxCol":"maxRow"]=n,A=!0}else a.selectionChanged&&(v=e(h),!v||1===v.numRow&&1===v.numCol?(v=null,A=!1):A=!0);if(A&&!a.mousedown&&(A=!1,3===v.mode?(h.select(v.element),v=null):q(v.widget,g.min(v.minRow,v.maxRow),g.min(v.minCol,v.maxCol),v.numRow,v.numCol)),v){var o=k(v,"min"),p=k(v,"max");a.fill(b.mergeRect(b.getRect(o),b.getRect(p)))}a.toggleLayer("selection",!v)})}(a,Typer),function(a,d){function e(b){if(!1===e.value)b();else if(!e.value){var d=function(){e.value=!0};a(c).one("paste",d),m(function(){a(c).off("paste",d),e.value||(e.value=!1,b())})}}function f(b,c){var e=a(b.element).height();if(c)b.position="fixed";else if("fixed"!==b.position){var f=d.getRect(b.widget||b.typer);if(0===f.left&&0===f.top&&0===f.width&&0===f.height)return;c={position:"fixed",left:f.left,top:g.max(0,f.top-e-10)}}if(c){var h=b.typer.getSelection().extendCaret.getRect();h.top>=c.top&&h.top<=c.top+e&&(c.top=h.bottom+10),a(b.element).css(c)}}function h(b,e){b.update(),!b.widget&&b.options.container||(k!==b&&(i(),k=b,a(b.element).appendTo(c.body),d.ui.setZIndex(b.element,b.typer.element)),f(b,e))}function i(b){!k||b&&k.typer!==b||(a(k.element).detach(),k.position="",k=null)}function j(b,e,f,g){var i=d.ui({type:g||"toolbar",typer:b,widget:f||null,theme:e.theme,defaultNS:"typer",controls:"contextmenu"===g?"contextmenu":f?"widget":"toolbar",options:e,showButtonLabel:"contextmenu"===g,executed:function(a,b){b.is("textbox")||a.typer.getSelection().focus()}}),j=a(i.element);return e.container?j.appendTo(e.container):(j.addClass("typer-ui-float"),j.mousedown(function(b){var d=j.position();if(b.target===i.element){var e=function(a){h(i,{top:d.top+(a.clientY-b.clientY),left:d.left+(a.clientX-b.clientX)})};a(c.body).mousemove(e),a(c.body).mouseup(function(){a(c.body).off("mousemove",e)})}})),"contextmenu"===g&&(a(b.element).on("contextmenu",function(a){a.preventDefault(),i.update(),i.show({x:a.clientX,y:a.clientY}),m(function(){i.element.focus()})}),a(b.element).on("click",function(a){1===a.which&&i.hide()})),i}var k;d.widgets.toolbar={inline:!0,options:{container:"",theme:"material",formattings:{p:"Paragraph",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4"},inlineClasses:{}},init:function(a){a.widget.toolbar=j(a.typer,a.widget.options),a.widget.contextmenu=j(a.typer,a.widget.options,null,"contextmenu"),a.widget.toolbars={}},focusin:function(a){h(a.widget.toolbar)},focusout:function(a){i(a.typer)},stateChange:function(a){if(k&&k.typer===a.typer){var b=a.widget.toolbar,c=a.typer.getSelection(),e=c.focusNode.widget;"__root__"!==e.id&&c.focusNode.element===e.element&&d.ui.controls["typer:widget:"+e.id]&&(b=a.widget.toolbars[e.id]||(a.widget.toolbars[e.id]=j(a.typer,a.widget.options,e)),b.widget=e),h(b)}}},a(b).scroll(function(){k&&f(k)}),d.ui.addControls("typer",{contextmenu:d.ui.group("history selection clipboard insert *"),"contextmenu:history":d.ui.group("typer:history:* *"),"contextmenu:selection":d.ui.group("typer:selection:* *"),"contextmenu:clipboard":d.ui.group("typer:clipboard:* *"),"contextmenu:insert":d.ui.group("typer:toolbar:insert *"),toolbar:d.ui.group(),"toolbar:insert":d.ui.callout({before:"*",controls:"typer:insert:*",requireChildControls:!0}),widget:d.ui.group({requireWidget:!0,controls:function(a,b){return a.widget.id+" delete"}}),"history:undo":d.ui.button({before:"*",shortcut:"ctrlZ",execute:function(a){a.typer.undo()},enabled:function(a){return a.typer.canUndo()}}),"history:redo":d.ui.button({before:"*",shortcut:"ctrlShiftZ",execute:function(a){a.typer.redo()},enabled:function(a){return a.typer.canRedo()}}),"widget:delete":d.ui.button({after:"*",requireWidget:!0,execute:function(a){a.widget.remove()}}),"selection:selectAll":d.ui.button({before:"*",shortcut:"ctrlA",execute:function(a){var b=a.typer.getSelection();b.selectAll(),b.focus()}}),"selection:selectParagraph":d.ui.button({before:"*",hiddenWhenDisabled:!0,execute:function(a){var b=a.typer.getSelection();b.select(b.startNode.element,"contents"),b.focus()},enabled:function(a){return a.typer.getSelection().isCaret}}),"clipboard:cut":d.ui.button({before:"*",shortcut:"ctrlX",execute:function(a){a.typer.getSelection().focus(),c.execCommand("cut")}}),"clipboard:copy":d.ui.button({before:"*",shortcut:"ctrlC",execute:function(a){a.typer.getSelection().focus(),c.execCommand("copy")}}),"clipboard:paste":d.ui.button({before:"*",shortcut:"ctrlV",execute:function(a){a.typer.getSelection().focus(),c.execCommand("paste"),e(function(){d.ui.alert("typer:clipboard:inaccessible")})}})}),d.ui.addLabels("en","typer",{"toolbar:insert":"Insert widget","history:undo":"Undo","history:redo":"Redo","selection:selectAll":"Select all","selection:selectParagraph":"Select paragraph","clipboard:cut":"Cut","clipboard:copy":"Copy","clipboard:paste":"Paste","clipboard:inaccessible":"Unable to access clipboard due to browser security. Please use Ctrl+V or [Paste] from browser's menu.","widget:delete":"Delete"}),d.ui.addIcons("material","typer",{"toolbar:insert":"","history:undo":"","history:redo":"","selection:selectAll":"","clipboard:cut":"","clipboard:copy":"","clipboard:paste":"","widget:delete":""})}(a,Typer),function(a,b){b.widgets.validation={init:function(a){var b=a.widget.options;b.invalidChars&&(b.invalidCharsRegex=new k("["+b.invalidChars.replace(/[\[\]\\^]/g,"\\$&")+"]","g")),b.allowChars&&(b.invalidCharsRegex=new k("[^"+b.allowChars.replace(/[\[\]\\^]/g,"\\$&")+"]","g"))},textInput:function(a){var b=a.widget.options,c=a.data;if(b.invalidCharsRegex){c=c.replace(b.invalidCharsRegex,"")}if(b.maxlength){var d=b.maxlength-a.typer.extractText().length;c.length>d&&(c=c.substr(0,d))}c!==a.data&&(a.preventDefault(),c&&a.typer.invoke(function(a){a.insertText(c)}))}}}(0,Typer),function(a,b,d){function e(a){return a.getFullYear()}function h(a){return a.getMonth()}function i(a){return a.getDate()}function j(a){return a.getHours()}function l(a){return a.getMinutes()}function o(a,b){return new f(b+1).join(a)}function p(a,b){return e(a)===e(b)&&h(a)===h(b)}function q(a){return"string"==typeof a&&/^today|([+-]\d+)(day|week|month|year)?$/g.test(a)?k.$1?t(k.$2||"day",new d,+k.$1):new d:(a=null===a?void 0:a instanceof d?a:new d(a),isNaN(a)?void 0:a)}function r(a,b){var c=new d;return c.setHours(a,b,0,0),c}function s(a,b){var c=q(a.min),e=q(a.max);switch(b=new d(+(b<c?c:b>e?e:b)),a.mode||a){case"week":b.setDate(i(b)-b.getDay());break;case"month":b.setDate(1)}return"datetime"!==(a.mode||a)?b.setHours(0,0,0,0):b.setSeconds(0,0),b}function t(a,b,c,f){switch(a){case"minute":var j=c/g.abs(c);return new d(+b+6e4*(((j>0?f:0)-l(b)%f||f*j)+f*(c-j)));case"day":return new d(+b+y*c);case"week":return new d(+b+7*y*c);case"month":return new d(e(b),h(b)+c,i(b));case"year":return new d(e(b)+c,h(b),i(b))}}function u(a,b){switch(a){case"month":return z[h(b)]+" "+e(b);case"week":var c=t("day",b,6);return z[h(b)]+" "+i(b)+" - "+(h(c)!==h(b)?z[h(c)]+" ":"")+i(c)+", "+e(b)}var d=z[h(b)]+" "+i(b)+", "+e(b);return"datetime"===a?d+" "+(j(b)||12)+":"+("0"+l(b)).slice(-2)+" "+(j(b)>=12?"PM":"AM"):d}function v(){x=b.ui({type:"contextmenu",controls:[b.ui.datepicker()],executed:function(a,b){w&&b.is("calendar clock")&&(w.setValue(a.getValue()),b.is("calendar")&&a.hide())}})}var w,x,y=864e5,z="January February March April May June July August September October November December".split(" "),A="Su Mo Tu We Th Fr Sa".split(" ");b.ui.define("calendar",{type:"calendar",defaultNS:"calendar",controls:"*",showButtonLabel:!1,mode:"day",min:null,max:null,get value(){return s(this,this.selectedDate)},set value(a){this.selectedDate=s(this,a),this.ui.trigger(this,"showMonth",this.selectedDate)},init:function(c,f){var g=a("table",f.element);a(o("<tr></tr>",7)).appendTo(g),a(o("<th></th>",7)).appendTo(g.find("tr:first")),a(o("<td></td>",7)).appendTo(g.find("tr+tr")),a("<button>").appendTo(g.find("td")),g.find("th").text(function(a){return A[a]}),g.on("mousewheel",function(a){c.trigger(f,"showMonth",b.ui.getWheelDelta(a)),a.preventDefault()}),g.find("td").click(function(){var b=a(this).hasClass("prev")?-1:a(this).hasClass("next")?1:0;c.execute(f,new d(e(f.currentMonth),h(f.currentMonth)+b,+this.textContent))})},stateChange:function(a,b){a.trigger(b,"showMonth",b.currentMonth||b.value||new d)},showMonth:function(b,c,f){if(!isNaN(+f)){"number"==typeof f&&(f=t("month",c.currentMonth,f));var g=q(c.min),j=q(c.max),k=s({mode:"month",min:g,max:j},f),l=k.getDay(),m=a("td",c.element).removeClass("selected disabled");if(!c.currentMonth||!p(k,c.currentMonth)){var n=e(k),o=h(k),r=new d(n,o+1,0).getDate(),u=new d(n,o,0).getDate();m.removeClass("prev cur next today"),m.each(function(b,c){b<l?a(c).children().text(b+1-l+u).end().addClass("prev"):b>=r+l?a(c).children().text(b+1-l-r).end().addClass("next"):a(c).children().text(b+1-l).end().addClass("cur")});var v=new d;p(k,v)&&m.eq(i(v)+l-1).addClass("today"),a("tr:last",c.element).toggle(l+r>35);var w=b.resolveOne("year"),x=b.resolveOne("month");a.each(w.controls,function(a,b){b.label=b.value=n+a-5}),w.value=n,x.value=o,c.currentMonth=k}g&&p(k,g)&&m.slice(0,i(g)+l-1).addClass("disabled"),j&&p(k,j)&&m.slice(i(j)+l).addClass("disabled");var y=p(k,c.value);if(y||"week"===c.mode&&p(k,t("day",c.value,6)))switch(c.mode){case"day":m.eq(i(c.value)+l-1).addClass("selected");break;case"week":m.slice(y?i(c.value)+l-1:0).slice(0,7).addClass("selected");break;case"month":m.filter("td.cur").addClass("selected")}a(c.element).toggleClass("select-range","day"!==c.mode)}}}),b.ui.define("clock",{type:"clock",defaultNS:"clock",controls:"*",step:1,init:function(e,f){60%f.step>0&&(f.step=1);var h=a(".typer-ui-clock-face",f.element);a(o("<i></i>",12)).appendTo(h).each(function(b,c){a(c).css("transform","rotate("+30*b+"deg)")}),a("s",f.element).on("mousedown touchstart",function(d){var h=d.target,i=b.getRect(h.parentNode),k="touchstart"===d.type,m={};m[k?"touchmove":"mousemove"]=function(a){if(!k&&1!==a.which)return m.mouseup();var b=k?a.originalEvent.touches[0]:a,c=g.atan2(b.clientY-i.centerY,b.clientX-i.centerX)/g.PI,d=l(f.value),n=j(f.value);if("m"===h.getAttribute("hand")){var o=g.round((30*c+75)/f.step)*f.step%60;if(o!==d){var p=g.floor(g.abs(d-o)/30)*(o>d?-1:1);f.setValue(r(n+p,o))}}else{var q=g.round(6*c+15)%12+("am"===e.getValue("meridiem")?0:12);q!==n&&f.setValue(r(q,d))}},m[k?"touchend":"mouseup"]=function(){a(c.body).off(m),e.execute(f)},1!==d.which&&1!==(d.originalEvent.touches||"").length||a(c.body).on(m)});var i;a(f.element).on("mousewheel",function(a){f.setValue(t("minute",f.value,b.ui.getWheelDelta(a),f.step)),a.preventDefault(),n(i),i=m(function(){e.execute(f)})}),f.setValue(new d)},stateChange:function(b,c){var d=c.value;b.resolveOne("minute").presetOptions.step=c.step,b.setValue("hour",j(d)),b.setValue("minute",l(d)),b.setValue("meridiem",j(d)>=12?"pm":"am"),a('s[hand="h"]',c.element).css("transform","rotate("+(30*j(d)+.5*l(d)-90)+"deg)"),a('s[hand="m"]',c.element).css("transform","rotate("+(6*l(d)-90)+"deg)")}}),b.ui.define("datepicker",{renderAs:"buttonset",mode:"day",minuteStep:1,min:null,max:null,controls:[b.ui.calendar({name:"calendar"}),b.ui.clock({name:"clock",hiddenWhenDisabled:!0,enabled:function(a,b){return"datetime"===b.contextualParent.mode}})],get value(){var a=this.ui.getValue("calendar");if(this.ui.enabled("clock")){var b=this.ui.getValue("clock");a.setHours(j(b),l(b),0,0)}return a},set value(a){a=new d("string"==typeof a?a:+a),isNaN(+a)&&(a=new d),this.ui.setValue("calendar",a),this.ui.setValue("clock",a)},stateChange:function(a,b){a.set("calendar",{mode:"datetime"===b.mode?"day":b.mode,min:b.min,max:b.max}),a.set("clock","step",b.minuteStep)}}),b.ui.addControls("calendar",{year:b.ui.dropdown({controls:function(){for(var a=[],c=0;c<11;c++)a[c]=b.ui.button();return a},execute:function(a,b){a.trigger(b.contextualParent,"showMonth",new d(b.value,h(b.contextualParent.currentMonth)))}}),month:b.ui.dropdown({execute:function(a,b){a.trigger(b.contextualParent,"showMonth",new d(e(b.contextualParent.currentMonth),b.value))}}),prev:b.ui.button({buttonsetGroup:"right",execute:function(a,b){a.trigger(b.contextualParent,"showMonth",-1)}}),today:b.ui.button({buttonsetGroup:"right",execute:function(a,b){a.setValue(b.contextualParent,new d)}}),next:b.ui.button({buttonsetGroup:"right",execute:function(a,b){a.trigger(b.contextualParent,"showMonth",1)}})}),b.ui.addControls("clock",{hour:b.ui.textbox({preset:"number",presetOptions:{min:0,max:23,loop:!0},execute:function(a,b){a.execute(b.contextualParent,r(b.value,a.getValue("clock:minute")))}}),timeSeperator:b.ui.label({value:":"}),minute:b.ui.textbox({preset:"number",presetOptions:{min:0,max:59,digits:"fixed",loop:!0},execute:function(a,b){a.execute(b.contextualParent,r(a.getValue("clock:hour"),b.value))}}),meridiem:b.ui.button({execute:function(a,b){a.setValue(b,"am"===b.value?"pm":"am"),a.execute(b.contextualParent,r(a.getValue("clock:hour")%12+("am"===b.value?0:12),a.getValue("clock:minute")))},stateChange:function(a,b){b.label="clock:meridiem:"+b.value}})}),b.ui.addIcons("material","calendar",{today:"",prev:"",next:""}),b.ui.addLabels("en","calendar",{today:"Today",prev:"Previous month",next:"Next month"}),b.ui.addLabels("en","clock:meridiem",{am:"AM",pm:"PM"});for(var B={},C={},D=0;D<12;D++)B[z[D].toLowerCase()]=z[D],C[z[D].toLowerCase()]=b.ui.button({value:D});b.ui.addControls("calendar:month",C),b.ui.addLabels("en","calendar:month",B),a.extend(b.ui.themeExtensions,{calendar:'<div class="typer-ui-calendar"><div class="typer-ui-calendar-header"><br x:t="buttonset"/></div><div class="typer-ui-calendar-body"><table></table></div></div>',clock:'<div class="typer-ui-clock"><div class="typer-ui-clock-face"><s hand="h"></s><s hand="m"></s></div><br x:t="buttonset"/></div>',formatDate:null}),b.presets.datepicker={options:{mode:"day",minuteStep:1,min:null,max:null,required:!1,formatDate:null},overrides:{getValue:function(a){return a.selectedDate?s(a.options,a.selectedDate):null},setValue:function(c,e){c.selectedDate=e?s(c.options,e):null,c.softSelectedDate=null;var f="";if(e){var g=function(b){return a.isFunction(b)&&b(c.options.mode,e)};f=g(c.options.formatDate)||g(c.typer.parentControl&&b.ui.themes[c.typer.parentControl.ui.theme].formatDate)||g(u)}f!==this.extractText()&&(this.invoke(function(a){a.selection.selectAll(),a.insertText(f)}),this===w&&x.setValue(c.selectedDate||new d))},hasContent:function(a){return!!this.extractText()},validate:function(a,b){b(!a.options.required||!!a.selectedDate,"required")}},commands:{step:function(a,b){var c=a.widget.options,e=t("datetime"===c.mode?"minute":c.mode,a.typer.getValue()||new d,b,c.minuteStep);a.typer.setValue(e)}},contentChange:function(a){if(a.typer===w&&"script"!==a.source){var b=new d(a.typer.extractText());isNaN(+b)||x.setValue(s(a.widget.options,b)),a.widget.softSelectedDate=b}},click:function(a){a.typer===w&&x.show(a.typer.element)},mousewheel:function(a){a.typer.invoke("step",a.data),a.preventDefault()},upArrow:function(a){a.typer.invoke("step",-1)},downArrow:function(a){a.typer.invoke("step",1)},focusin:function(a){x||v(),x.retainFocus(a.typer),w=a.typer;var c=a.widget.options;x.set("(type:datepicker)",{mode:c.mode,minuteStep:c.minuteStep,min:c.min,max:c.max}),x.setValue(a.typer.getValue()||new d),x.show(a.typer.element),b.ui.isTouchDevice&&m(function(){a.typer===w&&x.focus()})},focusout:function(a){m(function(){a.typer===w&&(w=null,x.hide())}),a.typer===w&&a.widget.softSelectedDate&&a.typer.setValue(isNaN(+a.widget.softSelectedDate)?a.widget.selectedDate:a.widget.softSelectedDate)}}}(a,Typer,Date),function(a,b){function d(a){var b=c.createTextNode(a.replace(/\s/g," ")),d=c.createElement("div");return d.appendChild(b),d.innerHTML}function f(a,b){var c={};a.forEach(function(a){c[a]=!0}),b.forEach(function(a){delete c[a]});for(var d in c)return!0}function h(a,b){a=e(a||"");for(var c=[],f=a.toLowerCase(),g=0,h=-1,i=0;i<b.length;i++){var j=b.charAt(i).toLowerCase();if(" "!=j){if(-1==(g=f.indexOf(j,g)))return{firstIndex:1/0,consecutiveMatches:-1,formattedText:a};c[c.length]=g-h-1,h=g++}}var l=c[0],m=/^(0+)/.test(c.slice(0).sort().join(""))&&k.$1.length,n="";for(g=0,i=0;i<c.length;i++)n+=d(a.substr(g,c[i]))+"<b>"+d(a[g+c[i]])+"</b>",g+=c[i]+1;return n+=d(a.slice(g)),{firstIndex:l,consecutiveMatches:m,formattedText:n.replace(/<\/b><b>/g,"")}}function i(b,c,d){return b=b.filter(function(b){a.extend(b,h(b.displayText,c));var d=h(b.value,c);return b.firstIndex=g.min(b.firstIndex,d.firstIndex),b.consecutiveMatches=g.max(b.consecutiveMatches,d.consecutiveMatches),b.matches&&b.matches.forEach(function(a){var d=h(a,c);b.firstIndex=g.min(b.firstIndex,d.firstIndex),b.consecutiveMatches=g.max(b.consecutiveMatches,d.consecutiveMatches)}),b.firstIndex!==1/0}),b.sort(function(a,b){return b.consecutiveMatches-a.consecutiveMatches+(a.firstIndex-b.firstIndex)||a.value.localeCompare(b.value)}),b.slice(0,d)}function j(b){var c=b.typer.extractText(),e=b.options.suggestions||b.options.allowedValues||[];a.isFunction(e)&&(e=e(c)),a.when(e).done(function(e){e=e.map(function(a){return"string"==typeof a?{value:a,displayText:a}:a}),e.forEach(function(a){b.knownValues[a.value]=a.displayText});var f=b.typer.getValue();e=e.filter(function(a){return f.indexOf(a.value)<0}),e=i(e,c,b.options.suggestionCount),c&&b.options.allowFreeInput&&e.push({value:c,displayText:c,formattedText:"<i>"+d(c)+"</i>"}),b.suggestions=e;var g;g=e.length?"<button>"+e.map(function(a){return a.formattedText}).join("</button><button>")+"</button>":'<button class="disabled">No suggestions</button>',a(".typer-ui-buttonlist",b.callout.element).html(g)}),m(function(){b.typer.focused()&&b.callout.show(b.typer.element)})}function l(a,b){return(a.options.allowFreeInput||a.knownValues[b])&&a.options.validate(b)}b.presets.keyword={options:{required:!1,allowFreeInput:!0,allowedValues:null,suggestionCount:5,suggestions:!1,validate:function(){return!0}},overrides:{getValue:function(b){return a("span",this.element).map(function(b,c){return e(a(c).data("value"))}).get()},setValue:function(b,c){c=(a.isArray(c)?c:e(c).split(/\s+/)).filter(function(a){return a}),f(c,this.getValue())&&this.invoke(function(a){a.selection.select(a.typer.element,"contents"),a.insertText(""),c.forEach(function(b){a.typer.invoke("add",b)})})},hasContent:function(){return!(!a("span",this.element)[0]&&!this.extractText())},validate:function(b,c){c(!b.options.required||this.getValue().length,"required"),c(!a(".invalid",this.element)[0],"invalid-value")}},widgets:{tag:{element:"span",inline:!0,editable:"none",create:function(a,b){a.insertHtml('<span class="typer-ui-keyword" data-value="'+d(b.value)+'">'+d(b.displayText)+"<i>delete</i></span>")},click:function(a){a.target!==a.widget.element&&a.widget.remove()}}},commands:{add:function(c,d){if(d&&!(c.typer.getValue().indexOf(d.value||d)>=0)){"string"==typeof d&&(d={value:d,displayText:c.widget.knownValues[d]||d});var e=a("span:last",c.typer.element)[0];e?c.selection.select(e,!1):c.selection.select(c.typer.element,0),c.insertWidget("tag",d),e=a("span:last",c.typer.element)[0],c.selection.select(b.createRange(e,!1),b.createRange(c.typer.element,-0)),c.insertText(""),l(c.widget,d.value)||a(e).addClass("invalid")}}},init:function(c){c.typer.getSelection().moveToText(c.typer.element,-0),c.widget.knownValues={},c.widget.suggestions=[],c.widget.callout=b.ui({type:"contextmenu",typer:c.typer}),a(c.widget.callout.element).on("click","button",function(b){c.typer.invoke("add",c.widget.suggestions[a(this).index()]),c.typer.getSelection().focus(),j(c.widget)})},click:function(a){a.widget.selectedIndex=-1},focusin:function(a){j(a.widget)},focusout:function(a){a.widget.selectedIndex=-1,a.widget.callout.hide(),a.typer.invoke("add",a.typer.extractText())},upArrow:function(b){b.widget.selectedIndex>=0&&a("button",b.widget.callout.element).removeClass("active").eq(b.widget.selectedIndex--).prev().addClass("active")},downArrow:function(b){b.widget.selectedIndex<a("button",b.widget.callout.element).length-1&&a("button",b.widget.callout.element).removeClass("active").eq(++b.widget.selectedIndex).addClass("active")},enter:function(a){a.widget.selectedIndex>=0?(a.typer.invoke("add",a.widget.suggestions[a.widget.selectedIndex]),a.widget.selectedIndex=-1):a.typer.invoke("add",a.typer.extractText())},keystroke:function(b){"escape"===b.data&&a.contains(c.body,b.widget.callout)&&(b.widget.selectedIndex=-1,b.widget.callout.hide(),b.preventDefault())},contentChange:function(a){"script"!==a.source&&j(a.widget)}}}(a,Typer),function(a,b){b.presets.number={validation:{allowChars:"0-9"},options:{max:null,min:null,digits:"auto",step:1,loop:!1},overrides:{getValue:function(a){return parseInt(this.extractText())},setValue:function(a,b){b=+b||0;var c=a.options.min,d=a.options.max,g=a.options.loop&&null!==c&&null!==d;if(g&&b<c||!g&&null!==d&&b>d?b=d:(g&&b>d||!g&&null!==c&&b<c)&&(b=c),b=e(+b||0),"fixed"===a.options.digits){var h=e(+a.options.max||0).length;b=(new f(h+1).join("0")+b).substr(-h)}b!==this.extractText()&&this.invoke(function(a){a.selection.selectAll(),a.insertText(b)})},hasContent:function(){return!!this.extractText()},validate:function(a){return!0}},focusout:function(a){a.typer.setValue(a.typer.getValue()||0)},mousewheel:function(a){a.typer.setValue((a.typer.getValue()||0)-a.data*a.widget.options.step),a.preventDefault()},upArrow:function(a){a.typer.setValue((a.typer.getValue()||0)+a.widget.options.step)},downArrow:function(a){a.typer.setValue((a.typer.getValue()||0)-a.widget.options.step)},contentChange:function(a){"keyboard"!==a.source&&a.typer.setValue(a.typer.getValue()||0)}}}(0,Typer),function(a,b){b.presets.textbox={options:{required:!1},overrides:{getValue:function(a){return this.extractText()},setValue:function(a,b){b!==this.getValue()&&this.invoke(function(a){a.selection.select(this.element,"contents"),a.insertText(b)})},hasContent:function(){return!!this.getValue()},validate:function(a,b){b(!a.options.required||this.getValue(),"required")}},init:function(a){a.typer.getSelection().moveToText(a.typer.element,-0)}}}(0,Typer),function(a,d){function e(c){var e=a(".typer-ui-float",c)[0],f=d.getRect(e);f.bottom>a(b).height()?a(e).addClass("float-top"):f.top<0&&a(e).removeClass("float-top"),f.right>a(b).width()?a(e).addClass("float-left"):f.left<0&&a(e).removeClass("float-left")}function f(b,c){a(c||b.element).click(function(a){var c=b.getControl(a.target);c&&(c.is("checkbox")?b.execute(c,!c.value):c.is("button callout")&&b.execute(c))})}function h(b,c,e){var f=a(b).not("."+c).map(function(f,g){var h=a.Deferred(),i=function(b){a(g).hasClass(c)&&b.target===g&&(a(g).toggleClass(c,!d.ui.matchWSDelim(b.type,j)),a(g).off(k+" "+j,i),h.resolveWith(g))};return a(b).addClass(c).on(k+" "+j,i),h.promise().done(e)});return a.when.apply(null,f.get())}function i(b){b.callout=a(b.element).children(".typer-ui-float").detach().addClass("typer-ui typer-ui-material is-"+b.type)[0],f(b.ui,b.callout)}var j="animationend oanimationend webkitAnimationEnd",k="transitionend otransitionend webkitTransitionEnd";d.ui.themes.material=d.ui.theme({resources:["https://fonts.googleapis.com/css?family=Roboto:400,500,700","https://fonts.googleapis.com/icon?family=Material+Icons","https://cdn.rawgit.com/misonou/jquery-typer/master/css/jquery.typer.material.css"],controlActiveClass:"active",controlDisabledClass:"disabled",controlHiddenClass:"hidden",controlErrorClass:"error",iconset:"material",label:'<span class="typer-ui-label"><br x:t="labelIcon"/><br x:t="labelText"/></span>',labelText:function(a,b){return b.is("textbox")||!b.contextualParent.showButtonLabel&&a.getIcon(b)?"":'<span x:bind="(_:label)"></span>'},labelIcon:function(a,b){return b.contextualParent.is("dropdown")||b.is("checkbox")||!a.getIcon(b)?"":'<i class="material-icons" x:bind="(_:icon)"></i>'},buttonset:'<div class="typer-ui-buttonset"><br x:t="children(buttonsetGroup:left)"/><div class="typer-ui-buttonset-pad"></div><br x:t="children(buttonsetGroup:right)"/></div>',buttonlist:'<div class="typer-ui-buttonlist"><br x:t="children"/></div>',form:'<div class="typer-ui-form"><br x:t="children"/></div>',menupane:'<div class="typer-ui-float"><div class="typer-ui-buttonlist"><br x:t="children"/></div></div>',toolbar:'<div class="typer-ui-buttonset is-toolbar"><br x:t="children"/></div>',contextmenu:'<div class="typer-ui-float is-contextmenu anim-target"><div class="typer-ui-buttonlist"><br x:t="children"/></div></div>',group:'<div class="typer-ui-group"><br x:t="children"/></div>',
groupStateChange:function(b,c){m(function(){c.setState("sep-before",!!a(c.element).prevAll(":not(.hidden)")[0]),c.setState("sep-after",!!a(c.element).nextAll(":not(.hidden):first:not(.typer-ui-group)")[0])})},link:'<label class="has-clickeffect"><a x:bind="(href:value,title:label)"><br x:t="label"/><span class="typer-ui-label-annotation" role="shortcut" x:bind="(_:shortcut)"></span><span class="typer-ui-label-annotation" x:bind="(_:annotation)"></span></a></label>',button:'<button x:bind="(title:label)"><br x:t="label"/><span class="typer-ui-label-annotation" role="shortcut" x:bind="(_:shortcut)"></span><span class="typer-ui-label-annotation" x:bind="(_:annotation)"></span></button>',file:'<label class="has-clickeffect" x:bind="(title:label)"><input type="file"/><br x:t="label"/></label>',fileInit:function(b,d){a(d.element).find(":file").change(function(e){b.execute(d,e.target.files),m(function(){var b=c.createElement("form");b.appendChild(e.target),b.reset(),a(e.target).prependTo(d.element)})})},callout:'<label class="typer-ui-callout" x:bind="(title:label)"><br x:t="button"/><br x:t="menupane"/></label>',calloutInit:function(a,b){b.contextualParent.is("callout contextmenu")||i(b)},dropdown:'<label class="typer-ui-dropdown" x:bind="(title:label)"><button><span class="typer-ui-label"><br x:t="labelIcon"/><span x:bind="(_:selectedText)"></span></span></button><br x:t="menupane"/></button>',dropdownInit:function(a,b){b.contextualParent.is("callout contextmenu")||i(b)},checkbox:'<button class="typer-ui-checkbox" x:bind="(title:label)"><br x:t="label"/></button>',checkboxStateChange:function(a,b){b.setState("checked",!!b.value)},textboxInner:'<div class="typer-ui-textbox-inner"><div contenteditable spellcheck="false"></div><div class="typer-ui-textbox-placeholder" x:bind="(_:label)"></div><div class="typer-ui-textbox-error"></div></div>',textbox:'<label class="typer-ui-textbox" x:bind="(title:label)"><br x:t="label"/><div class="typer-ui-textbox-wrapper"><br x:t="textboxInner"/></div></label>',textboxElement:"[contenteditable]",textboxPresetOptions:{stateclass:{target:".typer-ui-textbox"}},dialog:'<div class="typer-ui-dialog-wrapper"><div class="typer-ui-dialog-pin"></div><div class="typer-ui-dialog"><div class="typer-ui-dialog-inner anim-target"><div class="typer-ui-form"><br x:t="children"></div></div></div></div>',dialogInit:function(a,b){var c=a.parentControl,e=b.pinnable&&c&&d.ui.matchWSDelim(c.pinDirection,"left right top bottom");b.setState("is-modal",!!b.modal),a.setState(b.resolveBy,"pin-active",!0),e&&(b.setState("pinned",e),c.setState("pin-active",!0))},dialogWaiting:function(a,b){b.setState("loading",!0)},dialogError:function(a,b){b.setState("loading",!1)},dialogDestroy:function(a,b){a.parentControl&&a.parentControl.setState("pin-active",!1)},showCallout:function(a,b){b.callout&&a.show(b,b.callout,b.element,"left bottom")},afterShow:function(c,e,f){if(e.is("dialog")){var g=c.parentControl,i=e.pinnable&&g&&d.ui.matchWSDelim(g.pinDirection,"left right top bottom"),j=a(e.element).find(".typer-ui-dialog")[0],k=a(e.element).find(".typer-ui-dialog-pin")[0];i?(d.ui.snap(j,g.element,i+" center"),d.ui.snap(k,g.element,i+" center inset")):d.ui.snap(j,b,"center inset")}return e.is("dialog contextmenu")&&h(a(".anim-target",f.element)[0]||f.element,"open")},beforeHide:function(b,c,d){return c.is("dialog contextmenu")&&h(a(".anim-target",d.element)[0]||d.element,"closing").done(function(){a(this).removeClass("open closing")})},executed:function(a,b){!b.is("textbox")&&(a.is("contextmenu")||b.contextualParent.is("callout dropdown")&&!1!==b.contextualParent.hideCalloutOnExecute)&&a.hide(a.is("contextmenu")?null:b.contextualParent)},init:function(a,b){f(a)}}),a(function(){var b=".typer-ui-material button:not(.typer-ui-checkbox), .typer-ui-material .has-clickeffect";a(c.body).on("mousedown",b,function(b){var c=d.getRect(b.currentTarget),e=a('<div class="typer-ui-clickeffect"><i></i></div>').appendTo(b.currentTarget),f=e.children().css({top:b.clientY-c.top,left:b.clientX-c.left}),h=g.pow(b.clientY-c.top,2)+g.pow(b.clientX-c.left,2),i=g.pow(b.clientY-c.top,2)+g.pow(b.clientX-c.right,2),j=g.pow(b.clientY-c.bottom,2)+g.pow(b.clientX-c.left,2),k=g.pow(b.clientY-c.bottom,2)+g.pow(b.clientX-c.right,2),n=.5+2*g.sqrt(g.max(h,i,j,k))/l(e.css("font-size"));m(function(){f.css("transform",f.css("transform")+" scale("+n+")").addClass("animate-in")}),e.css("border-radius",a(b.currentTarget).css("border-radius"))}),a(c.body).on("mouseup mouseleave",b,function(b){h(a(".typer-ui-clickeffect",b.currentTarget).children(),"animate-out",function(){a(this).parent().remove()})}),a(c.body).on("mouseover","label:has(>.typer-ui-float)",function(a){e(a.currentTarget)}),a(c.body).on("click",".typer-ui-dialog-wrapper",function(b){h(a(b.target).find(".typer-ui-dialog-inner"),"pop")})})}(a,Typer)}(jQuery,window,document,Object,String,Array,Math,Node,Range,DocumentFragment,RegExp,parseFloat,setTimeout,clearTimeout,new function(){this.MutationObserver=window.MutationObserver||function(){function a(a){this.records=[],this.handler=a}return a.prototype={observe:function(a,b){var c=this;$(a).on("DOMNodeInserted DOMNodeRemoved DOMAttrModified DOMCharacterDataModified",function(d){var e=d.type.charAt(7),f={};f.addedNodes=[],f.removedNodes=[],"M"===e?(f.type="attributes",f.target=d.target,f.attributeName=d.originalEvent.attrName):"a"===e?(f.type="characterData",f.target=d.originalEvent.target):(f.type="childList",f.target=d.target.parentNode,f["I"===e?"addedNodes":"removedNodes"][0]=d.target),b[f.type]&&(b.subtree||f.target===a)&&(c.records[c.records.length]=f,clearTimeout(c.timeout),c.timeout=setTimeout(function(){c.handler(c.takeRecords())}))})},takeRecords:function(){return this.records.splice(0)}},a}(),this.Set=window.Set||function(){function a(){this.items=[]}return a.prototype={get size(){return this.items.length},has:function(a){return this.items.indexOf(a)>=0},add:function(a){var b=this.items;return b.indexOf(a)<0&&b.push(a),this},delete:function(a){var b=this.items.indexOf(a);return b>=0&&this.items.splice(b,1),b>=0},forEach:function(a,b){var c=this;c.items.forEach(function(d){a.call(b,d,d,c)})},clear:function(){this.items.splice(0)}},a}(),this.WeakMap=window.WeakMap||function(){function a(){this.key="__WeakMap"+ ++b}var b=0;return a.prototype={get:function(a){return a&&a[this.key]},set:function(a,b){a[this.key]=b},has:function(a){return a&&this.key in a},delete:function(a){delete a[this.key]}},a}()});
//# sourceMappingURL=jquery.typer.min.js.map
