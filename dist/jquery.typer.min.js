/*! jQuery Typer Plugin v0.8.3 | https://github.com/misonou/jquery-typer | The MIT License (MIT) */

!function(a,b,c,d,f,g,h,i,j){"use strict";function k(a){C(a,k)&&Object.getOwnPropertyNames(a).filter(function(a){return!k.prototype.hasOwnProperty(a)}).forEach(function(b){this[b]=a[b]},this)}function l(a,b,c,d){this.typer=a,this.id=b,this.element=c||null,this.options=d||{}}function m(a,b,c){this.eventName=a,this.typer=b,this.widget=c||null}function n(a,b,c){this.childNodes=[],this.nodeType=a,this.element=b,this.widget=c}function o(a,b,c){this.whatToShow=b,this.filter=c||null,this.currentNode=a,this.root=a}function p(a,b,c){this.whatToShow=b,this.filter=c||null,this.typerNodeIterator=C(a,o)||new o(a,ra|ta|pa)}function q(a,b,c){clearTimeout(q[a.name]),q[a.name]=b&&setTimeout(b,c)}function r(b,c){a.each(c,function(a,c){Object.defineProperty(b,a,{enumerable:!0,configurable:!0,get:function(){return Object.defineProperty(this,a,{enumerable:!0,writable:!0,value:c.apply(this)}),this[a]}})})}function s(a,b,c){return j.slice.call(a||{},b||0,c)}function t(b,c){return a.isArray(b[c])?b[c]:s(b,c)}function u(b,c){var d,e=[0].concat(t(arguments,2));return a.each(b,function(a,b){return e[0]=b,d=c.apply(this,e)&&b,!d}),d}function v(a,b){var c=(b||a.currentNode).nodeType;return a.whatToShow&(C(a,o)?c:1<<c-1)?a.filter?(a.filter.acceptNode||a.filter).call(a.filter,b||a.currentNode):1:3}function w(a,b,c){a.currentNode=c||a.currentNode;var d=v(a);if(2!==d)for(1===d&&b&&b(a.currentNode);a.nextNode();b&&b(a.currentNode));}function x(b,c,d){var e=[];return w(b,j.push.bind(e),d),c?a.map(e,c):e}function y(a){return d(a||"").replace(/^[\s\u200b]+|[\s\u200b]+$/g,"")}function z(a){return a=d(a||""),a.charAt(0).toUpperCase()+a.slice(1)}function A(a){return a=d(a||""),a.charAt(0).toLowerCase()+a.slice(1)}function B(a){return a&&a.tagName&&a.tagName.toLowerCase()}function C(b,c){return!(!b||!c)&&(c.prototype?b instanceof c&&b:c.toFixed?b.nodeType&c&&b:("*"===c||a(b).is(c))&&b)}function D(a){return C(a,ra|ta|ua)}function E(b){var c={};return a.each(a.makeArray(b&&b.attributes),function(a,b){c[b.nodeName]=b.value}),c}function F(b,c){var d=E(b),e=E(c);return a.each(e,function(a,b){b===d[a]&&(delete d[a],delete e[a])}),!Object.keys(d)[0]&&!Object.keys(e)[0]}function G(a,b,c){if(a===b)return 0;var d=a&&b&&a.compareDocumentPosition(b);return 2&d?c&&8&d||1&d?NaN:1:4&d?c&&16&d||1&d?NaN:-1:NaN}function H(b,c){return b===c||a.contains(b,c)}function I(a,b){var c=a.length||a.childNodes.length;return b===c||0===b&&1/b===-(1/0)?c:(c+b)%c||0}function J(a,b,d,e){if(C(a,k)){var h=a;a=h.startTextNode||h.startElement,d=h.endTextNode||h.endElement,b=1===a.nodeType?!h.isCaret||h.caretPosition<=0:h.startOffset,e=1===d.nodeType?!!h.isCaret&&h.caretPosition<=0:h.endOffset}var i;return C(a,f)?(i=c.createRange(),d?(+b===b?i.setStart(a,I(a,b)):i[b?"setStartBefore":"setStartAfter"](a),C(d,f)&&(+e===e?i.setEnd(d,I(d,e)):i[e?"setEndBefore":"setEndAfter"](d))):(i[1&b?"selectNodeContents":"selectNode"](a),2&b&&i.collapse(!!(4&b)))):C(a,g)&&(i=a.cloneRange(),i.collapsed||("boolean"==typeof b?i.collapse(b):2&b&&i.collapse(!!(4&b)))),C(b,g)&&(i.collapsed&&b.collapsed?i.setEnd(b.endContainer,b.endOffset):(i.compareBoundaryPoints(0,b)<=0&&i.setStart(b.startContainer,b.startOffset),i.compareBoundaryPoints(2,b)>=0&&i.setEnd(b.endContainer,b.endOffset))),i}function K(a,b){return a=C(a,g)||J(a,!0),b=C(b,g)||J(b,!0),a&&b&&!(1&a.startContainer.compareDocumentPosition(b.startContainer))&&a.compareBoundaryPoints(3,b)<=0&&a.compareBoundaryPoints(1,b)>=0}function L(a,b){return a=C(a,g)||J(a,!0),b=C(b,g)||J(b,!0),a&&b&&!(1&a.startContainer.compareDocumentPosition(b.startContainer))&&a.compareBoundaryPoints(0,b)<=0&&a.compareBoundaryPoints(2,b)>=0}function M(a,b,c){a=C(a,g)||J(a,!0),b=C(b,g)||J(b,!0);var d=a&&b&&1&a.startContainer.compareDocumentPosition(b.startContainer)?NaN:a.compareBoundaryPoints(0,b)+a.compareBoundaryPoints(2,b);return c&&(0!==d&&K(a,b)||0===d&&(!L(a,b)||!L(b,a)))?NaN:d&&d/Math.abs(d)}function N(a){da||setTimeout(function(){da=!1}),da=!0,a()}function O(a){if(c.caretRangeFromPoint)return c.caretRangeFromPoint(a.clientX,a.clientY);if(a.rangeParent)return J(a.rangeParent,a.rangeOffset,!0);if(c.body.createTextRange){var b=Ca.rangeCount&&Ca.getRangeAt(0),d=c.body.createTextRange();d.moveToPoint(a.clientX,a.clientY),d.select();var e=Ca.getRangeAt(0);return b&&(Ca.removeAllRanges(),Ca.addRange(b)),e}}function P(a){var b=a.startTextNode,c=a.endTextNode,d=b===c;c&&a.endOffset<c.length&&c.splitText(a.endOffset),b&&a.startOffset>0&&(a.startTextNode=b.splitText(a.startOffset),d&&(a.endTextNode=a.startTextNode,a.endOffset-=a.startOffset),a.startOffset=0)}function Q(b){return C(b,h)||a(c.createDocumentFragment()).append(b)[0]}function R(a){return c.createTextNode(y(a)||ia)}function S(a,b){var d=c.createElement(a);return b&&(d.className=b),d}function T(b,c){return a.each(c,function(c,d){b=a(d.cloneNode(!1)).append(b)[0]}),C(b,f)||Q(b)}function U(v){function I(){this.originalSelection=new k(La)}function V(a){switch(a){case wa:return Ra.concat(La.widgets);case xa:return Ra;case ya:return La.widgets.slice(0).reverse().concat(Ra);case za:return La.widgets.slice(-1)}}function W(b,c){var d,e=[0].concat(t(arguments,2)),f=a.makeArray(C(b,l)||V(b));return a.each(f,function(a,f){var g=Sa[f.id];if(Ba(g[c]))return e[0]=new m(c,Oa,f),d=!0,g[c].apply(g,e)!==!1||b!==ya}),C(b,l)&&setTimeout(function(){W(xa,"widget"+z(c),b)}),d}function X(){if(Ca.rangeCount){var a=Ca.getRangeAt(0);return H(Pa,a.commonAncestorContainer)&&a}}function Y(d){function e(a,b){if(b.parentNode!==a&&b!==a){b.parentNode&&f(b,!0);for(var c=a.childNodes.length;c&&M(b.element,a.childNodes[c-1].element)<0;c--);b.parentNode=a,b.previousSibling=a.childNodes[c-1],b.nextSibling=a.childNodes[c],(b.previousSibling||{}).nextSibling=b,(b.nextSibling||{}).previousSibling=b,a.childNodes.splice(c,0,b)}}function f(a,b){if(a.parentNode){var e=a.parentNode.childNodes.indexOf(a);e>=0&&(!b&&a.widget.element===a.element&&H(c,d)&&(a.widget.destroyed=!0,W(a.widget,"destroy")),a.parentNode.childNodes.splice(e,1),a.parentNode=null,(a.previousSibling||{}).nextSibling=a.nextSibling,(a.nextSibling||{}).previousSibling=a.previousSibling)}}function k(b,i){function j(b){return b.widget&&C(b.element,Sa[b.widget.id].element)||(b.widget&&H(c,d)&&(b.widget.destroyed=!0,W(b.widget,"destroy")),delete b.widget,a.each(Sa,function(a,e){if(C(b.element,e.element))return b.widget=new l(Oa,a,b.element,e.options),H(c,d)&&W(b.widget,"init"),!1})),b.widget}function m(b){if("li"===B(b.element))if(a(b.element).children(ha)[0]){b.nodeType=sa;var c=0;a(b.element).contents().each(function(a,d){C(d,ha)&&(a>c||!a)&&(p.push(J(b.element,c,b.element,a)),c=a+1)})}else b.nodeType=ra;a.each(b.childNodes.slice(0),function(a,b){!C(b.element,g)&&H(d,b.element)||(f(b),s.delete(b.element))})}var o=[s.get(b)],p=[];m(o[0]);var q=i?a(b).children():C(b,h)?a(b).children().find("*").andSelf():a("*",b);q.each(function(a,b){for(;p[0]&&G(p[0].startContainer.childNodes[p[0].startOffset],b)<0;)o.unshift(new n(ra,p.shift(),o[0].widget)),e(o[1],o[0]);for(;!L(o[0].element,b);)o.shift();if("br"===B(b))return void(s.has(b)&&D(o[0])&&(f(s.get(b)),s.delete(b)));var c=!s.has(b),d=s.get(b)||new n(0,b);d.widget=!C(o[0],pa)&&j(d)||o[0].widget;var g=Sa[d.widget.id];g.inline||d.widget===o[0].widget&&!C(o[0],pa)?d.nodeType=C(b,ha)?sa:C(b,ga)?ra:ta:C(b,g.editable)?d.nodeType=C(b,ga)?ua:qa:d.nodeType=pa,m(d),e(o[0],d),s.set(b,d),i&&c&&k(b),o.unshift(d)})}function m(b){var c=a.map(b,function(b){return a(b.addedNodes).add(b.removedNodes).filter(":not(#Typer_RangeStart,#Typer_RangeEnd)")[0]?b.target:null});j.push.apply(t,c)}function o(a){for(var b=a;!s.has(b);b=b.parentNode);return k(b),s.get(a)}function p(){r?m(r.takeRecords()):q(p,function(){t.push(null)}),null===t[0]?k(t.splice(0)&&d):t[0]&&a(d.parentNode||d).find(a.unique(t.splice(0))).each(function(a,b){k(b,!!r)})}var r,s=new i,t=[];return d.parentNode||(d=C(d,h)||Q(d)),b.MutationObserver&&H(c,d)&&(r=new MutationObserver(m),r.observe(d,{subtree:!0,childList:!0})),s.set(d,new n(Qa,d,new l(Oa,0,Pa,v))),t.push(null),{get rootNode(){return this.getNode(d)},getNode:function(a){if(H(d,a))return 3!==a.nodeType&&"br"!==B(a)||(a=a.parentNode),p(),s.get(a)||o(a)}}}function Z(b){var c;return a.each(V(ya),function(a,d){return c=Ba((Sa[d.id].commands||{})[b])&&d,!c}),c}function $(a,b,c,d){var e=J(a,b,c,d);Ca.removeAllRanges(),e&&H(Pa,e.commonAncestorContainer)&&(Ca.addRange(e),Ma=e,La.dirty=!0)}function _(a,b){if(a&&3!==a.nodeType){var c=new p(Ka.getNode(a),4);if(b)for(;c.nextNode()&&b>c.currentNode.length;b-=c.currentNode.length);else if(1/b<0){for(;c.nextNode(););b=c.currentNode.length}else c.nextNode();a=c.currentNode}$(a,b||0,a,b||0)}function aa(b){function c(a,b,c){var d;"br"===B(a)?(d=a.nextSibling,b=0):1===a.nodeType&&a.childNodes[0]&&(c||b===a.childNodes.length?(a=a.childNodes[(b||1)-1],3===a.nodeType&&(d=a,a=d.parentNode,b=d.length),c=!0):(a=a.childNodes[b],b=0)),3===a.nodeType&&(d=a,a=a.parentNode);var e=Ka.getNode(a);for(C(e,sa)&&!C(e.containingElement,ha)&&d&&(e=u(e.childNodes,function(a){return L(a.element,d)})||e);C(e,ta)&&!C(e.parentNode,qa|ua);)e=e.parentNode;if(C(e,pa|qa))a=e.widget.element,d=null;else if(!d&&1===a.nodeType){for(var f=new p(e,4);f.nextNode()&&c;);d=f.currentNode,b=c?d&&d.length:0}return{node:e,element:a,textNode:d,offset:b}}C(b,g)||(b=J.apply(null,t(arguments)));var d=b.commonAncestorContainer;b.startContainer===b.endContainer&&b.startOffset===b.endOffset-1&&(d=C(d.childNodes[b.startOffset],Element)||d),H(Pa,d)||(d=Pa);var e=Ka.getNode(d);C(e,pa)&&(e=Ka.getNode(e.widget.element));var f=c(b.startContainer,b.startOffset),h=b.collapsed?f:c(b.endContainer,b.endOffset,!0);return a.extend(new k,{isCaret:b.collapsed,caretPosition:b.collapsed&&M(b,f.node.element),focusNode:e,startNode:f.node,startElement:f.element,startTextNode:f.textNode||null,startOffset:f.offset||0,endNode:h.node,endElement:h.element,endTextNode:h.textNode||null,endOffset:h.offset||0})}function ba(a){if(Ma=X()||Ma,Ma&&(La=aa(Ma),a!==!1)){var b={};W(wa,"beforeStateChange",b),W(wa,"stateChange",b)}}function ca(b){C(b,"li:only-child")&&(b=b.parentNode),a(b).remove()}function va(b){b=C(b,g)||J(b||Pa,!0),N(function(){var c=d(v.attributes||"").split(" "),e=aa(b);return C(e.focusNode,qa)&&!e.focusNode.childNodes[0]?void a(ka).appendTo(e.focusNode.element):C(e.focusNode,ua)&&!e.focusNode.childDOMNodes[0]?void a(R(ia)).appendTo(e.focusNode.element):(w(e.createTreeWalker(-1),function(b){if(D(b)){var d=a("br:last-child",b.element)[0];d&&!d.nextSibling&&(a(R()).insertBefore(d),ca(d));var e=a("br:first-child",b.element)[0];e&&!e.previousSibling&&ca(e);var g;a(b.childDOMNodes).each(function(a,b){3===b.nodeType&&(y(b.nodeValue)?b.nodeValue.charAt(0)===ia?(b=b.splitText(1),ca(b.previousSibling)):b.nodeValue.slice(-1)===ia&&(b.splitText(b.length-1),ca(b.nextSibling)):!b.previousSibling&&!b.nextSibling||"br"===B(b.previousSibling)?b.nodeValue=ia:Ma&&!M(b,Ma,!0)||ca(b),g=!0)}),g||(b.element.appendChild||b.element.insertNode).call(b.element,R())}C(b.element,f)&&(C(b,sa|ra|ta)&&a.each(E(b.element),function(d){a.inArray(d,c)<0&&a(b.element).removeAttr(d)}),C(b,pa)||Ma&&K(Ma,b.element)||(b.element.normalize(),C(b,ta)?B(b.element.previousSibling)===B(b.element)&&F(b.element,b.element.previousSibling)?(a(b.element).contents().appendTo(b.element.previousSibling),ca(b.element)):fa.indexOf(B(b.element))<0&&0===b.element.childElementCount&&!y(b.element.textContent)&&ca(b.element):C(b,qa)||C(b,sa)&&C(b.element,ha)?(a(b.element).contents().each(function(b,c){3===c.nodeType&&(y(c.nodeValue)?a(c).wrap("<p>"):ca(c))}),b.element.childNodes[0]||a(ka).appendTo(b.element)):C(b,ua)&&a(R(ia)).appendTo(b.element)))}),a('br[type="_moz"]',Pa).remove(),void a(Aa&&"*",Pa).each(function(b,c){a(c).data("typerIEFix")||(a(c).data("typerIEFix",!0),a(c).bind("input",function(b){da||Ua.trigger(a.Event("input",b))}),a(c).bind("textinput",function(b){da||Ua.trigger(a.Event("textInput",b))}))}))})}function Da(b,d){function e(a){return J(a,(M(b,a)<0?ma:oa)|(a!==Ka.getNode(a).widget.element&&1===a.nodeType))}var i,j,k=(d||b)===!0?"extractContents":Ba(d||b)?"deleteContents":"cloneContents",l=k.indexOf("de")<0,m=k.indexOf("cl")<0,n=c.createDocumentFragment();if(La.dirty&&ba(!1),d=C(d||b,Function),b=C(b,g)||J(C(b,f)||La),!b.collapsed){var o=aa(b);Ba(d)&&(i=e(o.startTextNode||o.startElement),j=o.isSingleEditable?e(o.endTextNode||o.endElement):i);var p=[[Pa,n]];w(o.createTreeWalker(-1,function(c){if(C(c.element,f)&&!H(p[0][0],c.element)&&p.shift(),L(b,c.element))return l&&a(p[0][1]).append(c.cloneDOMNodes(!0)),m&&(C(c,qa)?a(c.element).html(ka):C(c,ua)?a(c.element).html(ja):ca(c.element)),2;var d=D(c)&&J(c.element,b)[k]();if(l){if(C(c,pa|sa)||C(c,qa|ua)&&c.element!==Pa||d&&B(d.firstChild)!==B(c.element)){var e=c.cloneDOMNodes(!1);p[0][1].appendChild(e),C(e,h)||p.unshift([c.element,e])}d&&p[0][1].appendChild(d)}return D(c)?2:1}))}return Ba(d)?d(i||J(b,!0),j||J(b,!1)):va(b),ba(!1),n}function Ea(b){return"string"!=typeof b||"<"!==b.charAt(0)?(b=d(b).replace(/\u000d/g,"").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br>").replace(/<p>(<|$)/g,"<p>"+ja+"$1")||ja,a.parseHTML("<p>"+b+"</p>")):a.map(a.parseHTML(b),function(b){return 3===b.nodeType?a(b).wrap("<p>").parent()[0]:b})}function Fa(b,c){b=C(b,f)||Ea(b),void 0===c||C(c,g)||(c=J.apply(null,t(arguments,1))),Da(c,function(c,d){var e=J(c,d),f=aa(e);C(f.startNode,qa)&&f.startNode===f.endNode&&(va(e),f=aa(J(f.startNode.element,!0)));var g,h,i=f.startNode,k=f.endNode,l=C(k.parentNode,sa)?k.parentNode:k;if(C(i,ra))h=[f.startElement];else if(C(i,ta)){var m=C(i.containingElement.parentNode,ha)||i.containingElement||Ka.getNode(i.containingElement).widget.element;h=a(f.startElement).parentsUntil(m).andSelf().get().reverse()}else h=[S("p")];for(var n,o=Y(b),p=o.rootNode.childNodes.slice(0),q=!p[1]&&(!p[0]||D(p[0]))&&i!==k;p[0];){var r=p.pop();if(C(r,sa)&&"li"===B(k.containingElement))j.push.apply(p,s(r.childNodes));else{var t=C(r,ta)?[r.element]:r.childDOMNodes.slice(0),u=C(r,pa)||!D(k),v=p[0]&&!n&&!C(k,ua);if(u||v){var w=J((u?l:k).element,oa),x=J(d,w).extractContents(),y=x.childNodes[0];if((x.textContent||y&&(!D(r)||t[0]))&&(w.insertNode(x),k=aa(w).focusNode,l=u?k:l,d=w,g=g||J(k.element,la)),D(r)){t[0]&&(D(k)?(J(y,la)||d).insertNode(T(t,h.slice(0,-1))):w.insertNode(T(t,h)),g=g||J(t[0],na),n=!0);continue}}var z=t.slice(-1)[0];C(r,pa|sa)?(d.insertNode(r.element),g=g||J(r.element,oa)):p[0]?(d.insertNode(T(t,n?h:h.slice(0,-1))),g=g||J(z,na),n=!0):t[0]&&(c.insertNode(i?Q(t):T(t,h)),c=J(z,oa),g=g||J(z,na))}}q&&(g=g||c.cloneRange(),c.insertNode(J(k.element,!0).extractContents()),ca(k.element)),va(J(c,g||d)),$(g||d)})}function Ga(a){var b=Y(a),c=new o(b.rootNode,ra),d=x(c,function(a){var b=new p(a,5,function(a){return a.nodeValue||"br"===B(a)?1:3});return x(b,function(a){return a.nodeValue||"\n"}).join("")});return d.join("\n\n")}function Ha(b){if(W(ya,b))return!0;if("backspace"===b||"delete"===b){var c;if(La.isCaret){var d="backspace"===b?-1:1,e=d<0?La.previousTextNode:La.nextTextNode,f=d<0?La.textStart:La.textEnd;if(!e&&f)La.textStart&&La.textEnd&&ca(La.startElement),$(d<0?La.previousNode.element:La.nextNode.element),c=!0;else if(La.startTextNode){if(f){var g=La.getSelectedElements("li")[0],h=d<0?La.previousNode:La.nextNode;if(C(g,"li:"+(d<0?"first-child":"last-child"))&&"li"===B(h.containingElement)&&!H(g.parentNode,h.containingElement)){var i=(a.uniqueSort||a.unique)([g.parentNode,h.containingElement.parentNode]);a(i[1]).appendTo(i[0]).children().unwrap(),$(La)}else d<0?Fa("",e,-0,La.startTextNode,0):Fa("",La.startTextNode,-0,e,0);c=!0}}else La.caretPosition===d?$(e,d<0?na:la):($(La.startElement),c=!0)}else Fa(""),c=!0;if(c)return Ta.snapshot(),!0}return/ctrl(?![axcvr]$)|alt|enter/i.test(b)}function Ia(){function b(b){if(b=y(b.replace(f,"").replace(g,"").replace(/(?!>)\u200b(?!<\/)/g,"")),b!==i){var c=a("<div>").html(b);return a(v.controlElements,c).remove(),a(d(v.controlClasses||"").replace(/\b(\S+)/g,".$1").replace(/\s+\./g,",."),c).removeClass(v.controlClasses),W(wa,"change",c.html()),i=b,!0}}function c(){N(function(){var c,d,e=X();La.dirty&&ba(),La.startTextNode?(La.startOffset>0&&(c=La.startTextNode.splitText(La.startOffset)),a(f).insertBefore(c||La.startTextNode)):La.startElement&&a(f).insertBefore(La.startElement),La.isCaret||(La.endTextNode?(La.endOffset<La.endTextNode.length&&(d=La.endTextNode.splitText(La.endOffset)),a(g).insertAfter(La.endTextNode)):La.endElement&&a(g).insertAfter(La.endElement));var i=Pa.innerHTML;if(i!==j[0]){var l=b(i);j.splice(0,k+!l,i),j.splice(v.historyLevel),k=0}a(h).remove(),c&&(La.startTextNode.nodeValue+=c.nodeValue,a(c).remove()),d&&(La.endTextNode.nodeValue+=d.nodeValue,a(d).remove()),e&&$(La)})}function e(c){Ua.html(c);var d=a(h);if(d[0]){var e=J(d[0],!d[1]&&oa,d[1],!0);d.remove(),$(e),ba()}b(c)}var f='<span id="Typer_RangeStart"></span>',g='<span id="Typer_RangeEnd"></span>',h="#Typer_RangeStart,#Typer_RangeEnd",i=y(Pa.innerHTML),j=[i],k=0;a.extend(Ta,{canUndo:function(){return k<j.length-1},canRedo:function(){return k>0},undo:function(){Ta.canUndo()&&e(j[++k])},redo:function(){Ta.canRedo()&&e(j[--k])},snapshot:function(a){q("snapshot"),a?q("snapshot",c,a):a!==!1&&c()}})}function Ja(){function f(){var a=m;m&&!m.destroyed&&(m=null,W(a,"focusout"))}var g,h,i,j,k,l,m;Ua.mousedown(function(b){b.stopPropagation(),g=!0;var d={mousemove:function(a){return!a.which&&g?void d.mouseup():void q(Ja,ba)},mouseup:function(){g=!1,a(c.body).unbind(d),q(Ja,function(){ba(),va(La.focusNode.element),Ta.snapshot()})}};a(c.body).bind(d)}),Ua.bind("compositionstart compositionupdate compositionend",function(a){a.stopPropagation(),h="end"!==a.type.substr(-3)}),Ua.bind("keydown keypress keyup",function(b){if(b.stopPropagation(),f(),h)return void b.stopImmediatePropagation();l=!0,setTimeout(function(){l=!1});var c=a.inArray(b.keyCode,[16,17,18,91,93])>=0,e=!c&&ea[b.keyCode]!==d.fromCharCode(b.keyCode).toLowerCase();if("keydown"===b.type){if(i=b.ctrlKey+b.shiftKey+b.altKey+b.metaKey+!c,i*=e||(i>2||i>1&&!b.shiftKey)&&!c,j=b.keyCode,i){var g=A((b.ctrlKey||b.metaKey?"Ctrl":"")+(b.altKey?"Alt":"")+(b.shiftKey?"Shift":"")+z(ea[j]||d.fromCharCode(b.charCode)));if(Ha(g))return k=!0,void b.preventDefault()}k=!1,q(Ja,function(){ba(),va(La.focusNode.element)})}else"keypress"===b.type?!i&&b.charCode||b.stopImmediatePropagation():((b.keyCode===j||c)&&i--&&b.stopImmediatePropagation(),k||c||(ba(),Ta.snapshot(50)))}),Ua.bind("textInput",function(){e.stopPropagation(),l||Ta.snapshot(50)}),Ua.bind("compositionstart keypress textInput",function(a){if(Ta.snapshot(!1),!La.startTextNode||La.paragraphElements[1]){"compositionstart"!==a.type&&a.preventDefault();var b=a.originalEvent.data||d.fromCharCode(a.charCode)||"";!La.startTextNode&&W(za,"textInput",b)||(Fa(b),Ta.snapshot())}}),Ua.bind("dragstart",function(a){a.stopPropagation();var b={drop:function(a){var c=Da(!a.ctrlKey),d=O(a.originalEvent);Fa(c,d),Ta.snapshot(),a.preventDefault(),Ua.unbind(b)}};Ua.bind(b)}),Ua.bind("cut copy",function(c){var d=c.originalEvent.clipboardData||b.clipboardData,e=Da("cut"===c.type),f=Ga(e);b.clipboardData?d.setData("Text",f):(d.setData("text/plain",f),d.setData("text/html",a('<div id="Typer">').append(e)[0].outerHTML),d.setData("application/x-typer","true")),c.stopPropagation(),c.preventDefault()}),Ua.bind("paste",function(c){var d=c.originalEvent.clipboardData||b.clipboardData;if(a.inArray("application/x-typer",d.types)>=0){var e=d.getData("text/html"),f=Q(a(e).filter("#Typer").contents());Fa(f)}else a.inArray("text/plain",d.types)>=0?Fa(d.getData("text/plain")):b.clipboardData&&Fa(d.getData("Text"));Ta.snapshot(),c.stopPropagation(),c.preventDefault(),Aa&&setTimeout(function(){$(La)})}),Ua.bind("mouseup",function(a){var b=Ka.getNode(a.target);m!==b.widget&&f(),C(b,pa)&&(Aa&&setTimeout(function(){$(b.widget.element)}),$(b.widget.element),m!==b.widget&&(m=b.widget,W(b.widget,"focusin")))}),Ua.bind("focusin focusout",function(a){setTimeout(function(){Na||("focusout"===a.type&&f(),W(wa,a.type))})})}v=a.extend({element:null,controlClasses:"",controlElements:"",attributes:"title target href src align name class width height",historyLevel:100,widgets:[],inline:!1,lineBreak:!0,inlineStyle:!0,formatting:!0,list:!0,link:!0,change:null,beforeStateChange:null,stateChange:null},v);var Ka,La,Ma,Na,Oa=this,Pa=v.element,Qa=v.inline||C(Pa,ga)?ua:qa,Ra=[],Sa=[v].concat(v.widgets),Ta={},Ua=a(Pa);Ia(),Ja(),a.each(U.widgets,function(b,c){if((v[b]===!0||a.isPlainObject(v[b]))&&(c.inline||Qa!==ua)){var d=Object.create(c);d.options=Object.create(d.options||null),a.extend(d.options,v[b]),Sa.push(d)}}),Sa.push({element:":not("+ga+",br,a,b,em,i,u,small,strong,sub,sup,ins,del,mark,span)"},{ctrlZ:Ta.undo,ctrlY:Ta.redo,ctrlShiftZ:Ta.redo}),a.each(Sa,function(a,b){b.element||Ra.push(new l(Oa,a,null,b.options))});var Va={focusin:function(a){Na=a.currentTarget},focusout:function(a){var b=a.currentTarget;setTimeout(function(){Na!==b||X()||(Na=null,Ua.trigger("focusout"))})}};a.extend(this,{element:Pa,canUndo:Ta.canUndo,canRedo:Ta.canRedo,undo:Ta.undo,redo:Ta.redo,hasCommand:function(a){return!!Z(a)},getSelection:function(){return new k(La)},select:function(a,b,c,d){$(a,b,c,d),Ta.snapshot()},moveCaret:function(a,b){_(a,b),Ta.snapshot()},retainFocus:function(b){a(b).bind(Va)},invoke:function(a){var b=this,c=[new I].concat(t(arguments,1));N(function(){"string"==typeof a&&(c[0].commandName=a,c[0].widget=Z(a),a=c[0].widget&&Sa[c[0].widget.id].commands[a]),Ba(a)&&a.apply(b,c)}),ba(),Ta.snapshot()}}),I.prototype={widget:null,remove:ca,normalize:va,invoke:Oa.invoke,hasCommand:Oa.hasCommand,insertText:function(a){Fa(d(a||""))},insertHtml:function(a){Fa(a)},execCommand:function(a,b){c.execCommand(a,!1,b||""),ba(!1)},getSelectedText:function(){var a=Da();return Ga(a)},getSelectedTextNodes:function(){return P(La),a.map(La.selectedElements,function(b){return a(b).contents().filter(function(a,b){return 3===b.nodeType&&G(La.startTextNode,b)<=0&&G(La.endTextNode,b)>=0})})},select:function(a,b,c,d){$(a,b,c,d),ba(!1)},moveCaret:function(a,b){_(a,b),ba(!1)},restoreSelection:function(){$(this.originalSelection),ba(!1)}},r(I.prototype,{selection:function(){return new k(La)}}),Ua.attr("contenteditable","true"),Ka=this.document=Y(Pa),W(xa,"init"),La=aa(Pa,la),va()}function V(a,b){return b&&(a.whatToShow&va||!C(b,pa|qa|ua))}function W(a,b,c){return c&&!V(a,b)?2:C(b,pa)&&C(b.parentNode,pa)?3:v(a,b)}function X(a,b,c){if(W.returnValue=W(a,b,c),1===W.returnValue)return a.currentNode=b,!0}function Y(a,b,c){for(var d=a.currentNode[b];d;){if(X(a,d,!0))return d;if(3===W.returnValue&&d[b])d=d[b];else{for(;!d[c];)if(d=V(a,d.parentNode)&&d.parentNode,!d||d===a.root||d===a.currentNode)return null;d=d[c]}}}function Z(a,b,c){for(var d=a.currentNode;d&&d!==a.root;){for(var e=d[c];e;){if(X(a,e))return e;e=2!==W.returnValue&&e[b]?e[b]:e[c]}if(d=V(a,d.parentNode)&&d.parentNode,!d||d===a.root||1===W(a,d,!0))return null}}function $(a,b){var d=a.typerNodeIterator.currentNode;if(!D(d))return c.createNodeIterator(C(d.element,f)||d.containingElement,0);var e=C(d.element,g),h=c.createTreeWalker(e?d.containingElement:d.element,1|a.whatToShow,function(b){return 1===b.nodeType||e&&!K(e,b)?2:1|v(a,b)},!1);if("previousNode"===b){for(var i=a.currentNode;h.lastChild(););for(;G(i,h.currentNode,!0)<=0&&h[b](););}return h}function _(a,b){var c=a.currentNode;if(a.iterator[b]())return a.currentNode["nextNode"===b?"previousSibling":"nextSibling"]!==c&&a.typerNodeIterator[b]()&&(a.iteratorStack.unshift({dir:b,iterator:a.iterator}),a.iterator=$(a,b),1===v(a.iterator)||a.iterator[b]())?a.currentNode:a.currentNode;for(;a.iteratorStack[0];){var d=a.iteratorStack.shift();if(d.dir===b)return a.iterator=d.iterator,a.currentNode}for(;a.typerNodeIterator[b]();)if(a.iterator=$(a,b),1===v(a.iterator)||a.iterator[b]())return a.currentNode}function aa(a,b,c){var d=J(a);return new o(a.focusNode,b|va,function(a){return K(a.element,d)?a.selectedInRange(d)?c?c(a):1:3:2})}function ba(a,b,c){for(var d=a;d&&!C(d,qa|ua);d=d.parentNode);var e=new o(d,b);return e.currentNode=a,c&&(e=new p(e,4),e.currentNode=c),e}function ca(a){for(var b=[],c=a.focusNode;c;c=c.parentNode)C(c,qa|ua)&&b.unshift(c);return b}var da,ea=JSON.parse('{"8":"backspace","9":"tab","13":"enter","16":"shift","17":"ctrl","18":"alt","19":"pause","20":"capsLock","27":"escape","33":"pageUp","34":"pageDown","35":"end","36":"home","37":"leftArrow","38":"upArrow","39":"rightArrow","40":"downArrow","45":"insert","46":"delete","48":"0","49":"1","50":"2","51":"3","52":"4","53":"5","54":"6","55":"7","56":"8","57":"9","65":"a","66":"b","67":"c","68":"d","69":"e","70":"f","71":"g","72":"h","73":"i","74":"j","75":"k","76":"l","77":"m","78":"n","79":"o","80":"p","81":"q","82":"r","83":"s","84":"t","85":"u","86":"v","87":"w","88":"x","89":"y","90":"z","91":"leftWindow","92":"rightWindowKey","93":"select","96":"numpad0","97":"numpad1","98":"numpad2","99":"numpad3","100":"numpad4","101":"numpad5","102":"numpad6","103":"numpad7","104":"numpad8","105":"numpad9","106":"multiply","107":"add","109":"subtract","110":"decimalPoint","111":"divide","112":"f1","113":"f2","114":"f3","115":"f4","116":"f5","117":"f6","118":"f7","119":"f8","120":"f9","121":"f10","122":"f11","123":"f12","144":"numLock","145":"scrollLock","186":"semiColon","187":"equalSign","188":"comma","189":"dash","190":"period","191":"forwardSlash","192":"backtick","219":"openBracket","220":"backSlash","221":"closeBracket","222":"singleQuote"}'),fa="area base br col command embed hr img input keygen link meta param source track wbr".split(" "),ga="h1,h2,h3,h4,h5,h6,p,ul,ol,li,q,blockquote,pre,code",ha="ul,ol",ia="​",ja="&#8203;",ka="<p>&#8203;</p>",la=7,ma=6,na=3,oa=2,pa=1,qa=2,ra=4,sa=8,ta=16,ua=32,va=4096,wa=1,xa=2,ya=3,za=4,Aa=!!b.ActiveXObject||void 0!==c.documentElement.style.msTouchAction,Ba=a.isFunction,Ca=b.getSelection();if(b.Typer=U,a.extend(U,{COLLAPSE_START_INSIDE:la,COLLAPSE_START_OUTSIDE:ma,COLLAPSE_END_INSIDE:na,COLLAPSE_END_OUTSIDE:oa,NODE_WIDGET:pa,NODE_PARAGRAPH:ra,NODE_EDITABLE:qa,NODE_EDITABLE_INLINE:ua,NODE_INLINE:ta,NODE_OUTER_PARAGRAPH:sa,NODE_SHOW_EDITABLE:va,ZWSP:ia,ZWSP_ENTITIY:ja,iterate:w,iterateToArray:x,compareAttrs:F,comparePosition:G,compareRangePosition:M,containsOrEquals:H,createElement:S,createTextNode:R,createRange:J,rangeIntersects:K,rangeCovers:L,getRangeFromMouseEvent:O,widgets:{}}),n.prototype={get containingElement(){return this.element.commonAncestorContainer||this.element},get childDOMNodes(){return C(this.element,g)?s(this.element.commonAncestorContainer.childNodes,this.element.startOffset,this.element.endOffset):s(this.element.childNodes)},get firstChild(){return this.childNodes[0]||null},get lastChild(){return this.childNodes.slice(-1)[0]||null},selectedInRange:function(a){return L(a,this.element)||!!u(this.childNodes,function(b){return L(a,b.element)})||!!u(this.childDOMNodes,function(b){return 3===b.nodeType&&K(a,b)})},createRange:function(a){return+a===a?J(this.element,C(this.element,g)?!!(4&a):a):C(this.element,g)?this.element.cloneRange():J(this.element,!!a)},createDOMNodeIterator:function(a,b){return new p(this,a,b)},cloneDOMNodes:function(b){return C(this.element,g)?Q(a.map(this.childDOMNodes,function(a){return a.cloneNode(b)})):this.element.cloneNode(b)}},o.prototype={previousSibling:function(){return Z(this,"firstChild","nextSibling")},nextSibling:function(){return Z(this,"lastChild","previousSibling")},firstChild:function(){return Y(this,"firstChild","nextSibling")},lastChild:function(){return Y(this,"lastChild","previousSibling")},parentNode:function(){for(var a=this.currentNode;a&&a!==this.root;a=a.parentNode)if(X(this,a.parentNode,!0))return a.parentNode},previousNode:function(){for(var a=this.currentNode;a&&a!==this.root;){for(var b=a.previousSibling;b;b=a.previousSibling){a=b;for(var c=W(this,b);2!==c&&V(this,a.childNodes[0])&&a.childNodes[0];)a=a.lastChild,c=W(this,a,!0);if(1===c)return this.currentNode=a,a}if(a=V(this,a.parentNode)&&a.parentNode,!a||a===this.root)return null;if(X(this,a,!0))return a}},nextNode:function(){for(var a=this.currentNode,b=1;a;){for(;2!==b&&a.childNodes[0];){if(a=a.firstChild,X(this,a,!0))return a;b=W.returnValue}for(;a&&a!==this.root&&!a.nextSibling;)a=V(this,a.parentNode)&&a.parentNode;if(!a||a===this.root)return null;if(a=a.nextSibling,X(this,a))return a;b=W.returnValue}}},p.prototype={get currentNode(){return this.iterator.currentNode},set currentNode(a){this.iterator.currentNode=a},previousNode:function(){return _(this,"previousNode")},nextNode:function(){return _(this,"nextNode")}},r(p.prototype,{iterator:function(){var a=this.typerNodeIterator;return D(a.currentNode)||a.nextNode(),this.iteratorStack=[],$(this)}}),k.prototype={getSelectedElements:function(b){return a(this.selectedElements).filter(b||"*").get()},getEditableElements:function(b,c){return a(b.element).find(this.editableElements).filter(c||"*").get()},createTreeWalker:function(a,b){return aa(this,a,b)},createDOMNodeIterator:function(a,b){return new p(aa(this,ra|ta|pa),a,b)}},r(k.prototype,{widgets:function(){return a.map(ca(this),function(a){return a.widget})},editableElements:function(){return a.map(ca(this).concat(x(aa(this,qa|ua))),function(a){return a.containingElement})},paragraphElements:function(){var b=new o(this.focusNode,ra|va),c=x(b,null,this.startNode);return c.splice(c.indexOf(this.endNode)+1),a.map(c,function(a){return a.containingElement})},selectedElements:function(){return x(aa(this,ra|ta),function(a){return a.containingElement})},previousNode:function(){return ba(this.startNode,ra|pa).previousNode()||null},nextNode:function(){return ba(this.endNode,ra|pa).nextNode()||null},previousTextNode:function(){return ba(this.startNode,ra,this.startTextNode||this.startElement).previousNode()||null},nextTextNode:function(){return ba(this.endNode,ra,this.endTextNode||this.endElement).nextNode()||null},textStart:function(){if(this.startTextNode&&(!this.startOffset||this.startTextNode.nodeValue.slice(0,this.startOffset)===ia))return!this.previousTextNode||!L(this.startNode.element,this.previousTextNode)||"br"===B(this.previousTextNode.nextSibling)&&this.startTextNode.previousSibling===this.previousTextNode.nextSibling},textEnd:function(){if(this.endTextNode&&(this.endOffset===this.endTextNode.length||this.endTextNode.nodeValue.slice(this.endOffset)===ia))return!this.nextTextNode||!L(this.endNode.element,this.nextTextNode)||"br"===B(this.nextTextNode.previousSibling)&&this.endTextNode.nextSibling===this.nextTextNode.previousSibling},isSingleEditable:function(){return!x(aa(this,qa|ua))[1]}}),l.prototype={remove:function(){var a=this;a.typer.invoke(function(b){b.select(a.element),b.insertText()})}},a.fn.typer=function(b){return this.each(function(c,d){new U(a.extend({},b,{element:d}))})},!Aa){try{c.designMode="on",c.execCommand("enableObjectResizing",!1,!1),c.execCommand("enableInlineTableEditing",!1,!1)}catch(a){}c.designMode="off"}a(c.body).bind("mscontrolselect",function(a){a.preventDefault()}),"undefined"==typeof i&&(i=function(){Object.defineProperty(this,"__dataKey__",{value:"typer"+Math.random().toString(36).substr(2,8)})},i.prototype={get:function(a){return a[this.__dataKey__]},set:function(a,b){a[this.__dataKey__]=b},has:function(a){return this.__dataKey__ in a},delete:function(a){delete a[this.__dataKey__]}})}(jQuery,window,document,String,Node,Range,DocumentFragment,window.Map,[]),function(a,b){"use strict";function c(b){a(b.selection.paragraphElements).attr("align",h[b.commandName])}function d(a){a.selection.isCaret?a.insertHtml(j(i[a.commandName])):(a.selection.subscript&&"superscript"===a.commandName?a.execCommand("subscript"):a.selection.superscript&&"subscript"===a.commandName&&a.execCommand("superscript"),a.execCommand(a.commandName))}function e(c,d,e){d=d||("insertOrderedList"===c.commandName?"ol":"ul"),a.each(c.selection.paragraphElements,function(c,f){var g=d+(e||"").replace(/^(.)/,".$1");if("li"!==f.tagName.toLowerCase()){var h=a(f).prev(g)[0]||a(f).next(g)[0]||a(j(d,e)).insertAfter(f)[0];a(f).wrap("<li>").contents().unwrap().parent()[b.comparePosition(f,h)<0?"prependTo":"appendTo"](h);
}else a(f.parentNode).is(g)||a(f.parentNode).wrap(j(d,e)).contents().unwrap()}),c.restoreSelection()}function f(a,c,d){b.widgets[a]={commands:c},(d||"").replace(/(\w+):(\w+)/g,function(c,d,e){b.widgets[a][d]=function(a){a.typer.invoke(e)}})}var g="ul,ol",h={justifyLeft:"left",justifyRight:"right",justifyCenter:"center",justifyFull:"justify"},i={bold:"b",italic:"i",underline:"u",superscript:"sup",subscript:"sub"},j=b.createElement;f("inlineStyle",{bold:d,italic:d,underline:d,superscript:d,subscript:d,applyClass:function(b,c){var d=b.selection.paragraphElements;a(b.getSelectedTextNodes()).wrap(j("span",c)),a("span:has(span)",d).each(function(b,c){a(c).contents().unwrap().filter(function(a,b){return 3===b.nodeType}).wrap(j("span",c.className))}),a('span[class=""]',d).contents().unwrap(),b.restoreSelection()}},"ctrlB:bold ctrlI:italic ctrlU:underline"),f("formatting",{justifyCenter:c,justifyFull:c,justifyLeft:c,justifyRight:c,formatting:function(b,c){var d=/^([^.]*)(?:\.(.+))?/.exec(c)||[];"ol"===d[1]||"ul"===d[1]?e(b,d[1],d[2]):a(b.selection.paragraphElements).not("li").wrap(j(d[1]||"p",d[2])).contents().unwrap(),b.restoreSelection()},insertLine:function(a){a.insertText("\n\n")}},"enter:insertLine ctrlShiftL:justifyLeft ctrlShiftE:justifyCenter ctrlShiftR:justifyRight"),f("lineBreak",{insertLineBreak:function(a){a.insertHtml("<br>"+(a.selection.textEnd?b.ZWSP_ENTITIY:""))}},"shiftEnter:insertLineBreak"),f("list",{insertOrderedList:e,insertUnorderedList:e,indent:function(b){a.each(b.selection.paragraphElements,function(c,d){var e=a(d.parentNode).filter(g)[0],f=a(d).prev("li")[0]||a("<li>").insertBefore(d)[0],h=a(f).children(g)[0]||a(e.cloneNode(!1)).appendTo(f)[0];a("<li>").append(d.childNodes).appendTo(h),b.remove(d)})},outdent:function(b){a.each(b.selection.paragraphElements,function(c,d){var e=a(d.parentNode).filter(g)[0],f=a(e).parent("li")[0];a(d).next("li")[0]&&(f?a(e.cloneNode(!1)).append(a(d).nextAll()).appendTo(d):(a(e.cloneNode(!1)).append(a(d).nextAll()).insertAfter(e),a(d).children(g).insertAfter(e))),a(j(f?"li":"p")).append(d.childNodes).insertAfter(f||e),b.remove(d)})}}),f("link",{createLink:function(a,b){b=b||/^[a-z]+:\/\//g.test(a.getSelectedText())&&RegExp.input||"#",a.select(a.selection.getSelectedElements("a")[0]||a.selection),a.execCommand("createLink",b)},unlink:function(a){var b=a.selection.getSelectedElements("a")[0];b&&(a.select(b),a.execCommand("unlink"))}}),a.each("inlineStyle lineBreak link".split(" "),function(a,c){b.widgets[c].inline=!0})}(jQuery,window.Typer),function(a,b){"use strict";function c(b,c,d){"function"==typeof c&&(d=c,c=void 0),d=d||function(b){a.extend(this,b)};var e={},f="function"!=typeof b?null:function(){b.apply(this,arguments)},g=function(a){if(!(this instanceof g)){var b=new g(e);return g.apply(b,arguments),b}if(a!==e)try{this._super=f,d.apply(this,arguments)}finally{this._super=null}};return g.prototype=f?new b(c):b,g}function d(a){var b=/^([\w:]*)(?:\(([^}]+)\))?$/.exec(a),c=null;try{c=b[2]&&JSON.parse(("{"+b[2]+"}").replace(/([{:,])\s*([^\s:,}]+)/g,'$1"$2"'))}catch(a){}return{name:b[1],params:c}}function e(b){var c=a(b).css("text-align"),d=a(b).css("direction");switch(c){case"-webkit-left":return"left";case"-webkit-right":return"right";case"start":return"ltr"===d?"left":"right";case"end":return"ltr"===d?"right":"left";default:return c}}function f(b,c){return c=window.prompt(b,c),null!==c?a.when(c):a.Deferred().reject().promise()}function g(c,e){if(e=e||c,e.controls){var f=e.controls.split(/\s+/),h={};a.each(f,function(b,c){if("*"===c.slice(-1))a.each(p,function(a,b){a.slice(0,c.length-1)===c.slice(0,-1)&&f.indexOf("-"+a)<0&&!h[a]&&(h[a]=Object.create(b))});else if("-"!==c.charAt(0)){var e=d(c);p[e.name]&&f.indexOf("-"+e.name)<0&&!h[e.name]&&(h[e.name]=a.extend(Object.create(p[e.name]),e.params))}});var i=[];a.each(h,function(a,c){c.name=c.name||a,c.label=c.label||b.toolbar.labels[c.name]||c.name,i.push(c)}),e.controls=i}else"function"==typeof e.createChildren&&(e.controls=e.createChildren(c,e)||[]);return a.each(e.controls||[],function(a,b){b.parent=e,g(c,b)}),e.controls}function h(b,c,e){function f(b){a(b).find("*").andSelf().filter("[x\\:bind]").each(function(b,e){var f=d(a(e).attr("x:bind"));c.bindData.push([e,f.params])}).removeAttr("x:bind")}function g(e){var h=a(b.renderer[e]||'<div><br x:t="children"></div>')[0];return f(h),a("[x\\:t]",h).each(function(e,h){var i,j=d(a(h).attr("x:t"));"function"==typeof b.renderer[j.name]?(i=a(b.renderer[j.name](b,c,j.params)),f(i)):i=g(j.name),a(h).replaceWith(i)}),h}return c=c||b,c.bindData=[],c.element=g(c.type),a(c.element).bind(b.renderer[c.type+"ExecuteOn"],function(){b.execute(c)}),b.renderer[c.type+"Init"]&&b.renderer[c.type+"Init"](b,c),c.element}function i(b,c,d){return a.map(c.controls,function(a){return h(b,a,d)})}function j(b,c){if(a.each((c||b).controls||[],function(a,c){j(b,c)}),c){c.stateChange&&(c.stateChange(b,c),b.renderer[c.type+"StateChange"]&&b.renderer[c.type+"StateChange"](b,c));var d=b.enabled(c)===!1,e=!c.hiddenWhenDisabled||!d;"string"==typeof c.dependsOn?e&=b.typer.hasCommand(c.dependsOn):c.dependsOn&&(e&=!a.grep(c.dependsOn,function(a){return!b.typer.hasCommand(a)})[0]),e&&a.each(c.bindData,function(b,d){a.each(d[1],function(b,e){"_"===b?a(d[0]).text(c[e]||""):a(d[0]).attr(b,c[e]||"")})});var f=a(c.element);f.prop("disabled",d),b.options.controlDisabledClass&&f.toggleClass(b.options.controlDisabledClass,d),b.options.controlActiveClass&&f.toggleClass(b.options.controlActiveClass,!!b.active(c)),b.options.controlHiddenClass?f.toggleClass(b.options.controlHiddenClass,!e):e?f.data("original-display")?f.css("display",f.data("original-display")):f.show():("none"!==f.css("display")&&f.data("original-display",f.css("display")),f.hide())}}function k(b,c){g(b),b.element=h(b);var d=a(b.element).addClass("typer-ui typer-ui-toolbar");c?d.appendTo(c):(d.addClass("typer-ui-toolbar-floating").css("z-index",1e3),d.mousedown(function(c){var e=d.position();if(c.target===b.element){var f=function(a){l(b,{top:e.top+(a.clientY-c.clientY),left:e.left+(a.clientX-c.clientX)})};a(document.body).mousemove(f),a(document.body).mouseup(function(){a(document.body).unbind("mousemove",f)})}setTimeout(function(){clearTimeout(b.toolbarTimeout)})})),a.each("enabled active execute".split(" "),function(a,c){b[c]=function(a){if("function"==typeof a[c]&&("execute"!==c||b.enabled(c)!==!1)){var d=Array.prototype.slice.apply(arguments);return d.unshift(b),a[c].apply(a,d)}}}),b.typer.retainFocus(b.element)}function l(c,d){if(c.widget||!c.options.container)if(clearTimeout(o),n!==c&&(m(!0),n=c,a(c.element).appendTo(document.body)),d)c.position="fixed",a(c.element).css(d);else if("fixed"!==c.position){var e=b.createRange(c.typer.element).getBoundingClientRect(),f=a(c.element).height();e.top+e.height>document.body.offsetHeight?c.position="":e.top<f&&(c.position="bottom"),a(c.element).css({left:e.left+a(window).scrollLeft(),top:("bottom"===c.position?e.top+e.height+10:e.top-f-10)+a(window).scrollTop()})}}function m(b){clearTimeout(o),b?n&&(a(n.element).detach(),n.position="",n=null):o=setTimeout(function(){m(!0)},100)}var n,o,p={};b.widgets.toolbar={inline:!0,options:{container:"",controlActiveClass:"active",controlDisabledClass:"disabled",controlHiddenClass:"",controls:"",renderer:null,formattings:{h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",p:"Paragraph",ul:"Unordered List",ol:"Ordered List"},inlineClasses:{},prompt:f,selectLink:function(){return this.prompt("Enter URL")},selectImage:function(){return this.prompt("Enter Image URL")}},init:function(a){var b=a.widget;b.state={},b.controls=b.options.controls||"__root__",b.renderer=w[b.options.renderer]||w.default,k(b,b.options.container)},widgetInit:function(a,b){b.toolbar={typer:a.typer,widget:b,controls:"g:widget",renderer:a.widget.renderer,options:a.widget.options},k(b.toolbar)},focusin:function(a){l(a.widget)},focusout:function(a){setTimeout(m)},widgetFocusin:function(a,b){l(b.toolbar)},widgetFocusout:function(a,b){l(a.widget)},beforeStateChange:function(b){var c=b.typer.getSelection(),d={fontWeight:null,fontStyle:null,textDecoration:null,textAlign:null,inlineClass:null};a(c.selectedElements).each(function(b,c){a.each(d,function(b,f){var g;g="textAlign"===b?e(c):"inlineClass"===b?a(c).filter("span").attr("class")||"":a(c).css(b),d[b]=""===f||f&&f!==g?"":g})});var f=c.paragraphElements.slice(-1)[0];a(f).is("li")&&(f=a(f).closest("ol, ul")[0]||f);var g=f&&f.tagName.toLowerCase(),h=g+(a(f).attr("class")||"").replace(/^(.)/,".$1");b.widget.state={linkElement:c.getSelectedElements("a")[0]||null,bold:"bold"===d.fontWeight||"700"===d.fontWeight,italic:"italic"===d.fontStyle,underline:"underline"===d.textDecoration,superscript:c.getSelectedElements("sup").length>0,subscript:c.getSelectedElements("sub").length>0,insertUnorderedList:"ul"===g,insertOrderedList:"ol"===g,justifyLeft:"left"===d.textAlign,justifyCenter:"center"===d.textAlign,justifyRight:"right"===d.textAlign,inlineClass:d.inlineClass,formatting:g,formattingWithClassName:h}},stateChange:function(a){n&&(j(n),l(n))}};var q=c({type:"button"}),r=c({type:"dropdown",stateChange:function(b,c){a.each(c.controls,function(d,e){if(b.active(e))return a("select",c.element).prop("selectedIndex",d),c.selectedIndex=d,c.selectedValue=e.label||e.name,!1})},execute:function(a,b){a.execute(b.selectedIndex)},enabled:function(a,b){return b.controls.length>0}}),s=c({type:"group",hiddenWhenDisabled:!0},function(b,c){this.controls=b,a.extend(this,c)}),t=c({type:"textbox"}),u=c(q,function(a){this._super({dependsOn:a,execute:function(b){b.typer.invoke(a)},active:function(b){return b.state[a]},enabled:function(b){return!!b.state.formatting&&("indent"!==a&&"outdent"!==a||b.state.insertOrderedList||b.state.insertUnorderedList)}})}),v=c(q,function(b,c,d,e){this._super({execute:function(b){a.when((e||d)(b)).done(function(e){b.typer.invoke(function(b){if("object"!=typeof e){var f=e;e={},e[d]=f}b.insertHtml(a("<"+c+">",e)[0])})})}})});a.extend(p,{__root__:s("g:* -g:widget"),"g:history":s("history:*"),"g:insert":s("insert:*",{enabled:function(a){return a.typer.document.rootNode.nodeType!==b.NODE_EDITABLE_INLINE}}),"g:formatting":s("formatting:paragraph formatting:inlineStyle formatting:*",{enabled:function(a){return!!a.state.formatting}}),"formatting:bold":u("bold"),"formatting:italic":u("italic"),"formatting:underline":u("underline"),"formatting:unorderedList":u("insertUnorderedList"),"formatting:orderedList":u("insertOrderedList"),"formatting:indent":u("indent"),"formatting:outdent":u("outdent"),"formatting:justifyLeft":u("justifyLeft"),"formatting:justifyCenter":u("justifyCenter"),"formatting:justifyRight":u("justifyRight"),"formatting:paragraph":r({dependsOn:"formatting",hiddenWhenDisabled:!0,createChildren:function(b){return a.map(Object.keys(b.options.formattings||{}),function(a){return q({name:a,label:b.options.formattings[a],execute:function(){b.typer.invoke("formatting",a)},active:function(){return b.state.formattingWithClassName===a||b.state.formatting===a}})})}}),"formatting:inlineStyle":r({dependsOn:"applyClass",hiddenWhenDisabled:!0,createChildren:function(b){return a.map(Object.keys(b.options.inlineClass||{}),function(a){return q({name:a,label:b.options.inlineClass[a],execute:function(){b.typer.invoke("applyClass",a)},active:function(){return b.state.inlineClass===a}})})}}),"insert:anchor":v("insertAnchor","a","name",function(b){return a.when(b.options.prompt("Enter Anchor Name"))}),"insert:image":v("insertImage","img","src",function(b){return a.when(b.options.selectImage())}),"insert:link":q({dependsOn:"createLink",execute:function(b){a.when(b.options.selectLink({href:a(b.state.linkElement).attr("href"),target:a(b.state.linkElement).attr("target")})).done(function(a){b.typer.invoke("createLink",a)})},active:function(a){return!!a.state.linkElement}}),"history:undo":q({execute:function(a){a.typer.undo()},enabled:function(a){return a.typer.canUndo()}}),"history:redo":q({execute:function(a){a.typer.redo()},enabled:function(a){return a.typer.canRedo()}}),"g:widget":s("",{createChildren:function(b,c){if(b.widget){var d=[];return a(b.widget.element).is("img")&&d.push("media:filePicker(icon:insertImage) media:*"),d.push("widget:*"),c.controls=d.join(" "),g(b,c)}},enabled:function(a){return!!a.widget}}),"widget:delete":q({execute:function(a){a.widget.remove()},enabled:function(a){return!!a.widget}}),"media:filePicker":q({stateChange:function(b,c){c.label=(/(?:^|\/)([^\/]+)$/.exec(a(b.widget.element).attr("src"))||[])[1]||""},execute:function(b){var c=a(b.widget.element).attr("src");a.when(b.options.selectImage(c)).then(function(c){b.typer.invoke(function(d){a(b.widget.element).attr("src",c.src||c)})})}})});var w=c({group:'<div class="typer-ui-group" x:bind="(role:name)"><br x:t="children"/></div>',label:'<span class="typer-ui-label"><br x:t="labelIcon"/><br x:t="labelText"/></span>',labelText:'<span x:bind="(_:label)"></span>',labelIcon:"",button:'<button x:bind="(title:label,role:name)"><br x:t="label"/></button>',buttonExecuteOn:"click",dropdown:'<div class="typer-ui-dropdown" x:bind="(title:label,role:name)"><select><option x:t="children(t:dropdownItem)"/></select></div>',dropdownExecuteOn:"change",dropdownItem:'<option x:bind="(value:name,_:label)"></option>',children:i,getIcon:function(a,c){return(b.toolbar.icons[a.icon]||b.toolbar.icons[a.name]||"")[c]||""}});w.default=w(),w.material=w({resources:["https://fonts.googleapis.com/css?family=Roboto:400,500,700","https://fonts.googleapis.com/icon?family=Material+Icons","https://cdn.rawgit.com/misonou/jquery-typer/master/css/jquery.typer.material.css"],labelText:function(a,b){return this.getIcon(b,"material")?"":w.default.labelText},labelIcon:function(a,b){return this.getIcon(b,"material").replace(/(.+)/,'<i class="material-icons">$1</i>')},dropdown:'<div class="typer-ui-dropdown typer-ui-menu" x:bind="(role:name)"><button x:bind="(title:label)"><span class="typer-ui-label"><br x:t="labelIcon"/><span x:bind="(_:selectedValue)"></span></span></button><div class="typer-ui-controlpane"><br x:t="children"></div></div>',textbox:'<div class="typer-ui-textbox" x:bind="(role:name)"><label><br x:t="label"/><div spellcheck="false"></div></label></div>',textboxInit:function(b,c){a(c.element).toggleClass("empty",!c.value),a(">label>div",c.element).text(c.value||"").typer({inline:!0,lineBreak:!1,change:function(b,d){c.value=d,a(c.element).toggleClass("empty",!c.value)}})}}),b.toolbar={labels:{},icons:{},controls:p,renderer:w,button:q,dropdown:r,group:s,textbox:t},a.extend(b.toolbar.labels,{"formatting:bold":"Bold","formatting:italic":"Italic","formatting:underline":"Underlined","formatting:unorderedList":"Bullet List","formatting:orderedList":"Numbered List","formatting:indent":"Indent","formatting:outdent":"Outdent","formatting:justifyLeft":"Align Left","formatting:justifyCenter":"Align Center","formatting:justifyRight":"Align Right","formatting:paragraph":"Formatting","formatting:inlineStyle":"Text Style","insert:anchor":"Insert Anchor","insert:image":"Insert Photo","insert:link":"Insert Link","history:undo":"Undo","history:redo":"Redo","widget:delete":"Delete","media:filePicker":"Pick File"}),a.each({"formatting:bold":"format_bold","formatting:italic":"format_italic","formatting:underline":"format_underlined","formatting:unorderedList":"format_list_bulleted","formatting:orderedList":"format_list_numbered","formatting:indent":"format_indent_increase","formatting:outdent":"format_indent_decrease","formatting:justifyLeft":"format_align_left","formatting:justifyCenter":"format_align_center","formatting:justifyRight":"format_align_right","insert:anchor":"label","insert:image":"insert_photo","insert:link":"insert_link","insert:video":"videocam","history:undo":"undo","history:redo":"redo","widget:delete":"delete"},function(a,c){b.toolbar.icons[a]={},b.toolbar.icons[a].material=c})}(jQuery,window.Typer),function(a,b){"use strict";function c(a,b){return new Array(b+1).join(a)}function d(b,c,d){var e=a(">tbody>tr",b.widget.element).eq(Math.max(0,b.widget.row+c)).children()[Math.max(0,b.widget.column+d)];b.normalize(b.widget.element),b.moveCaret(e,-0)}var e="<td></td>",f="<th></th>",g="<tr>%</tr>";b.widgets.table={element:"table",editable:"th,td",beforeStateChange:function(b){var c=b.typer.getSelection(),d=c.getEditableElements(b.widget),e=d.length>1?-1:a(d).index(),f=d.length>1?-1:a(d).parent().index();a.extend(b.widget,{row:f,rowCount:a(">tbody>tr",b.widget.element).length,rowCells:a(">tbody>tr:nth-child("+(f+1)+")>*",b.widget.element).get(),column:e,columnCount:a(">tbody>tr:first>*",b.widget.element).length,columnCells:a(">tbody>tr>*:nth-child("+(e+1)+")",b.widget.element).get()})},tab:function(b){var c=a(">tbody>tr>*",b.widget.element).get(),d=b.widget.row*b.widget.columnCount+b.widget.column;d<c.length-1&&b.typer.moveCaret(c[d+1])},shiftTab:function(b){var c=a(">tbody>tr>*",b.widget.element).get(),d=b.widget.row*b.widget.columnCount+b.widget.column;d>0&&b.typer.moveCaret(c[d-1],-0)},ctrlEnter:function(a){0===a.widget.row&&0===a.widget.column?a.typer.invoke("insertSpaceBefore"):a.widget.row===a.widget.rowCount-1&&a.widget.column===a.widget.columnCount-1&&a.typer.invoke("insertSpaceAfter")},commands:{justifyLeft:function(b){a(b.selection.getEditableElements(b.widget)).attr("align","left")},justifyCenter:function(b){a(b.selection.getEditableElements(b.widget)).attr("align","center")},justifyRight:function(b){a(b.selection.getEditableElements(b.widget)).attr("align","right")},addColumnBefore:function(b){a(b.widget.columnCells).filter("th").before(f),a(b.widget.columnCells).filter("td").before(e),d(b,0,0)},addColumnAfter:function(b){a(b.widget.columnCells).filter("th").after(f),a(b.widget.columnCells).filter("td").after(e),d(b,0,1)},addRowAbove:function(b){a(b.widget.rowCells).before(g.replace("%",c(e,b.widget.columnCount))),d(b,0,0)},addRowBelow:function(b){a(b.widget.rowCells).after(g.replace("%",c(e,b.widget.columnCount))),d(b,1,0)},removeColumn:function(b){a(b.widget.columnCells).remove(),d(b,0,-1)},removeRow:function(b){a(b.widget.rowCells).remove(),d(b,-1,0)},toggleTableHeader:function(b){a(b.widget.element).find("th")[0]?(a(b.widget.element).find("tr:has(th)").remove(),0===b.widget.row&&d(b,0,0)):(a(b.widget.element).find("tbody").prepend(g.replace("%",c(f,b.widget.columnCount))),d(b,-b.widget.row,-b.widget.column))},insertSpaceBefore:function(a){a.select(a.widget.element,b.COLLAPSE_START_OUTSIDE),a.insertText("")},insertSpaceAfter:function(a){a.select(a.widget.element,b.COLLAPSE_END_OUTSIDE),a.insertText("")}}}}(jQuery,window.Typer);
//# sourceMappingURL=jquery.typer.min.js.map