/*! jQuery Typer Plugin v0.9.0-beta | https://github.com/misonou/jquery-typer | The MIT License (MIT) */

!function(a,b,c,d,e,f,g,h,i){"use strict";function j(a){B(a,j)&&Object.getOwnPropertyNames(a).filter(function(a){return!j.prototype.hasOwnProperty(a)}).forEach(function(b){this[b]=a[b]},this)}function k(a,b,c,d){this.typer=a,this.id=b,this.element=c||null,this.options=d||{}}function l(a,b,c){this.eventName=a,this.typer=b,this.widget=c||null}function m(a,b,c){this.childNodes=[],this.nodeType=a,this.element=b,this.widget=c}function n(a,b,c){this.whatToShow=b,this.filter=c||null,this.currentNode=a,this.root=a}function o(a,b,c){this.whatToShow=b,this.filter=c||null,this.typerNodeIterator=B(a,n)||new n(a,oa|za)}function p(a,b,c){clearTimeout(p[a.name]),p[a.name]=b&&setTimeout(b,c)}function q(a,b){a.prototype=b,Object.defineProperty(b,"constructor",{configurable:!0,writable:!0,value:a})}function r(b,c){a.each(c,function(a,c){Object.defineProperty(b,a,{enumerable:!0,configurable:!0,get:function(){return Object.defineProperty(this,a,{enumerable:!0,writable:!0,value:c.apply(this)}),this[a]}})})}function s(a,b,c){return i.slice.call(a||{},b||0,c)}function t(a){return t[a]=t[a]||function(b){return b[a]},t[a]}function u(a,b){var c=(b||a.currentNode||"").nodeType;return a.whatToShow&(B(a,n)?c:1<<c-1)?a.filter?(a.filter.acceptNode||a.filter).call(a.filter,b||a.currentNode):1:3}function v(a,b,c){a.currentNode=c||a.currentNode;var d=u(a);if(2!==d)for(1===d&&b&&b(a.currentNode);a.nextNode();b&&b(a.currentNode));}function w(b,c,d){var e=[];return v(b,i.push.bind(e),d),c?a.map(e,c):e}function x(a){return d(a||"").replace(/^[\s\u200b]+|[\s\u200b]+$/g,"")}function y(a){return a=d(a||""),a.charAt(0).toUpperCase()+a.slice(1)}function z(a){return a=d(a||""),a.charAt(0).toLowerCase()+a.slice(1)}function A(a){return a&&a.tagName&&a.tagName.toLowerCase()}function B(b,c){return!(!b||!c)&&(c.prototype?b instanceof c&&b:c.toFixed?b.nodeType&c&&b:("*"===c||a(b).is(c))&&b)}function C(b){var c={};return a.each(a.makeArray(b&&b.attributes),function(a,b){c[b.nodeName]=b.value}),c}function D(b,c){var d=C(b),e=C(c);return a.each(e,function(a,b){b===d[a]&&(delete d[a],delete e[a])}),!Object.keys(d)[0]&&!Object.keys(e)[0]}function E(a,b,c){if(a===b)return 0;var d=a&&b&&a.compareDocumentPosition(b);return 2&d?c&&8&d||1&d?NaN:1:4&d?c&&16&d||1&d?NaN:-1:NaN}function F(b,c){return b===c||a.contains(b,c)}function G(a,b){var c=a.length||a.childNodes.length;return b===c||0===b&&1/b===-(1/0)?c:(c+b)%c||0}function H(a,b,d,g){if(B(a,j)){var h=a;a=h.startTextNode||h.startElement,d=h.endTextNode||h.endElement,b=1===a.nodeType?!h.isCaret||h.caretPosition<=0:h.startOffset,g=1===d.nodeType?!!h.isCaret&&h.caretPosition<=0:h.endOffset}var i,k=+b===b;if(B(a,e)?(i=c.createRange(),d?(k?i.setStart(a,G(a,b)):i[b?"setStartBefore":"setStartAfter"](a),B(d,e)&&(+g===g?i.setEnd(d,G(d,g)):i[g?"setEndBefore":"setEndAfter"](d))):(i[b===!0||k&&1&b?"selectNodeContents":"selectNode"](a),k&&2&b&&i.collapse(!!(4&b)))):B(a,f)&&(i=a.cloneRange(),i.collapsed||("boolean"==typeof b?i.collapse(b):k&&2&b&&i.collapse(!!(4&b)))),B(b,f)){var l=i.collapsed&&b.collapsed?-1:1;i.compareBoundaryPoints(0,b)*l<0&&i.setStart(b.startContainer,b.startOffset),i.compareBoundaryPoints(2,b)*l>0&&i.setEnd(b.endContainer,b.endOffset)}return i}function I(a,b){return a=B(a,f)||H(a,!0),b=B(b,f)||H(b,!0),a&&b&&!(1&a.startContainer.compareDocumentPosition(b.startContainer))&&a.compareBoundaryPoints(3,b)<=0&&a.compareBoundaryPoints(1,b)>=0}function J(a,b){return a=B(a,f)||H(a,!0),b=B(b,f)||H(b,!0),a&&b&&!(1&a.startContainer.compareDocumentPosition(b.startContainer))&&a.compareBoundaryPoints(0,b)<=0&&a.compareBoundaryPoints(2,b)>=0}function K(a,b,c){a=B(a,f)||H(a,!0),b=B(b,f)||H(b,!0);var d=a&&b&&1&a.startContainer.compareDocumentPosition(b.startContainer)?NaN:a.compareBoundaryPoints(0,b)+a.compareBoundaryPoints(2,b);return c&&(0!==d&&I(a,b)||0===d&&(!J(a,b)||!J(b,a)))?NaN:d&&d/Math.abs(d)}function L(a){ca||setTimeout(function(){ca=!1}),ca=!0,a()}function M(a,b){function d(c){var d=c.left>a?c.left-a:Math.min(0,c.left+c.width-a),e=c.top>b?c.top-b:Math.min(0,c.top+c.height-b);return d&&e?e>0?1/0:-(1/0):d||e}function e(a,b){return d(H(a,b,!0).getClientRects()[0]||{})}if(c.caretRangeFromPoint)return c.caretRangeFromPoint(a,b);if(c.caretPositionFromPoint){var f=c.caretPositionFromPoint(a,b);return H(f.offsetNode,f.offset,!0)}if(c.body.createTextRange){for(var g,h,i=c.elementFromPoint(a,b);g!==1/0;g=1/0,i=h||i)for(var j=0,k=i.childNodes.length;j<k;j++){var l=i.childNodes[j];if(1===l.nodeType&&"br"!==A(l)){var m=Math.abs(d(l.getBoundingClientRect()));if(m>g)break;g=m,h=l}else if(3===l.nodeType&&e(l,l.length-1)>0){for(var n=0,o=l.length;o-n>1;){var p=o+n>>1,q=e(l,p)<0;n=q?p:n,o=q?o:p}return H(l,Math.abs(e(l,n))<Math.abs(e(l,o))?n:o,!0)}}return H(i,ma)}}function N(a){var b=a.startTextNode,c=a.endTextNode,d=b===c;c&&a.endOffset<c.length&&c.splitText(a.endOffset),b&&a.startOffset>0&&(a.startTextNode=b.splitText(a.startOffset),d&&(a.endTextNode=a.startTextNode,a.endOffset-=a.startOffset),a.startOffset=0)}function O(b){return B(b,g)||a(c.createDocumentFragment()).append(b)[0]}function P(a){return c.createTextNode(x(a)||ha)}function Q(a){return c.createElement(a)}function R(b,c){return a.each(c,function(c,d){b=a(d.cloneNode(!1)).append(b)[0]}),B(b,e)||O(b)}function S(t,u){function G(){this.originalSelection=new j(Pa)}function T(a){switch(a){case Aa:return Ta.concat(Pa.widgets);case Ba:return Ta;case Ca:return Pa.widgets.slice(0).reverse().concat(Ta);case Da:return Pa.widgets.slice(-1)}}function U(b,c,d){var e,f=a.makeArray(B(b,k)||T(b));return a.each(f,function(a,f){var g=Ua[f.id];if(Fa(g[c]))return e=!0,g[c].call(g,new l(c,Ra,f),d)!==!1||b!==Ca}),B(b,k)&&setTimeout(function(){U(Ba,"widget"+y(c),b)}),e}function V(){if(Ga.rangeCount){var a=Ga.getRangeAt(0);return F(t,a.commonAncestorContainer)&&a}}function W(c,d){function e(a,b){if(b.parentNode!==a&&b!==a){b.parentNode&&f(b,!0);for(var c=a.childNodes.length;c&&K(b.element,a.childNodes[c-1].element)<0;c--);b.parentNode=a,b.previousSibling=a.childNodes[c-1],b.nextSibling=a.childNodes[c],(b.previousSibling||{}).nextSibling=b,(b.nextSibling||{}).previousSibling=b,a.childNodes.splice(c,0,b)}}function f(a,b){if(a.parentNode){var c=a.parentNode.childNodes.indexOf(a);c>=0&&(d&&!b&&a.widget.element===a.element&&(a.widget.destroyed=!0,U(a.widget,"destroy")),a.parentNode.childNodes.splice(c,1),a.parentNode=null,(a.previousSibling||{}).nextSibling=a.nextSibling,(a.nextSibling||{}).previousSibling=a.previousSibling)}}function j(b,d){d=d||b.parentNode||v.get(c),B(d,oa)||b.widget&&B(b.element,Ua[b.widget.id].element)||(delete b.widget,a.each(Ua,function(a,c){if(B(b.element,c.element))return b.widget=new k(Ra,a,b.element,c.options),!1})),b.widget=b.widget||d.widget;var e=Ua[b.widget.id];b.widget!==d.widget||B(d,oa)?B(b.element,e.editable)||e.inline&&!e.editable?b.nodeType=e.inline?va:B(b.element,ga)?qa:pa:b.nodeType=e.inline&&!B(d,ua)?ua:oa:b.nodeType=B(b.element,ga)?ra:ta}function l(b){a.each(b.childNodes.slice(0),function(a,b){F(c,b.element)||(f(b),v.delete(b.element))})}function n(b,c){var h=[v.get(b)];l(h[0]);var i=c?a(b).children():B(b,g)?a(b).children().find("*").andSelf():a("*",b);i.each(function(a,b){for(;!F(h[0].element,b);)h.shift();if("br"===A(b))return void(v.has(b)&&B(h[0],za)&&(f(v.get(b)),v.delete(b)));var g=!v.has(b),i=v.get(b)||new m(0,b),k=i.widget;e(h[0],i),l(i),j(i),i.widget!==k&&d&&(k&&(k.destroyed=!0,U(k,"destroy")),U(i.widget,"init")),v.set(b,i),c&&g&&n(b),h.unshift(i)})}function o(b){var c=a.map(b,function(b){return a(b.addedNodes).add(b.removedNodes).filter(":not(#Typer_RangeStart,#Typer_RangeEnd)")[0]?b.target:null});i.push.apply(w,c)}function q(a){for(var b=a;!v.has(b);b=b.parentNode);return n(b),v.get(a)}function r(){s?o(s.takeRecords()):p(r,function(){w.push(null)}),null===w[0]?n(w.splice(0)&&c):w[0]&&a(c.parentNode||c).find(a.unique(w.splice(0))).each(function(a,b){n(b,!!s)})}var s,v=new h,w=[];return c.parentNode||(c=B(c,g)||O(c)),b.MutationObserver&&d&&(s=new MutationObserver(o),s.observe(c,{subtree:!0,childList:!0})),v.set(c,new m(Sa,c,new k(Ra,"__root__",t,u))),w.push(null),{get rootNode(){return this.getNode(c)},getNode:function(a){if(F(c,a))return 3!==a.nodeType&&"br"!==A(a)||(a=a.parentNode),r(),v.get(a)||q(a)}}}function X(b){var c;return a.each(T(Ca),function(a,d){return c=Fa((Ua[d.id].commands||{})[b])&&d,!c}),c}function Y(a,b,d,e){var f=H(a,b,d,e);f&&(Pa=_(f)),F(c,t)&&(Ga.removeAllRanges(),f&&Ga.addRange(H(Pa)))}function Z(a,b){if(a&&3!==a.nodeType){var c=new o(Oa.getNode(a),4);if(b)for(;c.nextNode()&&b>c.currentNode.length;b-=c.currentNode.length);else if(1/b<0){for(;c.nextNode(););b=c.currentNode.length}a=c.currentNode}return H(a,+b===b?b:0,!0)}function $(a){var b=a.commonAncestorContainer;if(a.startContainer===a.endContainer&&a.endOffset-a.startOffset<=1&&(b=B(b.childNodes[a.startOffset],Element)||b),!F(t,b))return Oa.rootNode;var c=Oa.getNode(b);return B(c,oa)?Oa.getNode(c.widget.element):c}function _(b){function c(a,b,c){var d;"br"===A(a)?(d=a.nextSibling,b=0):1===a.nodeType&&a.childNodes[0]&&(c||b===a.childNodes.length?(a=a.childNodes[(b||1)-1],3===a.nodeType&&(d=a,a=d.parentNode,b=d.length),c=!0):(a=a.childNodes[b],!c&&b&&1===a.nodeType&&1===a.previousSibling.nodeType&&(a=a.previousSibling,c=!0),b=0)),3===a.nodeType&&(d=a,a=a.parentNode);for(var e=Oa.getNode(a);e.parentNode&&B(e,ya)&&!B(e.parentNode,xa);)e=e.parentNode;if(B(e,oa|pa))a=e.widget.element,d=null;else if(!d&&1===a.nodeType){var f=new o(e,4);for(f.currentNode=a;f.nextNode()&&c;);d=f.currentNode,b=c?d&&d.length:0}return{node:e,element:a,textNode:d,offset:b}}F(t,b.commonAncestorContainer)||(b=H(t,!0));var d=c(b.startContainer,b.startOffset),e=b.collapsed?d:c(b.endContainer,b.endOffset,!0);return a.extend(new j,{isCaret:b.collapsed,caretPosition:b.collapsed&&K(b,d.node.element)||0,focusNode:$(b),startNode:d.node,startElement:d.element,startTextNode:d.textNode||null,startOffset:d.offset||0,endNode:e.node,endElement:e.element,endTextNode:e.textNode||null,endOffset:e.offset||0})}function aa(a){var b=V();(b||a===!0)&&(Pa=_(b||H(Pa))),a!==!1&&(U(Aa,"beforeStateChange"),U(Aa,"stateChange"))}function ba(b){B(b,"li:only-child")&&(b=b.parentNode),a(b).remove()}function sa(b){b=B(b,f)||H(b||t,!0),aa(!1),L(function(){var c=_(b);return B(c.focusNode,pa)&&!c.focusNode.childNodes[0]?void a(ja).appendTo(c.focusNode.element):B(c.focusNode,qa)&&!c.focusNode.childDOMNodes[0]?void a(P(ha)).appendTo(c.focusNode.element):(v(c.createTreeWalker(-1),function(b){if(B(b,za)){var c=a("br:last-child",b.element)[0];c&&!c.nextSibling&&(a(P()).insertBefore(c),ba(c));var d=a("br:first-child",b.element)[0];d&&!d.previousSibling&&ba(d);var f;a(b.childDOMNodes).each(function(a,b){3===b.nodeType&&(b.nodeValue?b.length>1&&(b.previousSibling||b.nextSibling)&&(b.nodeValue.charAt(0)===ha?(b=b.splitText(1),ba(b.previousSibling)):b.nodeValue.slice(-1)===ha?(b.splitText(b.length-1),ba(b.nextSibling)):/\b\u00a0$/.test(b.nodeValue)&&b.nextSibling&&3===b.nextSibling.nodeType&&!/^[^\S\u00a0]/.test(b.nextSibling.nodeValue)&&(b.nodeValue=b.nodeValue.slice(0,-1)+" ")):!b.previousSibling&&!b.nextSibling||"br"===A(b.previousSibling)?b.nodeValue=ha:Pa&&!K(b,Pa,!0)||ba(b),f=!0)}),f||a(P()).appendTo(b.element)}B(b.element,e)&&(B(b,oa)||Pa&&I(Pa,b.element)||(b.element.normalize(),B(b,ta)?A(b.element.previousSibling)===A(b.element)&&D(b.element,b.element.previousSibling)?(a(b.element).contents().appendTo(b.element.previousSibling),ba(b.element)):fa.indexOf(A(b.element))<0&&0===b.element.childElementCount&&!x(b.element.textContent)&&ba(b.element):B(b,pa)?(a(b.element).contents().each(function(b,c){3===c.nodeType&&(x(c.nodeValue)?a(c).wrap("<p>"):ba(c))}),b.element.childNodes[0]||a(ja).appendTo(b.element)):B(b,qa)&&a(P(ha)).appendTo(b.element)))}),a('br[type="_moz"]',t).remove(),void a(Ea&&"*",t).each(function(b,c){a(c).data("typerIEFix")||(a(c).data("typerIEFix",!0),a(c).bind("input textinput",function(a){ca||Wa.trigger(a)}))}))})}function Ha(b,d,h){b=B(b,f)||H(b);var i="cut"===d?"extractContents":"paste"===d?"deleteContents":"cloneContents",j="paste"!==d,k="copy"!==d,l=c.createDocumentFragment(),m=_(b),n=m.isSingleEditable;if(!b.collapsed){var o=[[t,l]];v(m.createTreeWalker(-1,function(c){for(;B(c.element,e)&&!F(o[0][0],c.element);)o.shift();if(J(b,c.element))return j&&a(o[0][1]).append(c.cloneDOMNodes(!0)),k&&(B(c,pa)?a(c.element).html(ja):B(c,qa)?a(c.element).html(ia):ba(c.element)),2;var d=B(c,za)&&H(c.element,b)[i]();if(j){if(c.element!==t&&(!B(c,ra|ta)||d&&A(d.firstChild)!==A(c.element))){var f=c.cloneDOMNodes(!1);o[0][1].appendChild(f),B(f,g)||o.unshift([c.element,f])}d&&o[0][1].appendChild(d)}return B(c,za)?2:1}))}if(Fa(h)){var p=H(b,!0),q=n?H(b,!1):p,r=_(H(p,q));B(r.startNode,xa)&&r.startNode===r.endNode&&(sa(b),r=_(H(r.startNode.element,!0))),K(p,r.startNode.element)<0&&(p=H(r.startNode.element,ka)),h(r,p,q)}else sa(b);return aa(!1),l}function Ia(b,c){B(c,e)||(c=d(c||"").replace(/\u000d/g,"").replace(/</g,"&lt;").replace(/\n{2,}/g,"</p><p>").replace(/\n/g,"<br>").replace(/.+/,"<p>$&</p>").replace(/<p>(<|$)/g,"<p>"+ia+"$1")||ja),c=s(O(c).childNodes),Ha(b,"paste",function(b,d,e){var f,g,h,i=("__root__ "+(Ua[b.focusNode.widget.id].allowedWidgets||"*")).split(" "),j=d.cloneRange(),k=B(b.startNode,za),l=!0;for(h=B(startNode,qa)?[]:B(startNode,ra)?[startNode.element]:B(startNode,ya)?a(b.startElement).parentsUntil(startNode.element).andSelf().get().reverse():[Q("p")];c[0];){var n=c.shift(),o=new m(ta,n);if(1===n.nodeType&&"br"!==A(n)&&(d.insertNode(n),o=Oa.getNode(n),ba(n),("__unknown__"===o.widget.id||"*"!==i[1]&&i.indexOf(o.widget.id)<0)&&(n=P("__unknown__"===o.widget.id?n.textContent:Ja(n)),o=new m(ta,n))),!B(o,za)||!B(o,ya)&&!l){var p=H($(j).element,na),q=H(e,p).extractContents(),r=q.childNodes[0];p.insertNode(q),j=H(r||p,ka),g=g||j.cloneRange(),e=H(p,!1),l=!0,f=!0}k=k&&B(o,za),B(o,ya)?n=R(n,k?h.slice(0,-1):h):k&&l&&(n=O(n.childNodes)),k?(j.insertNode(n),j.collapse(!1),l=!1):(H($(j).element,la).insertNode(n),j=H(n,ma),k=B(o,za),f=!0)}!f&&b.startNode!==b.endNode&&B(b.startNode,ra)&&B(b.endNode,ra)&&(H(b.startNode.element,ma).insertNode(H(b.endNode.element,!0).extractContents()),ba(b.endNode.element)),sa(H(d,e)),Y(g||j,!0)})}function Ja(b){F(t,b)&&(b=Ha(b,"copy"));var c="",d=W(b);return a.each(d.rootNode.childNodes,function(a,b){return B(b,oa|pa)&&Fa(Ua[b.widget.id].text)?void(c+=(c&&"\n\n")+Ua[b.widget.id].text(b.widget)):void v(new n(b,za|wa,function(a){return c+=c&&"\n\n",v(new o(a,5,function(a){c+=a.nodeValue||("br"===A(a)?"\n":"")})),2}))}),c}function Ka(){function b(){var a=x(t.innerHTML.replace(/\s+x-typer-(start|end)(="\d+")?|(?!>)\u200b(?!<\/)/g,""));if(a!==h)return U(Aa,"change",a),h=a,!0}function c(b,c,d){if(b&&3===b.nodeType){var e=0;a.each(w(new o(Oa.getNode(b),4)),function(a,d){return e+=d===b?c:d.length,d!==b}),a(b.parentNode).attr(g[+d],e)}else b&&a(b).attr(g[+d],"")}function d(b){var c=g[+b],d=Wa.find("["+c+"]")[0]||Wa.filter("["+c+"]")[0],e=parseInt(a(d).attr(c));if(d)return a(d).removeAttr(c),+e===e?Z(d,e):H(d,b?la:na)}function e(){aa(!0),c(Pa.startTextNode||Pa.startElement,Pa.startOffset,!0),Pa.isCaret||c(Pa.endTextNode||Pa.endElement,Pa.endOffset,!1);var a=t.outerHTML;if(a!==i[0]){var d=b();i.splice(0,j+!d,a),i.splice(u.historyLevel),j=0}Wa.find("[x-typer-start], [x-typer-end]").andSelf().removeAttr("x-typer-start x-typer-end")}function f(c){var e=a.parseHTML(c)[0];Wa.empty().append(e.childNodes).attr(C(e)),Y(d(!0),d(!1)),aa(!0),b()}var g=["x-typer-end","x-typer-start"],h=t.outerHTML,i=[h],j=0;a.extend(Va,{canUndo:function(){return j<i.length-1},canRedo:function(){return j>0},undo:function(){Va.canUndo()&&f(i[++j])},redo:function(){Va.canRedo()&&f(i[--j])},snapshot:function(a){p("snapshot"),a?p("snapshot",e,a):a!==!1&&e()}})}function La(){function e(){var a=n;n&&!n.destroyed&&(n=null,U(a,"focusout"))}function f(a){setTimeout(function(){Va.snapshot(a.timeStamp-q<50?50:0),q=a.timeStamp})}function g(a){if(!/(backspace|(?:left|shiftLeft|up|shiftUp)Arrow)|(delete|(?:right|shiftRight|down|shiftDown)Arrow)/g.test(a))return!1;var b=RegExp.$1?-1:1,c=b<0?Pa.textStart:Pa.textEnd;switch(a){case"backspace":case"delete":var d=b<0?Pa.previousTextNode:Pa.nextTextNode;if(Pa.isCaret&&Pa.startTextNode&&!c)return!1;if(Pa.isCaret)if(Pa.startTextNode)d?b<0?Ia(H(d,-0,Pa.startTextNode,0),""):Ia(H(Pa.startTextNode,-0,d,0),""):(Pa.textStart&&Pa.textEnd&&ba(Pa.startElement),Y(b<0?Pa.previousNode.element:Pa.nextNode.element));else{if(Pa.caretPosition===b)return Y(d,b<0?ma:ka),!1;Y(Pa.startElement)}else Ia(Pa,"");return!0;case"leftArrow":case"rightArrow":case"shiftLeftArrow":case"shiftRightArrow":var e=b<0?Pa.previousTraversableTextNode:Pa.nextTraversableTextNode;if(c&&e){if("s"!==a.charAt(0))return Y(Z(e,0*b)),!0;var f=Oa.getNode(e).widget;if(f!==Pa.focusNode.widget)return Y(H(f.element,la),H(Pa)),!0}break;case"upArrow":case"downArrow":case"shiftUpArrow":case"shiftDownArrow":Pa.isCaret&&(o=b);for(var g=H(Pa),h=H(g,o<0),i=h.getBoundingClientRect(),j=i.top+(b>0&&i.height);!0;j+=5*b){var k=M(i.left,j);if(!k||!F(t,k.startContainer))return!1;var l=k.getBoundingClientRect();if(K(k,h)&&l.top!==i.top&&!B($(k),oa))return k=M(i.left,l.top+l.height/2),Y(k,"s"!==a.charAt(0)||H(g,o>0)),!0}}}var h,i,j,k,l,m,n,o,q=0;Wa.mousedown(function(b){var d=M(b.clientX,b.clientY),e={mousemove:function(a){if(!a.which&&h)return void e.mouseup();var b=H(d,M(a.clientX,a.clientY));Y(_(b)),p(La,aa),a.preventDefault()},mouseup:function(){h=!1,a(c.body).unbind(e),p(La,function(){aa(),sa(Pa.focusNode.element),Va.snapshot()})}};a(c.body).bind(e),h=!0,b.stopPropagation()}),Wa.bind("compositionstart compositionupdate compositionend",function(a){a.stopPropagation(),i="end"!==a.type.substr(-3)}),Wa.bind("keydown keypress keyup",function(b){if(b.stopPropagation(),i)return void b.stopImmediatePropagation();m=!0,setTimeout(function(){m=!1});var c=a.inArray(b.keyCode,[16,17,18,91,93])>=0,h=!c&&ea[b.keyCode]!==d.fromCharCode(b.keyCode).toLowerCase();if("keydown"===b.type){if(j=b.ctrlKey+b.shiftKey+b.altKey+b.metaKey+!c,j*=h||(j>2||j>1&&!b.shiftKey)&&!c,k=b.keyCode,j){var o=z((b.ctrlKey||b.metaKey?"Ctrl":"")+(b.altKey?"Alt":"")+(b.shiftKey?"Shift":"")+y(ea[k]||d.fromCharCode(b.charCode)));if(U(Ca,o)||g(o)&&(Va.snapshot(),1)||/ctrl(?![axcvr]$)|alt|enter/i.test(o))return l=!0,void b.preventDefault()}l=!1,p(La,function(){aa(),sa(Pa.focusNode.element),Pa.focusNode.widget!==n&&e()})}else"keypress"===b.type?!j&&b.charCode||b.stopImmediatePropagation():((b.keyCode===k||c)&&j--&&b.stopImmediatePropagation(),l||c||(aa(),f(b)))}),Wa.bind("compositionstart keypress textInput textinput",function(a){if(Va.snapshot(!1),!Pa.startTextNode||Pa.paragraphElements[1]){"compositionstart"!==a.type&&a.preventDefault();var b=a.originalEvent.data||d.fromCharCode(a.charCode)||"";if(Pa.startTextNode||!U(Da,"textInput",b))return Ia(Pa,b),void Va.snapshot()}f(a)}),Wa.bind("dragstart",function(a){var b=H(Pa),c={drop:function(a){var d=M(a.originalEvent.clientX,a.originalEvent.clientY),e=Ha(b,a.ctrlKey?"copy":"cut");Ia(d,e),Va.snapshot(),a.preventDefault(),Wa.unbind(c)}};Wa.bind(c),a.stopPropagation()}),Wa.bind("cut copy",function(c){var d=c.originalEvent.clipboardData||b.clipboardData,e=Ha(Pa,c.type),f=Ja(e);b.clipboardData?d.setData("Text",f):(d.setData("text/plain",f),d.setData("text/html",a('<div id="Typer">').append(e)[0].outerHTML),d.setData("application/x-typer","true")),c.stopPropagation(),c.preventDefault()}),Wa.bind("paste",function(c){var d=c.originalEvent.clipboardData||b.clipboardData;if(a.inArray("application/x-typer",d.types)>=0){var e=d.getData("text/html"),f=O(a(e).filter("#Typer").contents());Ia(Pa,f)}else a.inArray("text/plain",d.types)>=0?Ia(Pa,d.getData("text/plain")):b.clipboardData&&Ia(Pa,d.getData("Text"));Va.snapshot(),c.stopPropagation(),c.preventDefault(),Ea&&setTimeout(function(){Y(Pa)})}),Wa.bind("mousedown mouseup mscontrolselect",function(a){var b=Oa.getNode(a.target);n!==b.widget&&e();V();B(b,oa|ua)&&(Ea&&setTimeout(function(){Y(b.widget.element)}),Y(b.widget.element),n!==b.widget&&(n=b.widget,U(b.widget,"focusin")))}),Wa.bind("focusin",function(){setTimeout(function(){Qa||(U(Aa,"focusin"),h||Y(Pa)),da=!1,Qa=null})}),Wa.bind("focusout",function(){setTimeout(function(){da||Qa||(e(),U(Aa,"focusout"))})})}function Ma(b,c){!u[b]&&!u.widgets[b]||!c.inline&&Sa!==pa||(Ua[b]=Object.create(c),Ua[b].options=a.extend(Object.create(c.options||null),u[b]),c.element||Ta.push(new k(Ra,b,null,Ua[b].options)))}function Na(){Ta[0]=new k(Ra,"__core__"),Ta[1]=new k(Ra,"__root__"),a.each(u.widgets,Ma),a.each(S.widgets,Ma),Ua.__root__=u,Ua.__core__={ctrlZ:Va.undo,ctrlY:Va.redo,ctrlShiftZ:Va.redo,escape:function(){t.blur(),Y()}},Ua.__unknown__={element:u.disallowedElement||":not("+ga+",br,b,em,i,u,strike,small,strong,sub,sup,ins,del,mark,span)"}}B(t,e)||(u=t,t=t.element),u=a.extend(!0,{},S.defaultOptions,u);var Oa,Pa,Qa,Ra=this,Sa=u.inline||B(t,ga)?qa:pa,Ta=[],Ua={},Va={},Wa=a(t);Ka(),Na(),La();var Xa={focusin:function(a){Qa=a.currentTarget},focusout:function(a){var b=a.currentTarget;setTimeout(function(){Qa!==b||V()||(Qa=null,Wa.trigger("focusout"))})}};a.extend(Ra,{element:t,canUndo:Va.canUndo,canRedo:Va.canRedo,undo:Va.undo,redo:Va.redo,hasCommand:function(a){return!!X(a)},widgetEnabled:function(a){return Ua.hasOwnProperty(a)},getStaticWidgets:function(){return Ta.slice(0)},getSelection:function(){return new j(Pa)},nodeFromPoint:function(a,b){return Oa.getNode(c.elementFromPoint(a,b))},select:function(a,b,c,d){Y(a,b,c,d),Va.snapshot()},moveCaret:function(a,b){Y(Z(a,b)),Va.snapshot()},retainFocus:function(b){a(b).bind(Xa)},invoke:function(a,b){L(function(){var c=new G;"string"==typeof a&&(c.commandName=a,c.widget=X(a),a=c.widget&&Ua[c.widget.id].commands[a]),Fa(a)&&a.call(Ra,c,b)}),Va.snapshot()}}),q(G,{typer:Ra,widget:null,remove:ba,normalize:sa,invoke:Ra.invoke,hasCommand:Ra.hasCommand,select:Y,moveCaret:function(a,b){Y(Z(a,b))},insertText:function(a){Ia(Pa,a)},insertHtml:function(a){Ia(Pa,O(a))},insertWidget:function(a,b){Ua[a]&&Fa(Ua[a].insert)&&Ua[a].insert(this,b)},removeWidget:function(b){if(Fa(Ua[b.id].remove))Ua[b.id].remove(this,b);else if("keepText"===Ua[b.id].remove){var c=Ja(b.element);a(b.element).replaceWith(P(c))}else ba(b.element)},execCommand:function(a,b){Y(Pa),c.execCommand(a,!1,b||""),aa(!1)},getSelectedText:function(){var a=Ha(Pa,"copy");return Ja(a)},getSelectedTextNodes:function(){return N(Pa),a.map(Pa.selectedElements,function(b){return a.grep(b.childNodes,function(a){return 3===a.nodeType&&E(Pa.startTextNode,a)<=0&&E(Pa.endTextNode,a)>=0})})},restoreSelection:function(){Y(this.originalSelection)}}),r(G.prototype,{selection:function(){return new j(Pa)}}),Wa.attr("contenteditable","true"),Oa=this.document=W(t,!0),Pa=_(H(t,ka)),sa(),U(Ba,"init")}function T(a,b){return b&&(a.whatToShow&wa||!B(b,oa|xa))}function U(a,b,c){return c&&!T(a,b)?2:B(b,oa)&&B(b.parentNode,oa)?3:u(a,b)}function V(a,b,c){if(U.returnValue=U(a,b,c),1===U.returnValue)return a.currentNode=b,!0}function W(a,b,c){for(var d=a.currentNode[b];d;){if(V(a,d,!0))return d;if(3===U.returnValue&&d[b])d=d[b];else{for(;!d[c];)if(d=T(a,d.parentNode)&&d.parentNode,!d||d===a.root||d===a.currentNode)return null;d=d[c]}}}function X(a,b,c){for(var d=a.currentNode;d&&d!==a.root;){for(var e=d[c];e;){if(V(a,e))return e;e=2!==U.returnValue&&e[b]?e[b]:e[c]}if(d=T(a,d.parentNode)&&d.parentNode,!d||d===a.root||1===U(a,d,!0))return null}}function Y(a,b){var d=a.typerNodeIterator.currentNode;if(!B(d,za))return c.createNodeIterator(d.element,0,null,!1);var e=c.createTreeWalker(d.element,1|a.whatToShow,function(b){return 1|u(a,b)},!1);if("previousNode"===b){for(var f=a.currentNode;e.lastChild(););for(;E(f,e.currentNode,!0)<=0&&e[b](););}return e}function Z(a,b,c){return"previousNode"===b?c&&a.typerNodeIterator.lastChild()||a.typerNodeIterator.previousSibling():a.typerNodeIterator.nextNode()}function $(a,b){var c=a.currentNode;if(a.iterator[b]())return a.currentNode.parentNode!==c.parentNode&&Z(a,b,!0)&&(a.iteratorStack.unshift({dir:b,iterator:a.iterator}),a.iterator=Y(a,b),1===u(a.iterator)||a.iterator[b]())?a.currentNode:a.currentNode;for(;a.iteratorStack[0];){var d=a.iteratorStack.shift();if(d.dir===b)return a.iterator=d.iterator,a.currentNode}for(;Z(a,b);)if(a.iterator=Y(a,b),1===u(a.iterator)||a.iterator[b]())return a.currentNode}function _(a,b,c){var d=H(a);return new n(a.focusNode,b|wa,function(a){return I(a.element,d)?c?c(a):1:2})}function aa(a,b,c){for(var d=a;d.parentNode;d=d.parentNode);var e=new n(d,b);return e.currentNode=a,c&&(e=new o(e,4),e.currentNode=c),e}function ba(a){for(var b=[],c=a.focusNode;c;c=c.parentNode)B(c,xa|va)&&b.unshift(c);return b}var ca,da,ea=JSON.parse('{"8":"backspace","9":"tab","13":"enter","16":"shift","17":"ctrl","18":"alt","19":"pause","20":"capsLock","27":"escape","33":"pageUp","34":"pageDown","35":"end","36":"home","37":"leftArrow","38":"upArrow","39":"rightArrow","40":"downArrow","45":"insert","46":"delete","48":"0","49":"1","50":"2","51":"3","52":"4","53":"5","54":"6","55":"7","56":"8","57":"9","65":"a","66":"b","67":"c","68":"d","69":"e","70":"f","71":"g","72":"h","73":"i","74":"j","75":"k","76":"l","77":"m","78":"n","79":"o","80":"p","81":"q","82":"r","83":"s","84":"t","85":"u","86":"v","87":"w","88":"x","89":"y","90":"z","91":"leftWindow","92":"rightWindowKey","93":"select","96":"numpad0","97":"numpad1","98":"numpad2","99":"numpad3","100":"numpad4","101":"numpad5","102":"numpad6","103":"numpad7","104":"numpad8","105":"numpad9","106":"multiply","107":"add","109":"subtract","110":"decimalPoint","111":"divide","112":"f1","113":"f2","114":"f3","115":"f4","116":"f5","117":"f6","118":"f7","119":"f8","120":"f9","121":"f10","122":"f11","123":"f12","144":"numLock","145":"scrollLock","186":"semiColon","187":"equalSign","188":"comma","189":"dash","190":"period","191":"forwardSlash","192":"backtick","219":"openBracket","220":"backSlash","221":"closeBracket","222":"singleQuote"}'),fa="area base br col command embed hr img input keygen link meta param source track wbr".split(" "),ga="h1,h2,h3,h4,h5,h6,p,q,blockquote,pre,code,li,caption,figcaption,summary,dt,th",ha="​",ia="&#8203;",ja="<p>&#8203;</p>",ka=7,la=6,ma=3,na=2,oa=1,pa=2,qa=32,ra=4,sa=8,ta=16,ua=64,va=128,wa=4096,xa=pa|qa,ya=ta|ua|va,za=ra|qa|ya,Aa=1,Ba=2,Ca=3,Da=4,Ea=!!b.ActiveXObject||void 0!==c.documentElement.style.msTouchAction,Fa=a.isFunction,Ga=b.getSelection();if(b.Typer=S,a.extend(S,{COLLAPSE_START_INSIDE:ka,COLLAPSE_START_OUTSIDE:la,COLLAPSE_END_INSIDE:ma,COLLAPSE_END_OUTSIDE:na,NODE_WIDGET:oa,NODE_PARAGRAPH:ra,NODE_EDITABLE:pa,NODE_EDITABLE_PARAGRAPH:qa,NODE_INLINE:ta,NODE_INLINE_WIDGET:ua,NODE_INLINE_EDITABLE:va,NODE_OUTER_PARAGRAPH:sa,NODE_SHOW_EDITABLE:wa,ZWSP:ha,ZWSP_ENTITIY:ia,trim:x,iterate:v,iterateToArray:w,compareAttrs:D,comparePosition:E,compareRangePosition:K,containsOrEquals:F,createElement:Q,createTextNode:P,createRange:H,rangeIntersects:I,rangeCovers:J,getRangeFromPoint:M,defaultOptions:{historyLevel:100,disallowedWidgets:"keepText",widgets:{}},widgets:{}}),q(m,{get childDOMNodes(){return s(this.element.childNodes)},get firstChild(){return this.childNodes[0]||null},get lastChild(){return this.childNodes.slice(-1)[0]||null},createRange:function(a){return H(this.element,+a===a?a:!!a)},createDOMNodeIterator:function(a,b){return new o(this,a,b)},cloneDOMNodes:function(a){return this.element.cloneNode(a)}}),q(n,{previousSibling:function(){return X(this,"lastChild","previousSibling")},nextSibling:function(){return X(this,"firstChild","nextSibling")},firstChild:function(){return W(this,"firstChild","nextSibling")},lastChild:function(){return W(this,"lastChild","previousSibling")},parentNode:function(){for(var a=this.currentNode;a&&a!==this.root;a=a.parentNode)if(V(this,a.parentNode,!0))return a.parentNode},previousNode:function(){for(var a=this.currentNode;a&&a!==this.root;){for(var b=a.previousSibling;b;b=a.previousSibling){a=b;for(var c=U(this,b);2!==c&&T(this,a.childNodes[0])&&a.childNodes[0];)a=a.lastChild,c=U(this,a,!0);if(1===c)return this.currentNode=a,a}if(a=T(this,a.parentNode)&&a.parentNode,!a||a===this.root)return null;if(V(this,a,!0))return a}},nextNode:function(){for(var a=this.currentNode,b=1;a;){for(;2!==b&&a.childNodes[0];){if(a=a.firstChild,V(this,a,!0))return a;b=U.returnValue}for(;a&&a!==this.root&&!a.nextSibling;)a=T(this,a.parentNode)&&a.parentNode;if(!a||a===this.root)return null;if(a=a.nextSibling,V(this,a))return a;b=U.returnValue}}}),q(o,{get currentNode(){return this.iterator.currentNode},set currentNode(a){this.iterator.currentNode=a},previousNode:function(){return $(this,"previousNode")},nextNode:function(){return $(this,"nextNode")}}),r(o.prototype,{iterator:function(){var a=this.typerNodeIterator;return B(a.currentNode,za)||a.nextNode(),this.iteratorStack=[],Y(this)}}),q(j,{getSelectedElements:function(b){return a(this.selectedElements).filter(b||"*").get()},getEditableElements:function(b,c){return a(b.element).find(this.editableElements).filter(c||"*").get()},createTreeWalker:function(a,b){return _(this,a,b)},createDOMNodeIterator:function(a,b){return new o(_(this,oa|za),a,b)}}),r(j.prototype,{widgets:function(){return a.map(ba(this),t("widget"))},editableElements:function(){return a.map(ba(this).concat(w(_(this,xa))),t("element"))},paragraphElements:function(){var b=new n(this.focusNode,ra|wa),c=w(b,null,this.startNode);return c.splice(c.indexOf(this.endNode)+1),a.map(c,t("element"))},selectedElements:function(){return w(_(this,za),t("element"))},previousNode:function(){return aa(this.startNode,ra|oa).previousNode()||null},nextNode:function(){return aa(this.endNode,ra|oa).nextNode()||null},previousTextNode:function(){return aa(this.startNode,za,this.startTextNode||this.startElement).previousNode()||null},nextTextNode:function(){return aa(this.endNode,za,this.endTextNode||this.endElement).nextNode()||null},previousTraversableTextNode:function(){return aa(this.startNode,za|wa,this.startTextNode||this.startElement).previousNode()||null},nextTraversableTextNode:function(){return aa(this.endNode,za|wa,this.endTextNode||this.endElement).nextNode()||null},textStart:function(){if(this.startTextNode&&(!this.startOffset||this.startTextNode.nodeValue.slice(0,this.startOffset)===ha))return!this.previousTextNode||!J(this.startNode.element,this.previousTextNode)||"br"===A(this.previousTextNode.nextSibling)&&this.startTextNode.previousSibling===this.previousTextNode.nextSibling},textEnd:function(){if(this.endTextNode&&(this.endOffset===this.endTextNode.length||this.endTextNode.nodeValue.slice(this.endOffset)===ha))return!this.nextTextNode||!J(this.endNode.element,this.nextTextNode)||"br"===A(this.nextTextNode.previousSibling)&&this.endTextNode.nextSibling===this.nextTextNode.previousSibling},isSingleEditable:function(){return!w(_(this,xa))[1]}}),q(k,{remove:function(){var a=this;a.typer.invoke(function(b){b.removeWidget(a)})}}),!Ea){try{c.designMode="on",c.execCommand("enableObjectResizing",!1,!1),c.execCommand("enableInlineTableEditing",!1,!1)}catch(a){}c.designMode="off"}a(b).bind("focusin focusout",function(a){a.target!==b&&a.target!==c.body||(da="focusout"===a.type)}),"undefined"==typeof h&&(h=function(){Object.defineProperty(this,"__dataKey__",{value:"typer"+Math.random().toString(36).substr(2,8)})},q(h,{get:function(a){return a[this.__dataKey__]},set:function(a,b){a[this.__dataKey__]=b},has:function(a){return this.__dataKey__ in a},delete:function(a){delete a[this.__dataKey__]}}))}(jQuery,window,document,String,Node,Range,DocumentFragment,window.WeakMap,[]),function(a,b){"use strict";b.presets={textbox:{inline:!0,inlineStyle:!1,lineBreak:!1,toolbar:!1,visualizer:!1,disallowedElement:"*",init:function(a){a.typer.moveCaret(a.typer.element,-0),Object.defineProperty(a.typer.element,"value",{enumerable:!0,configurable:!0,get:function(){return b.trim(this.textContent)},set:function(b){b!==this.value&&(this.textContent=b,a.typer.moveCaret(this,-0))}})},change:function(b){a(b.typer.element).trigger("change")}}},a.fn.typer=function(c,d){return d="string"==typeof c?a.extend({},b.presets[c],d):c,this.each(function(a,c){
new b(c,d)})}}(jQuery,window.Typer),function(a,b){"use strict";function c(b,d,e){var f=new Function("fn","return function "+(b||"")+"() { return fn.apply(this, arguments); }")(function(b){if(!(this instanceof f)){var c=Object.create(f.prototype);return f.apply(c,arguments),c}if(!m(e))return a.extend(this,b);try{this._super=d,e.apply(this,arguments)}finally{delete this._super}});return f.prototype=m(d)?new d:a.extend(f.prototype,d),f.extend=function(a){return c(null,f,a)},f}function d(a){var b=/^([\w-:]*)(?:\(([^}]+)\))?$/.exec(a),c=null;try{c=b[2]&&JSON.parse(("{"+b[2]+"}").replace(/([{:,])\s*([^\s:,}]+)/g,'$1"$2"'))}catch(a){}return{name:b[1],params:c}}function e(a,b){b?a.data("original-display")?a.css("display",a.data("original-display")):a.show():("none"!==a.css("display")&&a.data("original-display",a.css("display")),a.hide())}function f(a,b,c,d){if(a!==b&&m(b[c]))return b[c](a,b,d)}function g(a,b,c,d){f(a,b,c,d);var e=b.type+c.charAt(0).toUpperCase()+c.slice(1);m(r[a.theme][e])&&r[a.theme][e](a,b,d)}function h(b,c){if(c=c||b,m(c.controls)&&(c.controls=c.controls(b,c)||""),"string"==typeof c.controls){var e=c.controls.split(/\s+/),f={};a.each(e,function(b,c){if("*"===c.slice(-1))a.each(o,function(a,b){a.slice(0,c.length-1)===c.slice(0,-1)&&a.indexOf(":",c.length)<0&&e.indexOf("-"+a)<0&&!f[a]&&(f[a]=Object.create(b))});else if("-"!==c.charAt(0)){var g=d(c);o[g.name]&&e.indexOf("-"+g.name)<0&&!f[g.name]&&(f[g.name]=a.extend(Object.create(o[g.name]),g.params))}}),c.controls=[],a.each(f,function(a,b){b.name=b.name||a,c.controls.push(b)})}return a.each(c.controls||[],function(a,d){d.name=d.name||"noname:"+Math.random().toString(36).substr(2,8),d.parent=c,void 0===d.label&&(d.label=d.name),b.all[d.name]=d,h(b,d)}),c.controls}function i(b,c,e){function f(){a.each(k,function(b,d){a.each(d[1],function(b,e){"_"===b?a(d[0]).text(q[c[e]]||c[e]||""):n.indexOf(b)>=0?a(d[0]).prop(b,!!c[e]&&"false"!==c[e]):c[e]?a(d[0]).attr(b,q[c[e]]||c[e]||""):a(d[0]).removeAttr(b)})})}function g(b){a(b).find("*").andSelf().filter("[x\\:bind]").each(function(b,c){var e=d(a(c).attr("x:bind"));k.push([c,e.params])}).removeAttr("x:bind")}function h(e){var f=a(r[b.theme][e]||'<div><br x:t="children"></div>')[0];return g(f),a("[x\\:t]",f).each(function(e,f){var j,k=d(a(f).attr("x:t"));m(r[b.theme][k.name])?(j=a(r[b.theme][k.name](b,c,k.params)),g(j)):j="children"===k.name?a.map(c.controls,function(a){return i(b,a,k.params)}):h(k.name),a(f).replaceWith(j)}),f}function j(d){d.stopPropagation(),a(d.target).is(":checkbox")?setTimeout(function(){b.setValue(c,!!d.target.checked)}):b.execute(c)}c=c||b;var k=[];c.element=h(c.type),c.bindData=f;var l=r[b.theme][c.type+"ExecuteOn"];return"string"==typeof l?a(c.element).bind(l,j):l&&a(l.of,c.element).bind(l.on,j),c.element}function j(b,c){var d;"string"==typeof(c.requireWidget||c.requireWidgetEnabled)&&(c.widget=b._widgets[c.requireWidget||c.requireWidgetEnabled]||null,d=!c.widget),d||g(b,c,"stateChange");var f=!b.enabled(c),h=!c.hiddenWhenDisabled||!f;h&&c.bindData();var i=a(c.element),j=r[b.theme];i.is(":input")&&i.prop("disabled",f),j.controlDisabledClass&&i.toggleClass(j.controlDisabledClass,f),j.controlActiveClass&&i.toggleClass(j.controlActiveClass,!!b.active(c)),j.controlHiddenClass?i.toggleClass(j.controlHiddenClass,!h):e(i,h)}function k(a,b){a.typer?m(b.execute)?a.typer.invoke(function(c){b.execute(a,b,c,b.value)}):a.typer.hasCommand(b.execute)&&a.typer.invoke(b.execute,b.value):m(b.execute)&&b.execute(a,b,null,b.value)}function l(b,c,d,e){a.each(Object.keys(b.all).reverse(),function(a,e){c(b,b.all[e],d)}),c(b,b,d)}var m=a.isFunction,n="checked selected disabled readonly multiple ismap".split(" "),o={},p={},q={},r={};b.ui=c("TyperUI",null,function(b,c){"string"==typeof b&&(b={theme:c,controls:b});var d=a.extend(this,b);d.all={},d.controls=h(d),d.element=i(d),a(d.element).addClass("typer-ui typer-ui-"+b.theme),d.typer&&d.typer.retainFocus(d.element),f(d,r[d.theme],"init"),l(d,g,"init")}),a.extend(b.ui.prototype,{update:function(){var b=this,c=b._widgets={};b.widget?c[b.widget.id]=b.widget:b.typer&&a.each(b.typer.getSelection().widgets.concat(b.typer.getStaticWidgets()),function(a,b){c[b.id]=b}),l(this,j)},destroy:function(){l(this,f,"destroy")},trigger:function(a,b){"string"==typeof a&&(a=this.all[a]||{}),g(this,a,b)},enabled:function(a){return"string"==typeof a&&(a=this.all[a]||{}),!(!this.typer&&(a.requireTyper||a.requireWidget||a.requireWidgetEnabled||a.requireCommand))&&(!(a.requireCommand&&!this.typer.hasCommand(a.requireCommand)||a.requireWidgetEnabled&&!this.typer.widgetEnabled(a.requireWidgetEnabled))&&(!(a.requireWidget===!0&&!Object.getOwnPropertyNames(this._widgets)[0]||a.requireWidget&&!a.widget&&!this.widget)&&f(this,a,"enabled")!==!1))},active:function(a){return"string"==typeof a&&(a=this.all[a]||{}),!!f(this,a,"active")},setValue:function(a,b){"string"==typeof a&&(a=this.all[a]||{}),a.value=b,a.executeOnSetValue&&this.enabled(a)&&k(this,a)},execute:function(b){"string"==typeof b&&(b=this.all[b]||{});var c=this;if(c.enabled(b)){if(m(b.dialog)){var d=a.when(b.dialog(c,b));return d.done(function(a){void 0!==a&&(b.value=a),k(c,b)}),d}k(c,b)}},prompt:function(a,c){var d=b.ui("ui:prompt",this.theme),e=d.all["ui:prompt"];return e.label=a,e.value=c,d.execute(e)}}),a.extend(b.ui,{controls:o,themes:r,getIcon:function(a,b){return(p[a.icon]||p[a.name]||"")[b]||""},addIcons:function(b,c){a.each(c,function(a,c){p[a]||(p[a]={}),p[a][b]=c})},addLabels:function(b,c){a.extend(q,c)}}),a.extend(b.ui,{button:c("TyperUIButton",{type:"button"}),dropdown:c("TyperUIDropdown",{type:"dropdown",stateChange:function(b,c){a.each(c.controls,function(d,e){if(b.active(e))return a("select",c.element).prop("selectedIndex",d),c.selectedIndex=d,c.selectedValue=e.label||e.name,!1})},execute:function(a,b){a.execute(b.controls[b.selectedIndex])},enabled:function(a,b){return b.controls.length>0}}),group:c("TyperUIGroup",{type:"group",hiddenWhenDisabled:!0},function(b,c){this.controls=b,a.extend(this,c)}),callout:c("TyperUICallout",{type:"callout"}),textbox:c("TyperUITextbox",{type:"textbox",executeOnSetValue:!0}),checkbox:c("TyperUICheckbox",{type:"checkbox",executeOnSetValue:!0}),dialog:c("TyperUIDialog",{type:"dialog"},function(b,c){this.controls=b,this.dialog=function(b,d){var e=a.Deferred();return c(b,d,e.resolve.bind(e),e.reject.bind(e)),b.update(),b.trigger(d,"open"),e.always(function(){b.trigger(d,"close"),b.destroy()}),e.promise()}})}),a.extend(o,{"ui:button-ok":b.ui.button(),"ui:button-cancel":b.ui.button(),"ui:prompt-input":b.ui.textbox({label:"",executeOnSetValue:!1}),"ui:prompt-buttonset":b.ui.group("ui:button-ok ui:button-cancel"),"ui:prompt":b.ui.dialog("ui:prompt-input ui:prompt-buttonset",function(a,b,c,d){a.all["ui:button-ok"].execute=function(){c(a.all["ui:prompt-input"].value)},a.all["ui:button-cancel"].execute=d,a.setValue("ui:prompt-input",b.value)})}),b.ui.addLabels("en",{"ui:button-ok":"OK","ui:button-cancel":"Cancel"}),b.ui.addIcons("material",{"ui:button-ok":"done","ui:button-cancel":"close"})}(jQuery,window.Typer),function(a,b){"use strict";function c(b){var c=a(b).css("text-align"),d=a(b).css("direction");switch(c){case"-webkit-left":return"left";case"-webkit-right":return"right";case"start":return"ltr"===d?"left":"right";case"end":return"ltr"===d?"right":"left";default:return c}}function d(b,d){var e;return a(b.selectedElements).each(function(b,f){var g;g="textAlign"===d?c(f):"inlineClass"===d?a(f).filter("span").attr("class")||"":a(f).css(d),e=""===e||e&&e!==g?"":g}),e||""}function e(a,c){var d=b.createElement(a);return c&&(d.className=c),d}function f(b){a(b.selection.paragraphElements).attr("align",j[b.commandName])}function g(a){a.selection.isCaret?a.insertHtml(e(k[a.commandName])):(a.widget.subscript&&"superscript"===a.commandName?a.execCommand("subscript"):a.widget.superscript&&"subscript"===a.commandName&&a.execCommand("superscript"),a.execCommand(a.commandName))}function h(c,d){var e="insertOrderedList"===c.commandName||d?"ol":"ul",f="<"+e+(d||"").replace(/^.+/,' type="$&"')+">",g=function(b,c){return c.tagName.toLowerCase()===e&&(a(c).attr("type")||"")===(d||"")};a.each(c.selection.paragraphElements,function(c,d){if("li"!==d.tagName.toLowerCase()){var e=a(d).prev().filter(g)[0]||a(d).next().filter(g)[0]||a(f).insertAfter(d)[0];a(d).wrap("<li>").contents().unwrap().parent()[b.comparePosition(d,e)<0?"prependTo":"appendTo"](e)}else a(d.parentNode).filter(g)[0]||a(d.parentNode).wrap(f).contents().unwrap()}),c.restoreSelection()}function i(a,c){(c||"").replace(/(\w+):(\w+)/g,function(c,d,e){b.widgets[a][d]=function(a){a.typer.invoke(e)}})}var j={justifyLeft:"left",justifyRight:"right",justifyCenter:"center",justifyFull:"justify"},k={bold:"b",italic:"i",underline:"u",strikeThrough:"strike",superscript:"sup",subscript:"sub"};b.widgets.inlineStyle={inline:!0,beforeStateChange:function(b){var c=b.typer.getSelection();a.extend(b.widget,{bold:/bold|700/.test(d(c,"fontWeight")),italic:"italic"===d(c,"fontStyle"),underline:"underline"===d(c,"textDecoration"),strikeThrough:"line-through"===d(c,"textDecoration"),superscript:!!c.getSelectedElements("sup")[0],subscript:!!c.getSelectedElements("sub")[0],inlineClass:d(c,"inlineClass")})},commands:{bold:g,italic:g,underline:g,strikeThrough:g,superscript:g,subscript:g,applyClass:function(b,c){var d=b.selection.paragraphElements;a(b.getSelectedTextNodes()).wrap(e("span",c)),a("span:has(span)",d).each(function(b,c){a(c).contents().unwrap().filter(function(a,b){return 3===b.nodeType}).wrap(e("span",c.className))}),a('span[class=""]',d).contents().unwrap(),b.restoreSelection()}}},i("inlineStyle","ctrlB:bold ctrlI:italic ctrlU:underline"),b.widgets.formatting={beforeStateChange:function(b){var c=b.typer.getSelection(),e=c.paragraphElements.slice(-1)[0];a(e).is("li")&&(e=a(e).closest("ol, ul")[0]||e);var f=e&&e.tagName.toLowerCase(),g=f+(a(e).attr("class")||"").replace(/^(.)/,".$1"),h=d(c,"textAlign");a.extend(b.widget,{justifyLeft:"left"===h,justifyCenter:"center"===h,justifyRight:"right"===h,justifyFull:"justify"===h,formatting:f,formattingWithClassName:g})},commands:{justifyCenter:f,justifyFull:f,justifyLeft:f,justifyRight:f,formatting:function(b,c){var d=/^([^.]*)(?:\.(.+))?/.exec(c)||[];"ol"===d[1]||"ul"===d[1]?b.insertWidget("list","ol"===d[1]&&"1"):a(b.selection.paragraphElements).not("li").wrap(e(d[1]||"p",d[2])).contents().unwrap(),b.restoreSelection()},insertLine:function(b){var c=b.selection,d=c.isCaret&&c.textEnd&&a(c.startTextNode).next("br")[0]||c.textStart&&a(c.startTextNode).prev("br")[0];b.insertText("\n\n"),d&&b.remove(d)}}},i("formatting","enter:insertLine ctrlShiftL:justifyLeft ctrlShiftE:justifyCenter ctrlShiftR:justifyRight"),b.widgets.lineBreak={inline:!0,commands:{insertLineBreak:function(a){a.insertHtml("<br>"+(a.selection.textEnd?b.ZWSP_ENTITIY:""))}}},i("lineBreak","shiftEnter:insertLineBreak"),b.widgets.list={element:"ul,ol",editable:"ul,ol",insert:h,remove:"keepText",beforeStateChange:function(b){var c=b.widget.element.tagName.toLowerCase();a.extend(b.widget,{insertUnorderedList:"ul"===c,insertOrderedList:"ol"===c,listType:a(b.widget.element).attr("type")||""})},commands:{indent:function(c){a.each(c.selection.paragraphElements,function(d,e){var f=a(e.parentNode).filter("ul,ol")[0],g=a(e).prev("li")[0]||a("<li>").insertBefore(e)[0],h=a(g).children("ul,ol")[0]||a(f.cloneNode(!1)).appendTo(g)[0];a("<li>").append(e.childNodes).appendTo(h),c.remove(e),a(h).parent("li")[0]&&!h.previousSibling&&a(b.createTextNode()).insertBefore(h)}),c.restoreSelection()},outdent:function(b){a.each(b.selection.paragraphElements,function(c,d){var f=a(d.parentNode).filter("ul,ol")[0],g=a(f).parent("li")[0];a(d).next("li")[0]&&(g?a(f.cloneNode(!1)).append(a(d).nextAll()).appendTo(d):(a(f.cloneNode(!1)).append(a(d).nextAll()).insertAfter(f),a(d).children("ul,ol").insertAfter(f))),a(e(g?"li":"p")).append(d.childNodes).insertAfter(g||f),b.remove(d)}),b.restoreSelection()}}},a.each("formatting list inlineStyle lineBreak".split(" "),function(a,c){b.defaultOptions[c]=!0});var l=b.ui.button.extend(function(a,b){this._super({requireWidget:b,requireCommand:a,execute:a,active:function(b,c){return c.widget&&c.widget[a]},enabled:function(b,c){return"indent"!==a&&"outdent"!==a||c.widget}})}),m=b.ui.button.extend(function(b,c){this._super({name:"formatting:orderedList:"+b,annotation:c,requireWidgetEnabled:"list",value:b,execute:function(a,c,d){d.insertWidget("list",b)},active:function(c,d){return d.widget&&a(d.widget.element).attr("type")===b}})});a.extend(b.ui.controls,{"toolbar:formatting":b.ui.group("formatting:*",{rqeuireTyper:!0,enabled:function(a){return!!a.typer.getSelection().paragraphElements[0]}}),"formatting:paragraph":b.ui.dropdown({requireCommand:"formatting",hiddenWhenDisabled:!0,controls:function(c){return a.map(Object.keys(c.options.formattings||{}),function(a){return b.ui.button({requireWidget:"formatting",execute:"formatting",value:a,label:c.options.formattings[a],active:function(b,c){return c.widget.formattingWithClassName===a||c.widget.formatting===a}})})}}),"formatting:inlineStyle":b.ui.dropdown({requireCommand:"applyClass",hiddenWhenDisabled:!0,controls:function(c){return a.map(Object.keys(c.options.inlineClass||{}),function(a){return b.ui.button({requireWidget:"inlineStyle",execute:"applyClass",value:a,label:c.options.inlineClass[a],active:function(b,c){return c.widget.inlineClass===a}})})}}),"formatting:bold":l("bold","inlineStyle"),"formatting:italic":l("italic","inlineStyle"),"formatting:underline":l("underline","inlineStyle"),"formatting:strikeThrough":l("strikeThrough","inlineStyle"),"formatting:unorderedList":b.ui.button({requireWidgetEnabled:"list",execute:function(a,b,c){c.insertWidget("list","")},active:function(a,b){return b.widget&&"ul"===b.widget.element.tagName.toLowerCase()}}),"formatting:orderedList":b.ui.callout({requireWidgetEnabled:"list",controls:[m("1","1, 2, 3, 4"),m("a","a, b, c, d"),m("A","A, B, C, D"),m("i","i, ii, iii, iv"),m("I","I, II, III, IV")],active:function(a,b){return b.widget&&"ol"===b.widget.element.tagName.toLowerCase()}}),"formatting:indent":l("indent","list"),"formatting:outdent":l("outdent","list"),"formatting:justifyLeft":l("justifyLeft","formatting"),"formatting:justifyCenter":l("justifyCenter","formatting"),"formatting:justifyRight":l("justifyRight","formatting"),"formatting:justifyFull":l("justifyFull","formatting")}),b.ui.addLabels("en",{"formatting:bold":"Bold","formatting:italic":"Italic","formatting:underline":"Underlined","formatting:strikeThrough":"Strikethrough","formatting:unorderedList":"Bullet List","formatting:orderedList":"Numbered List","formatting:indent":"Indent","formatting:outdent":"Outdent","formatting:justifyLeft":"Align Left","formatting:justifyCenter":"Align Center","formatting:justifyRight":"Align Right","formatting:justifyFull":"Align Justified","formatting:paragraph":"Formatting","formatting:inlineStyle":"Text Style","formatting:orderedList:1":"Decimal numbers","formatting:orderedList:a":"Alphabetically ordered list, lowercase","formatting:orderedList:A":"Alphabetically ordered list, uppercase","formatting:orderedList:i":"Roman numbers, lowercase","formatting:orderedList:I":"Roman numbers, uppercase"}),b.ui.addIcons("material",{"formatting:bold":"format_bold","formatting:italic":"format_italic","formatting:underline":"format_underlined","formatting:strikeThrough":"strikethrough_s","formatting:unorderedList":"format_list_bulleted","formatting:orderedList":"format_list_numbered","formatting:indent":"format_indent_increase","formatting:outdent":"format_indent_decrease","formatting:justifyLeft":"format_align_left","formatting:justifyCenter":"format_align_center","formatting:justifyRight":"format_align_right","formatting:justifyFull":"format_align_justify"})}(jQuery,window.Typer),function(a,b){"use strict";b.widgets.link={element:"a[href]",inline:!0,insert:function(b,c){if(c=c||/^[a-z]+:\/\//g.test(b.getSelectedText())&&RegExp.input||"#",b.selection.isCaret){var d=a("<a>").text(c).attr("href",c)[0];b.insertHtml(d)}else b.execCommand("createLink",c)},remove:"keepText",commands:{setURL:function(a,b){a.widget.element.href=b},unlink:function(a){a.removeWidget(a.widget)}}},b.defaultOptions.link=!0,a.extend(b.ui.controls,{"toolbar:link":b.ui.callout({controls:"link:*",requireWidgetEnabled:"link",hiddenWhenDisabled:!0,dialog:function(b,c){return"function"==typeof b.options.selectLink?b.options.selectLink():b.prompt("dialog:selectLink",c.widget?a(c.widget.element).attr("href"):"")},execute:function(a,b,c,d){b.widget?c.invoke("setURL",d):c.insertWidget("link",d)},active:function(a,b){return b.widget}}),"link:url":b.ui.textbox({hiddenWhenDisabled:!0,requireWidget:"link",execute:"setURL",stateChange:function(b,c){c.value=a(c.widget.element).attr("href")}}),"link:blank":b.ui.checkbox({hiddenWhenDisabled:!0,requireWidget:"link",stateChange:function(b,c){c.value="_blank"===a(c.widget.element).attr("target")},execute:function(b,c){c.value?a(c.widget.element).attr("target","_blank"):a(c.widget.element).removeAttr("target")}}),"link:unlink":b.ui.button({hiddenWhenDisabled:!0,requireWidget:"link",execute:"unlink"})}),b.ui.addLabels("en",{"toolbar:link":"Insert Link","link:url":"Link URL","link:blank":"Open in New Window","link:unlink":"Remove Link","dialog:selectLink":"Enter URL"}),b.ui.addIcons("material",{"toolbar:link":"insert_link","link:url":"insert_link"})}(jQuery,window.Typer),function(a,b){"use strict";var c=/\.(?:(jpg|jpeg|png|gif|webp)|(mp4|ogg|webm)|(mp3))$/gi;b.widgets.media={element:"img,audio,video,a:has(>img)",text:function(a){return a.element.src},insert:function(a,d){var e=b.createElement(c.exec(d.src||d)&&(RegExp.$1?"img":RegExp.$2?"video":"audio"));e.src=d.src||d,a.insertHtml(e)}},b.defaultOptions.media=!0;var d=b.ui.button.extend(function(a){this._super({requireWidgetEnabled:"media",hiddenWhenDisabled:!0,dialog:function(b){return"function"==typeof b.options.selectMedia?b.options.selectMedia(a):b.prompt("dialog:selectImage")},execute:function(a,b,c,d){c.insertWidget("media",d)}})});a.extend(b.ui.controls,{"widget:media":b.ui.group("media:* widget:delete"),"insert:image":d("image"),"insert:video":d("video"),"media:filePicker":b.ui.button({requireWidget:"media",stateChange:function(b,c){c.value=a(c.widget.element).attr("src"),c.label=(/(?:^|\/)([^\/?#]+)(?:\?.+)?$/.exec(c.value)||[])[1]||""},dialog:function(a,b){if("function"==typeof a.options.selectMedia){var d=c.exec(b.label)&&(RegExp.$1?"image":RegExp.$2?"video":"audio");return a.options.selectMedia(d,b.value)}return a.prompt("dialog:selectImage",b.value)},execute:function(b,c,d,e){a(c.widget.element).attr("src",e.src||e)}}),"media:altText":b.ui.textbox({requireWidget:"media",hiddenWhenDisabled:!0,stateChange:function(b,c){c.value=a(c.widget.element).attr("alt")},execute:function(b,c){a(c.widget.element).attr("alt",c.value)}})}),b.ui.addLabels("en",{"insert:image":"Image","insert:video":"Video","media:altText":"Alternate Text","dialog:selectImage":"Enter Image URL"}),b.ui.addIcons("material",{"insert:image":"insert_photo","insert:video":"videocam","media:altText":"comment"})}(jQuery,window.Typer),function(a,b){"use strict";function c(a,b){return new Array(b+1).join(a)}function d(b,c,d){var e=a(">tbody>tr",b.widget.element).eq(Math.max(0,b.widget.row+c)).children()[Math.max(0,b.widget.column+d)];b.normalize(b.widget.element),b.moveCaret(e,-0)}var e="<td></td>",f="<th></th>",g="<tr>%</tr>";b.widgets.table={element:"table",editable:"th,td",insert:function(b,d){d=a.extend({rows:2,columns:2},d),b.insertHtml("<table>"+c(g.replace("%",c(e,d.columns)),d.rows)+"</table>")},beforeStateChange:function(b){var c=b.typer.getSelection(),d=c.getEditableElements(b.widget),e=d.length>1?-1:a(d).index(),f=d.length>1?-1:a(d).parent().index();a.extend(b.widget,{row:f,rowCount:a(">tbody>tr",b.widget.element).length,rowCells:a(">tbody>tr:nth-child("+(f+1)+")>*",b.widget.element).get(),column:e,columnCount:a(">tbody>tr:first>*",b.widget.element).length,columnCells:a(">tbody>tr>*:nth-child("+(e+1)+")",b.widget.element).get()})},tab:function(b){var c=a(">tbody>tr>*",b.widget.element).get(),d=b.widget.row*b.widget.columnCount+b.widget.column;d<c.length-1&&b.typer.moveCaret(c[d+1])},shiftTab:function(b){var c=a(">tbody>tr>*",b.widget.element).get(),d=b.widget.row*b.widget.columnCount+b.widget.column;d>0&&b.typer.moveCaret(c[d-1],-0)},ctrlEnter:function(a){0===a.widget.row&&0===a.widget.column?a.typer.invoke("insertSpaceBefore"):a.widget.row===a.widget.rowCount-1&&a.widget.column===a.widget.columnCount-1&&a.typer.invoke("insertSpaceAfter")},commands:{justifyLeft:function(b){a(b.selection.getEditableElements(b.widget)).attr("align","left")},justifyCenter:function(b){a(b.selection.getEditableElements(b.widget)).attr("align","center")},justifyRight:function(b){a(b.selection.getEditableElements(b.widget)).attr("align","right")},addColumnBefore:function(b){a(b.widget.columnCells).filter("th").before(f),a(b.widget.columnCells).filter("td").before(e),d(b,0,0)},addColumnAfter:function(b){a(b.widget.columnCells).filter("th").after(f),a(b.widget.columnCells).filter("td").after(e),d(b,0,1)},addRowAbove:function(b){a(b.widget.rowCells).before(g.replace("%",c(e,b.widget.columnCount))),d(b,0,0)},addRowBelow:function(b){a(b.widget.rowCells).after(g.replace("%",c(e,b.widget.columnCount))),d(b,1,0)},removeColumn:function(b){a(b.widget.columnCells).remove(),d(b,0,-1)},removeRow:function(b){a(b.widget.rowCells).remove(),d(b,-1,0)},toggleTableHeader:function(b){a(b.widget.element).find("th")[0]?(a(b.widget.element).find("tr:has(th)").remove(),0===b.widget.row&&d(b,0,0)):(a(b.widget.element).find("tbody").prepend(g.replace("%",c(f,b.widget.columnCount))),d(b,-b.widget.row,-b.widget.column))},insertSpaceBefore:function(a){a.select(a.widget.element,b.COLLAPSE_START_OUTSIDE),a.insertText("")},insertSpaceAfter:function(a){a.select(a.widget.element,b.COLLAPSE_END_OUTSIDE),a.insertText("")}}},a.extend(b.ui.controls,{"insert:table":b.ui.callout({controls:"table:*",requireWidgetEnabled:"table",hiddenWhenDisabled:!0,execute:function(a,b,c){c.insertWidget("table")},active:function(a,b){return b.widget}}),"table:addColumnBefore":b.ui.button({requireWidget:"table",execute:"addColumnBefore"}),"table:addColumnAfter":b.ui.button({requireWidget:"table",execute:"addColumnAfter"}),"table:addRowAbove":b.ui.button({requireWidget:"table",execute:"addRowAbove"}),"table:addRowBelow":b.ui.button({requireWidget:"table",execute:"addRowBelow"}),"table:removeColumn":b.ui.button({requireWidget:"table",execute:"removeColumn"}),"table:removeRow":b.ui.button({requireWidget:"table",execute:"removeRow"})}),b.ui.addLabels("en",{"insert:table":"Table","table:addColumnBefore":"Add Column Before","table:addColumnAfter":"Add Column After","table:addRowAbove":"Add Row Above","table:addRowBelow":"Add Row Below","table:removeColumn":"Remove Column","table:removeRow":"Remove Row"}),b.ui.addIcons("material",{"insert:table":"border_all"})}(jQuery,window.Typer),function(a,b){"use strict";function c(b,c){if(b.widget||!b.options.container)if(clearTimeout(g),f!==b&&(d(!0),f=b,a(b.element).appendTo(document.body)),c)b.position="fixed",a(b.element).css(c);else if("fixed"!==b.position){var e=(b.widget||b.typer).element.getBoundingClientRect(),h=a(b.element).height();e.top+e.height>document.body.offsetHeight?b.position="":e.top<h&&(b.position="bottom"),a(b.element).css({left:e.left+a(window).scrollLeft(),top:("bottom"===b.position?Math.min(e.top+e.height+10,a(window).height()-h-10):Math.max(0,e.top-h-10))+a(window).scrollTop()})}}function d(b){clearTimeout(g),b?f&&(a(f.element).detach(),f.position="",f=null):g=setTimeout(function(){d(!0)},100)}function e(d,e,f){var g=b.ui({type:"toolbar",typer:d,widget:f||null,theme:e.theme,controls:f?"toolbar:widget":"toolbar",options:e}),h=a(g.element).addClass("typer-ui-toolbar");return e.container?h.appendTo(e.container):(h.addClass("typer-ui-toolbar-floating"),h.mousedown(function(b){var d=h.position();if(b.target===g.element){var e=function(a){c(g,{top:d.top+(a.clientY-b.clientY),left:d.left+(a.clientX-b.clientX)})};a(document.body).mousemove(e),a(document.body).mouseup(function(){a(document.body).unbind("mousemove",e)})}})),g}var f,g;b.widgets.toolbar={inline:!0,options:{container:"",theme:"material",formattings:{p:"Paragraph",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4"},inlineClasses:{}},init:function(a){a.widget.toolbar=e(a.typer,a.widget.options),a.widget.state=a.widget.toolbar.state={}},widgetInit:function(a,b){b.toolbar=e(a.typer,a.widget.options,b)},focusin:function(a){c(a.widget.toolbar)},focusout:function(a){setTimeout(d)},widgetFocusin:function(a,b){b.toolbar.all["toolbar:widget"].controls[0]&&(b.toolbar.update(),c(b.toolbar))},widgetFocusout:function(a,b){c(a.widget.toolbar)},widgetDestroy:function(a,b){b.toolbar&&(b.toolbar.destroy(),c(a.widget.toolbar))},stateChange:function(){f&&(f.update(),c(f))}},a(window).scroll(function(){f&&c(f)}),a.extend(b.ui.controls,{toolbar:b.ui.group("toolbar:history toolbar:insert toolbar:* -toolbar:widget"),"toolbar:history":b.ui.group("history:*"),"toolbar:insert":b.ui.callout({controls:"insert:*",enabled:function(a){return a.typer.document.rootNode.nodeType!==b.NODE_EDITABLE_INLINE}}),"toolbar:widget":b.ui.group("",{requireWidget:!0,controls:function(a,b){return a.widget&&"widget:"+a.widget.id}}),"history:undo":b.ui.button({execute:function(a){a.typer.undo()},enabled:function(a){return a.typer.canUndo()}}),"history:redo":b.ui.button({execute:function(a){a.typer.redo()},enabled:function(a){return a.typer.canRedo()}}),"widget:delete":b.ui.button({requireWidget:!0,execute:function(a){a.widget.remove()}})}),b.ui.addLabels("en",{"toolbar:insert":"Insert Widget","history:undo":"Undo","history:redo":"Redo","widget:delete":"Delete"}),b.ui.addIcons("material",{"toolbar:insert":"widgets","history:undo":"undo","history:redo":"redo","widget:delete":"delete"})}(jQuery,window.Typer),function(a,b){function c(){var b='            .has-typer-visualizer:focus { outline:none; }            .has-typer-visualizer::selection,.has-typer-visualizer ::selection { background-color:transparent; }            .has-typer-visualizer::-moz-selection,.has-typer-visualizer ::-moz-selection { background-color:transparent; }            .typer-visualizer { position:fixed;pointer-events:none; }            .typer-visualizer > div { position:fixed;box-sizing:border-box; }            .typer-visualizer .fill { background-color:rgba(0,31,81,0.2); }            .typer-visualizer .fill-margin { border:solid rgba(255,158,98,0.2); }            @supports (clip-path:polygon(0 0,0 0)) or (-webkit-clip-path:polygon(0 0,0 0)) { .typer-visualizer .bl-r:before,.typer-visualizer .tl-r:before,.typer-visualizer .br-r:after,.typer-visualizer .tr-r:after { content:"";display:block;position:absolute;background-color:rgba(0,31,81,0.2);width:4px;height:4px;-webkit-clip-path:polygon(100% 100%,100% 0,96.6% 25.9%,86.6% 50%,70.7% 70.7%,50% 86.6%,25.9% 96.6%,0 100%);clip-path:polygon(100% 100%,100% 0,96.6% 25.9%,86.6% 50%,70.7% 70.7%,50% 86.6%,25.9% 96.6%,0 100%); } }            .typer-visualizer .line-n,.typer-visualizer .line-s { border-top:1px solid rgba(0,31,81,0.2);left:0;right:0;height:1px; }            .typer-visualizer .line-w,.typer-visualizer .line-e { border-left:1px solid rgba(0,31,81,0.2);top:0;bottom:0;width:1px; }            .typer-visualizer .line-s { margin-top:-1px; }            .typer-visualizer .line-e { margin-left:-1px; }            .typer-visualizer .bl { border-bottom-left-radius:4px; }            .typer-visualizer .tl { border-top-left-radius:4px; }            .typer-visualizer .br { border-bottom-right-radius:4px; }            .typer-visualizer .tr { border-top-right-radius:4px; }            .typer-visualizer .bl-r:before { right:100%;bottom:0; }            .typer-visualizer .tl-r:before { right:100%;top:0;-webkit-transform:flipY();transform:flipY(); }            .typer-visualizer .br-r:after { left:100%;bottom:0;-webkit-transform:flipX();transform:flipX(); }            .typer-visualizer .tr-r:after { left:100%;top:0;-webkit-transform:rotate(180deg);transform:rotate(180deg); }        ';a(document.body).append("<style>"+b+"</style>"),p=a('<div class="typer-ui typer-visualizer">').appendTo(document.body)[0],a(window).bind("scroll resize orientationchange focus",function(){z=a(window).width(),A=a(window).height(),m()}),a(document.body).bind("mousewheel",m),a(document.body).bind("mousemove",function(a){n(a.clientX,a.clientY)})}function d(b,c){b.style.zIndex=(+a(c).parentsUntil(b.parentNode).filter(function(b,c){return/absolute|fixed|relative/.test(a(c).css("position"))}).slice(-1).css("z-index")||0)+1}function e(a,b){return a.left===b.left&&a.top===b.top&&a.width===b.width&&a.height===b.height}function f(a,b){return b.left>=a.left&&b.right<=a.right&&b.top>=a.top&&b.bottom<=a.bottom}function g(a){return{top:0|a.top,left:0|a.left,right:0|(a.right||a.left+a.width),bottom:0|(a.bottom||a.top+a.height)}}function h(a){return{top:a.top,left:a.left,right:z-(a.right||a.left+a.width),bottom:A-(a.bottom||a.top+a.height)}}function i(c){var d=c.getBoundingClientRect(),e=window.getSelection().rangeCount&&window.getSelection().getRangeAt(0),h=e?a.map(b.createRange(e,b.createRange(c)).getClientRects(),g):[],i=[];return h.sort(function(a,b){return a.top-b.top||a.left-b.left||b.bottom-a.bottom||b.right-a.right}),a.each(h,function(a,b){var c=i[0];if(c&&(b.left>=c.right&&b.top<c.bottom?(i.shift(),b.top=Math.min(b.top,c.top),b.left=c.left,b.bottom=Math.max(b.bottom,c.bottom),c=i[0]):b.top>=c.bottom&&(c.right=d.left+d.width)),c){if(f(c,b))return;b.top>c.top&&b.top-c.bottom<b.bottom-b.top&&(c.bottom=b.top),i[1]&&c.left===i[1].left&&c.right===i[1].right&&(c.top=i.splice(1,1)[0].top)}i.unshift(b)}),i}function j(b,c,d){var e;a.each(b,function(a,b){if(null===b.element&&(e=b),b.element===c)return b.type=d,e=!0,!1}),"object"==typeof e?(e.element=c,e.type=d):e||(b[b.length]={element:c,type:d})}function k(b){a.each(b,function(b,c){c.type="none",a.contains(document,c.element)||(c.element=null)})}function l(b){a.each(b,function(b,c){function d(b,c,d){return e[f]=e[f]||y.pop()||a("<div>")[0],e[f].className=b,e[f].setAttribute("style",""),a(e[f]).css(c||"",d),e[f++]}var e=c.dom=c.dom||[],f=0;if("text"===c.type){var g=i(c.element);a.each(g,function(a,b){var c=g[a-1]||t,e=g[a+1]||t,f=d("fill",h(b));f.className+=[b.left<c.left||b.left>c.right?" bl":b.left>c.left&&b.left<c.right?" bl-r":"",b.left<e.left||b.left>e.right?" tl":b.left>e.left&&b.left<e.right?" tl-r":"",b.right>c.right||b.right<c.left?" br":b.right<c.right&&b.right>c.left?" br-r":"",b.right>e.right||b.right<e.left?" tr":b.right<e.right&&b.right>e.left?" tr-r":""].join("")})}else if("layout"===c.type||"layout-fill"===c.type||"layout-margin"===c.type){var j=c.element.getBoundingClientRect();if(d("line-n","top",j.top),d("line-s","top",j.top+j.height),d("line-w","left",j.left),d("line-e","left",j.left+j.width),"layout-margin"===c.type||"layout-fill"===c.type){var k=window.getComputedStyle(c.element),l=h(j);l.margin=[-parseFloat(k.marginTop),-parseFloat(k.marginRight),-parseFloat(k.marginBottom),-parseFloat(k.marginLeft),""].join("px "),l.borderWidth=[k.marginTop,k.marginRight,k.marginBottom,k.marginLeft].join(" "),d("fill-margin",l)}"layout-fill"===c.type&&d("fill",j)}e.length>f&&y.push.apply(y,e.splice(f)),a(e).appendTo(p)}),a(y).detach(),q&&d(p,q.element)}function m(){if(q){var a=q.element.getBoundingClientRect();s&&e(s,a)||(s=a,l(w))}}function n(a,c){if(k(x),q){var d=q.nodeFromPoint(a,c);if(d)if(d.nodeType&b.NODE_WIDGET)j(x,d.widget.element,"layout");else{if(d.nodeType&(b.NODE_INLINE|b.NODE_INLINE_EDITABLE|b.NODE_INLINE_WIDGET))for(;!(d.nodeType&(b.NODE_PARAGRAPH|b.NODE_EDITABLE_PARAGRAPH))&&d.parentNode;d=d.parentNode);j(x,d.element,"layout")}}l(x)}function o(a){var c=q.getSelection();k(w),c.isCaret?a.layout&&c.startNode.nodeType&u&&j(w,c.startNode.element,"layout-margin"):b.iterate(c.createTreeWalker(-1,function(b){if(b.nodeType&u||a.layout&&r&&b.element===r.element)return j(w,b.element,b.nodeType&u?"text":"layout-fill"),
2})),l(w)}var p,q,r,s,t={left:1e4,right:-1e4},u=b.NODE_PARAGRAPH|b.NODE_EDITABLE_PARAGRAPH|b.NODE_INLINE|b.NODE_INLINE_WIDGET|b.NODE_INLINE_EDITABLE,v=!window.ActiveXObject,w=[],x=[],y=[],z=a(window).width(),A=a(window).height();b.widgets.visualizer={inline:!0,options:{layout:!0},init:function(b){a(b.typer.element).addClass("has-typer-visualizer"),v&&!c.init&&(c(),c.init=!0)},focusin:function(a){q=a.typer},focusout:function(b){q=null,a(p).children().detach()},widgetFocusin:function(a,b){r=b,v&&o(a.widget.options)},widgetFocusout:function(a){r=null},stateChange:function(a){v&&a.typer===q&&o(a.widget.options)}},b.defaultOptions.visualizer=v}(jQuery,window.Typer),function(a,b){"use strict";var c=a('<div style="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(255,255,255,0.5) url(data:image/gif;,);z-index:999;">');b.ui.themes.material={resources:["https://fonts.googleapis.com/css?family=Roboto:400,500,700","https://fonts.googleapis.com/icon?family=Material+Icons","https://cdn.rawgit.com/misonou/jquery-typer/master/css/jquery.typer.material.css"],controlActiveClass:"active",controlDisabledClass:"disabled",controlHiddenClass:"hidden",labelText:function(a,c){var d=!!b.ui.getIcon(c,"material");return!d||"toolbar"!==a.type||"textbox"!==c.type&&"callout"===(c.parent||"").type?'<span x:bind="(_:label)"></span>':""},labelIcon:function(a,c){var d=b.ui.getIcon(c,"material");return"callout"===(c.parent||"").type?"checkbox"===c.type?"":d.replace(/.*/,'<i class="material-icons">$&</i>'):d.replace(/.+/,'<i class="material-icons">$&</i>')},group:'<div class="typer-ui-group" x:bind="(role:name)"><br x:t="children"/></div>',label:'<span class="typer-ui-label"><br x:t="labelIcon"/><br x:t="labelText"/></span>',button:'<button x:bind="(title:label,role:name)"><br x:t="label"/><span class="typer-ui-menu-annotation" x:bind="(_:annotation)"></span></button>',buttonExecuteOn:"click",callout:'<div class="typer-ui-menu" x:bind="(role:name)"><button x:bind="(title:label)"><br x:t="label"/></button><div class="typer-ui-menupane"><br x:t="children"></div></div>',calloutExecuteOn:{on:"click",of:">button"},dropdown:'<div class="typer-ui-dropdown typer-ui-menu" x:bind="(role:name)"><button x:bind="(title:label)"><span class="typer-ui-label"><br x:t="labelIcon"/><span x:bind="(_:selectedValue)"></span></span></button><div class="typer-ui-menupane"><br x:t="children(t:button)"></div></div>',checkbox:'<label class="typer-ui-checkbox" x:bind="(title:label,role:name)"><input type="checkbox" x:bind="(checked:value)"/><br x:t="label"/></label>',checkboxExecuteOn:{on:"change",of:":checkbox"},textbox:'<label class="typer-ui-textbox" x:bind="(role:name,title:label)"><br x:t="label"/><div contenteditable spellcheck="false" x:bind="(data-placeholder:label)"></div></label>',textboxInit:function(b,c){var d=a("[contenteditable]",c.element);d.typer("textbox",{enter:function(){b.execute("ui:button-ok")},escape:function(){b.execute("ui:button-cancel")}}),d.bind("change",function(){b.setValue(c,this.value),a(c.element).toggleClass("empty",!this.value)}),d.bind("focusin focusout",function(b){a(c.element).parents(".typer-ui-menu").toggleClass("open","focusin"===b.type)})},textboxStateChange:function(b,c){a(c.element).toggleClass("empty",!c.value),a(c.element).find("[contenteditable]").prop("value",c.value||"")},dialog:'<div class="typer-ui-dialog"><h1><br x:t="label"/></h1><br x:t="children"></div>',dialogOpen:function(b,d){c.appendTo(document.body),a(b.element).appendTo(document.body),setTimeout(function(){a(d.element).addClass("open"),a("[contenteditable]:first",b.all["ui:prompt-input"].element).focus()})},dialogClose:function(b,d){c.detach(),a(d.element).removeClass("open").one("transitionend otransitionend webkitTransitionEnd",function(){a(b.element).remove()})},init:function(b){a(b.element).on("mouseover",".typer-ui-menu",function(b){setTimeout(function(){var c=a(".typer-ui-menupane",b.currentTarget)[0],d=!!a(b.currentTarget).parents(".typer-ui-menu")[1],e=c.getBoundingClientRect();e.top+e.height>a(window).height()?a(c).css("bottom",d?"0":"100%"):e.top<0&&a(c).css("bottom","auto"),e.left+e.width>a(window).width()?a(c).css("right",d?"100%":"0"):e.left<0&&a(c).css("right","auto")})})}}}(jQuery,window.Typer);
//# sourceMappingURL=jquery.typer.min.js.map